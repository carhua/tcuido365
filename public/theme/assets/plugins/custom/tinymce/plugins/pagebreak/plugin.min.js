!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=tinymce.util.Tools.resolve("tinymce.Env"),n=function(){return'<img src="'+a.transparentSrc+'" class="mce-pagebreak" data-mce-resize="false" data-mce-placeholder />'};e.add("pagebreak",function(e){var a,t,r,o,c,i;(a=e).addCommand("mcePageBreak",function(){a.settings.pagebreak_split_block?a.insertContent("<p>"+n()+"</p>"):a.insertContent(n())}),(t=e).ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction:function(){return t.execCommand("mcePageBreak")}}),t.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction:function(){return t.execCommand("mcePageBreak")}}),o=(r=e).getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e"),c=new RegExp(o.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(e){return"\\"+e}),"gi"),r.on("BeforeSetContent",function(e){e.content=e.content.replace(c,n())}),r.on("PreInit",function(){r.serializer.addNodeFilter("img",function(e){for(var a,n,t=e.length;t--;)if((n=(a=e[t]).attr("class"))&&-1!==n.indexOf("mce-pagebreak")){var c=a.parent;if(r.schema.getBlockElements()[c.name]&&r.getParam("pagebreak_split_block",!1)){c.type=3,c.value=o,c.raw=!0,a.remove();continue}a.type=3,a.value=o,a.raw=!0}})}),(i=e).on("ResolveName",function(e){"IMG"===e.target.nodeName&&i.dom.hasClass(e.target,"mce-pagebreak")&&(e.name="pagebreak")})})}();