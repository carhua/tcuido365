!function(n){"use strict";var t,e=function(n){var t=n;return{get:function(){return t},set:function(n){t=n}}},r=tinymce.util.Tools.resolve("tinymce.PluginManager"),o=function(n){return{isFullscreen:function(){return null!==n.get()}}},i=function(){},u=function(n){return function(){return n}},c=u(!1),l=u(!0),f=function(){return a},a=function(){var n=function(n){return n.isNone()},t=function(n){return n()},e=function(n){return n};return{fold:function(n,t){return n()},is:c,isSome:c,isNone:l,getOr:e,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:u(null),getOrUndefined:u(void 0),or:e,orThunk:t,map:f,each:i,bind:f,exists:c,forall:l,filter:f,equals:n,equals_:n,toArray:function(){return[]},toString:u("none()")}}(),s=function(n){var t=u(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:l,isNone:c,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return s(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:a},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(c,function(t){return e(n,t)})}};return o},d={some:s,none:f,from:function(n){return null==n?a:s(n)}},m=function(){return n=function(n){n.unbind()},t=e(d.none()),r=function(){t.get().each(n)},{clear:function(){r(),t.set(d.none())},isSet:function(){return t.get().isSome()},set:function(n){r(),t.set(d.some(n))}};var n,t,r},h=function(n){return function(t){return r=typeof(e=t),(null===e?"null":"object"===r&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":r)===n;var e,r}},p=function(n){return function(t){return typeof t===n}},v=h("string"),g=h("array"),y=p("boolean"),w=p("function"),b=p("number"),S=Array.prototype.push,T=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r},x=function(n,t){for(var e=0,r=n.length;e<r;e++){t(n[e],e)}},C=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var i=n[r];t(i,r)&&e.push(i)}return e},A=function(n,t){return function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!g(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);S.apply(t,n[e])}return t}(T(n,t))},E=Object.keys,O=function(n){return void 0!==n.style&&w(n.style.getPropertyValue)},D=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:u(n)}},M={fromHtml:function(t,e){var r=(e||n.document).createElement("div");if(r.innerHTML=t,!r.hasChildNodes()||r.childNodes.length>1)throw n.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return D(r.childNodes[0])},fromTag:function(t,e){var r=(e||n.document).createElement(t);return D(r)},fromText:function(t,e){var r=(e||n.document).createTextNode(t);return D(r)},fromDom:D,fromPoint:function(n,t,e){var r=n.dom();return d.from(r.elementFromPoint(t,e)).map(D)}},N=(void 0!==n.window?n.window:Function("return this;")(),t=3,function(n){return function(n){return n.dom().nodeType}(n)===t}),k=function(t,e,r){!function(t,e,r){if(!(v(r)||y(r)||b(r)))throw n.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,r+"")}(t.dom(),e,r)},F=function(n,t){var e=n.dom().getAttribute(t);return null===e?void 0:e},P=function(n,t){n.dom().removeAttribute(t)},L=function(t,e){var r=t.dom();!function(n,t){for(var e=E(n),r=0,o=e.length;r<o;r++){var i=e[r];t(n[i],i)}}(e,function(t,e){!function(t,e,r){if(!v(r))throw n.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",t),new Error("CSS value must be a string: "+r);O(t)&&t.style.setProperty(e,r)}(r,e,t)})},H=function(t,e){var r=t.dom(),o=n.window.getComputedStyle(r).getPropertyValue(e);return""!==o||function(n){var t=N(n)?n.dom().parentNode:n.dom();return null!=t&&t.ownerDocument.body.contains(t)}(t)?o:q(r,e)},q=function(n,t){return O(n)?n.style.getPropertyValue(t):""},V=function(n){var t,e,r=M.fromDom(n.target),o=function(){return n.stopPropagation()},i=function(){return n.preventDefault()},c=(t=i,e=o,function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))});return function(n,t,e,r,o,i,c){return{target:u(n),x:u(t),y:u(e),stop:r,prevent:o,kill:i,raw:u(c)}}(r,n.clientX,n.clientY,o,i,c,n)},W=function(n,t){var e=n.dom();if(1!==e.nodeType)return!1;var r=e;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},j=function(n){return function(n){return d.from(n.dom().parentNode).map(M.fromDom)}(n).map(z).map(function(t){return C(t,function(t){return e=t,!(n.dom()===e.dom());var e})}).getOr([])},z=function(n){return T(n.dom().childNodes,M.fromDom)},B=function(n,t){return{left:u(n),top:u(t),translate:function(e,r){return B(n+e,t+r)}}},I=B,U=function(t){var e=void 0===t?n.window:t;return d.from(e.visualViewport)},_=function(n,t,e,r){return{x:n,y:t,width:e,height:r,right:n+e,bottom:t+r}},K=function(t){var e=void 0===t?n.window:t,r=e.document,o=function(t){var e=void 0!==t?t.dom():n.document,r=e.body.scrollLeft||e.documentElement.scrollLeft,o=e.body.scrollTop||e.documentElement.scrollTop;return I(r,o)}(M.fromDom(r));return U(e).fold(function(){var n=e.document.documentElement,t=n.clientWidth,r=n.clientHeight;return _(o.left(),o.top(),t,r)},function(n){return _(Math.max(n.pageLeft,o.left()),Math.max(n.pageTop,o.top()),n.width,n.height)})},X=function(n,t,e){return U(e).map(function(t){var e=function(n){return V(n)};return t.addEventListener(n,e),{unbind:function(){return t.removeEventListener(n,e)}}}).getOrThunk(function(){return{unbind:i}})},Y=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),G=tinymce.util.Tools.resolve("tinymce.Env"),J=tinymce.util.Tools.resolve("tinymce.util.Delay"),Q=function(n,t){n.fire("FullscreenStateChanged",{state:t})},R=function(n,t,e){return C(function(n,t){for(var e=w(t)?t:c,r=n.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=M.fromDom(i);if(o.push(u),!0===e(u))break;r=i}return o}(n,e),t)},Z=function(t){return function(t,e){var r,o=void 0===e?n.document:e.dom();return 1!==(r=o).nodeType&&9!==r.nodeType||0===r.childElementCount?[]:T(o.querySelectorAll(t),M.fromDom)}(t)},$=function(n,t,e){return R(n,function(n){return W(n,t)},e)},nn=function(n,t){return function(n,t){return C(j(n),t)}(n,function(n){return W(n,t)})},tn="data-ephox-mobile-fullscreen-style",en="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",rn=G.os.isAndroid(),on=function(n,t,e){var r=function(t){return function(e){var r=F(e,"style"),o=void 0===r?"no-styles":r.trim();o!==t&&(k(e,tn,o),L(e,n.parseStyle(t)))}},o=$(t,"*"),i=A(o,function(n){return nn(n,"*:not(.tox-silver-sink)")}),u=function(n){var t=H(n,"background-color");return void 0!==t&&""!==t?"background-color:"+t+"!important":"background-color:rgb(255,255,255)!important;"}(e);x(i,r("display:none!important;")),x(o,r("position:absolute!important;"+en+u)),r((!0===rn?"":"position:absolute!important;")+en+u)(t)},un=Y.DOM,cn=U().fold(function(){return{bind:i,unbind:i}},function(t){var r,o=(r=e(d.none()),{clear:function(){r.set(d.none())},set:function(n){r.set(d.some(n))},isSet:function(){return r.get().isSome()},on:function(n){r.get().each(n)}}),i=m(),u=m(),c=J.throttle(function(){n.document.body.scrollTop=0,n.document.documentElement.scrollTop=0,n.window.requestAnimationFrame(function(){o.on(function(n){return L(n,{top:t.offsetTop+"px",left:t.offsetLeft+"px",height:t.height+"px",width:t.width+"px"})})})},50);return{bind:function(n){o.set(n),c(),i.set(X("resize")),u.set(X("scroll"))},unbind:function(){o.on(function(){i.clear(),u.clear()}),o.clear()}}}),ln=function(t,e){var r,o,i,u=n.document.body,c=n.document.documentElement;o=t.getContainer();var l,f,a,s,d=M.fromDom(o),m=e.get(),h=M.fromDom(t.getBody()),p=G.deviceType.isTouch();if(r=o.style,i=t.getContentAreaContainer().firstChild.style,m)i.width=m.iframeWidth,i.height=m.iframeHeight,r.width=m.containerWidth,r.height=m.containerHeight,r.top=m.containerTop,r.left=m.containerLeft,p&&(f=t.dom,a=Z("["+tn+"]"),x(a,function(n){var t=F(n,tn);"no-styles"!==t?L(n,f.parseStyle(t)):P(n,"style"),P(n,tn)})),un.removeClass(u,"tox-fullscreen"),un.removeClass(c,"tox-fullscreen"),un.removeClass(o,"tox-fullscreen"),l=m.scrollPos,n.window.scrollTo(l.x,l.y),e.set(null),Q(t,!1),cn.unbind(),t.off("remove",cn.unbind);else{var v={scrollPos:(s=K(n.window),{x:s.x,y:s.y}),containerWidth:r.width,containerHeight:r.height,containerTop:r.top,containerLeft:r.left,iframeWidth:i.width,iframeHeight:i.height};p&&on(t.dom,d,h),i.width=i.height="100%",r.width=r.height="",un.addClass(u,"tox-fullscreen"),un.addClass(c,"tox-fullscreen"),un.addClass(o,"tox-fullscreen"),cn.bind(d),t.on("remove",cn.unbind),e.set(v),Q(t,!0)}},fn=function(n,t){n.addCommand("mceFullScreen",function(){ln(n,t)})},an=function(n,t){return function(e){e.setActive(null!==t.get());var r=function(n){return e.setActive(n.state)};return n.on("FullscreenStateChanged",r),function(){return n.off("FullscreenStateChanged",r)}}},sn=function(n,t){n.ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",icon:"fullscreen",shortcut:"Meta+Shift+F",onAction:function(){return n.execCommand("mceFullScreen")},onSetup:an(n,t)}),n.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:function(){return n.execCommand("mceFullScreen")},onSetup:an(n,t)})};r.add("fullscreen",function(n){var t=e(null);return n.settings.inline?o(t):(fn(n,t),sn(n,t),n.addShortcut("Meta+Shift+F","","mceFullScreen"),o(t))})}(window);