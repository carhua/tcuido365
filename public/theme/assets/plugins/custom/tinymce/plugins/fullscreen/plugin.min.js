!function(n){"use strict";var t,e,r,o=function(n){var t=n;return{get:function(){return t},set:function(n){t=n}}},i=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=function(){},c=function(n){return function(){return n}},l=c(!1),a=c(!0),f=function(){return s},s=(t=function(n){return n.isNone()},{fold:function(n,t){return n()},is:l,isSome:l,isNone:a,getOr:r=function(n){return n},getOrThunk:e=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:c(null),getOrUndefined:c(void 0),or:r,orThunk:e,map:f,each:u,bind:f,exists:l,forall:a,filter:f,equals:t,equals_:t,toArray:function(){return[]},toString:c("none()")}),d=function(n){var t=c(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:a,isNone:l,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return d(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:s},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(l,function(t){return e(n,t)})}};return o},m={some:d,none:f,from:function(n){return null==n?s:d(n)}},h=function(){return n=function(n){n.unbind()},t=o(m.none()),e=function(){t.get().each(n)},{clear:function(){e(),t.set(m.none())},isSet:function(){return t.get().isSome()},set:function(n){e(),t.set(m.some(n))}};var n,t,e},p=function(n){return function(t){return r=typeof(e=t),(null===e?"null":"object"==r&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":r)===n;var e,r}},v=function(n){return function(t){return typeof t===n}},g=p("string"),y=p("array"),w=v("boolean"),b=v("function"),S=v("number"),T=Array.prototype.push,x=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r},A=function(n,t){for(var e=0,r=n.length;e<r;e++)t(n[e],e)},C=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var i=n[r];t(i,r)&&e.push(i)}return e},O=Object.keys,E=function(n){return void 0!==n.style&&b(n.style.getPropertyValue)},k=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:c(n)}},F=k,M=(void 0!==n.window?n.window:Function("return this;")(),3,function(n){return 3===n.dom().nodeType}),N=function(n,t){var e=n.dom().getAttribute(t);return null===e?void 0:e},P=function(n,t){n.dom().removeAttribute(t)},D=function(t,e){var r=t.dom();!function(n,t){for(var e=O(n),r=0,o=e.length;r<o;r++){var i=e[r];t(n[i],i)}}(e,function(t,e){!function(t,e,r){if(!g(r))throw n.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",t),new Error("CSS value must be a string: "+r);E(t)&&t.style.setProperty(e,r)}(r,e,t)})},L=function(n,t){return E(n)?n.style.getPropertyValue(t):""},q=function(n,t){var e=n.dom();if(1!==e.nodeType)return!1;var r=e;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},V=function(n){return x(n.dom().childNodes,F)},H=function(n,t){return{left:c(n),top:c(t),translate:function(e,r){return H(n+e,t+r)}}},W=H,j=function(t){var e=void 0===t?n.window:t;return m.from(e.visualViewport)},z=function(n,t,e,r){return{x:n,y:t,width:e,height:r,right:n+e,bottom:t+r}},B=function(t){var e,r,o,i,u=void 0===t?n.window:t,c=u.document,l=(o=(r=void 0!==(e=F(c))?e.dom():n.document).body.scrollLeft||r.documentElement.scrollLeft,i=r.body.scrollTop||r.documentElement.scrollTop,W(o,i));return j(u).fold(function(){var n=u.document.documentElement,t=n.clientWidth,e=n.clientHeight;return z(l.left(),l.top(),t,e)},function(n){return z(Math.max(n.pageLeft,l.left()),Math.max(n.pageTop,l.top()),n.width,n.height)})},I=function(n,t,e){return j(e).map(function(t){var e=function(n){return function(n){var t,e,r,o,i,u=F(n.target),l=function(){return n.stopPropagation()},a=function(){return n.preventDefault()},f=(t=a,e=l,function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))});return r=u,o=n.clientX,i=n.clientY,{target:c(r),x:c(o),y:c(i),stop:l,prevent:a,kill:f,raw:c(n)}}(n)};return t.addEventListener(n,e),{unbind:function(){return t.removeEventListener(n,e)}}}).getOrThunk(function(){return{unbind:u}})},U=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),_=tinymce.util.Tools.resolve("tinymce.Env"),K=tinymce.util.Tools.resolve("tinymce.util.Delay"),X=function(n,t){n.fire("FullscreenStateChanged",{state:t})},Y=function(n,t,e){return C(function(n,t){for(var e=b(t)?t:l,r=n.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=F(i);if(o.push(u),!0===e(u))break;r=i}return o}(n,e),t)},G=function(n,t){return e=function(n){return q(n,t)},C(function(n){var t;return t=n,m.from(t.dom().parentNode).map(F).map(V).map(function(t){return C(t,function(t){return e=t,n.dom()!==e.dom();var e})}).getOr([])}(n),e);var e},J="data-ephox-mobile-fullscreen-style",Q="position:absolute!important;",R="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",Z=_.os.isAndroid(),$=function(t,e,r){var o,i=function(e){return function(r){var o=N(r,"style"),i=void 0===o?"no-styles":o.trim();i!==e&&(function(t,e,r){!function(t,e,r){if(!(g(r)||w(r)||S(r)))throw n.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,r+"")}(t.dom(),e,r)}(r,J,i),D(r,t.parseStyle(e)))}},u=("*",Y(e,function(n){return q(n,"*")},void 0)),c=function(n,t){return function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!y(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);T.apply(t,n[e])}return t}(x(n,t))}(u,function(n){return G(n,"*:not(.tox-silver-sink)")}),l=void 0!==(o=function(t,e){var r,o,i=t.dom(),u=n.window.getComputedStyle(i).getPropertyValue(e);return""!==u||void 0!==(o=M(r=t)?r.dom().parentNode:r.dom())&&null!==o&&o.ownerDocument.body.contains(o)?u:L(i,e)}(r,"background-color"))&&""!==o?"background-color:"+o+"!important":"background-color:rgb(255,255,255)!important;";A(c,i("display:none!important;")),A(u,i(Q+R+l)),i((!0===Z?"":Q)+R+l)(e)},nn=U.DOM,tn=j().fold(function(){return{bind:u,unbind:u}},function(t){var e,r=(e=o(m.none()),{clear:function(){e.set(m.none())},set:function(n){e.set(m.some(n))},isSet:function(){return e.get().isSome()},on:function(n){e.get().each(n)}}),i=h(),u=h(),c=K.throttle(function(){n.document.body.scrollTop=0,n.document.documentElement.scrollTop=0,n.window.requestAnimationFrame(function(){r.on(function(n){return D(n,{top:t.offsetTop+"px",left:t.offsetLeft+"px",height:t.height+"px",width:t.width+"px"})})})},50);return{bind:function(n){r.set(n),c(),i.set(I("resize")),u.set(I("scroll"))},unbind:function(){r.on(function(){i.clear(),u.clear()}),r.clear()}}}),en=function(t,e){var r,o,i,u=n.document.body,c=n.document.documentElement;o=t.getContainer();var l,a,f,s,d=F(o),m=e.get(),h=F(t.getBody()),p=_.deviceType.isTouch();if(r=o.style,i=t.getContentAreaContainer().firstChild.style,m)i.width=m.iframeWidth,i.height=m.iframeHeight,r.width=m.containerWidth,r.height=m.containerHeight,r.top=m.containerTop,r.left=m.containerLeft,p&&(a=t.dom,f=function(t){return e=t,1!==(r=o=n.document).nodeType&&9!==r.nodeType||0===r.childElementCount?[]:x(o.querySelectorAll(e),F);var e,r,o}("["+J+"]"),A(f,function(n){var t=N(n,J);"no-styles"!==t?D(n,a.parseStyle(t)):P(n,"style"),P(n,J)})),nn.removeClass(u,"tox-fullscreen"),nn.removeClass(c,"tox-fullscreen"),nn.removeClass(o,"tox-fullscreen"),l=m.scrollPos,n.window.scrollTo(l.x,l.y),e.set(null),X(t,!1),tn.unbind(),t.off("remove",tn.unbind);else{var v={scrollPos:{x:(s=B(n.window)).x,y:s.y},containerWidth:r.width,containerHeight:r.height,containerTop:r.top,containerLeft:r.left,iframeWidth:i.width,iframeHeight:i.height};p&&$(t.dom,d,h),i.width=i.height="100%",r.width=r.height="",nn.addClass(u,"tox-fullscreen"),nn.addClass(c,"tox-fullscreen"),nn.addClass(o,"tox-fullscreen"),tn.bind(d),t.on("remove",tn.unbind),e.set(v),X(t,!0)}},rn=function(n,t){return function(e){e.setActive(null!==t.get());var r=function(n){return e.setActive(n.state)};return n.on("FullscreenStateChanged",r),function(){return n.off("FullscreenStateChanged",r)}}};i.add("fullscreen",function(n){var t,e,r,i,u=o(null);return n.settings.inline||(e=u,(t=n).addCommand("mceFullScreen",function(){en(t,e)}),i=u,(r=n).ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",icon:"fullscreen",shortcut:"Meta+Shift+F",onAction:function(){return r.execCommand("mceFullScreen")},onSetup:rn(r,i)}),r.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:function(){return r.execCommand("mceFullScreen")},onSetup:rn(r,i)}),n.addShortcut("Meta+Shift+F","","mceFullScreen")),function(n){return{isFullscreen:function(){return null!==n.get()}}}(u)})}(window);