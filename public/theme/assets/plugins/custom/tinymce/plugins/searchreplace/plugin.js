!function(e){"use strict";var t,n,r,o,i=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},a=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},c=function(){},f=function(e){return function(){return e}},l=f(!1),s=f(!0),d=f("[!-#%-*,-\\/:;?@\\[-\\]_{}¡«·»¿;·՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰෴๏๚๛༄-༒༺-༽྅࿐-࿔࿙࿚၊-၏჻፡-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰⸱、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･]"),m=function(){return h},h=(t=function(e){return e.isNone()},{fold:function(e,t){return e()},is:l,isSome:l,isNone:s,getOr:r=function(e){return e},getOrThunk:n=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:f(null),getOrUndefined:f(void 0),or:r,orThunk:n,map:m,each:c,bind:m,exists:l,forall:s,filter:m,equals:t,equals_:t,toArray:function(){return[]},toString:f("none()")}),g=function(e){var t=f(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:s,isNone:l,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return g(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:h},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(l,function(t){return n(e,t)})}};return o},p={some:g,none:m,from:function(e){return null==e?h:g(e)}},v=d,y=tinymce.util.Tools.resolve("tinymce.util.Tools"),x=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},w=function(e){return function(t){return typeof t===e}},b=x("string"),O=x("array"),C=w("boolean"),T=w("number"),N=Array.prototype.slice,E=Array.prototype.push,k=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},S=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},A=function(e,t){for(var n=e.length-1;n>=0;n--){t(e[n],n)}},D=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!O(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);E.apply(t,e[n])}return t}(k(e,t))},M=Object.hasOwnProperty,B=function(e,t){return M.call(e,t)},I=(void 0!==e.window?e.window:Function("return this;")(),o=3,function(e){return function(e){return e.dom().nodeType}(e)===o}),P=function(t,n,r){!function(t,n,r){if(!(b(r)||C(r)||T(r)))throw e.console.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,r+"")}(t.dom(),n,r)},F=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:f(e)}},R={fromHtml:function(t,n){var r=(n||e.document).createElement("div");if(r.innerHTML=t,!r.hasChildNodes()||r.childNodes.length>1)throw e.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return F(r.childNodes[0])},fromTag:function(t,n){var r=(n||e.document).createElement(t);return F(r)},fromText:function(t,n){var r=(n||e.document).createTextNode(t);return F(r)},fromDom:F,fromPoint:function(e,t,n){var r=e.dom();return p.from(r.elementFromPoint(t,n)).map(F)}},W=function(e,t){return{element:f(e),offset:f(t)}},j=function(e,t){var n=function(e){return k(e.dom().childNodes,R.fromDom)}(e);return n.length>0&&t<n.length?W(n[t],0):W(e,t)},q=function(e,t){(function(e){return p.from(e.dom().parentNode).map(R.fromDom)})(e).each(function(n){n.dom().insertBefore(t.dom(),e.dom())})},V=function(e,t){q(e,t),function(e,t){e.dom().appendChild(t.dom())}(t,e)};var _,H,L,U=(_=I,H="text",{get:function(e){if(!_(e))throw new Error("Can only get "+H+" value of a "+H+" node");return L(e).getOr("")},getOption:L=function(e){return _(e)?p.from(e.dom().nodeValue):p.none()},set:function(e,t){if(!_(e))throw new Error("Can only set raw "+H+" value of a "+H+" node");e.dom().nodeValue=t}}),$=function(e){return U.get(e)},z=function(t,n){return function(t,n){var r,o=void 0===n?e.document:n.dom();return 1!==(r=o).nodeType&&9!==r.nodeType||0===r.childElementCount?[]:k(o.querySelectorAll(t),R.fromDom)}(n,t)},G=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),K=function(e,t){return e.isBlock(t)||B(e.schema.getShortEndedElements(),t.nodeName)},J=function(e,t){return"false"===e.getContentEditable(t)},Q=function(e,t){return!e.isBlock(t)&&B(e.schema.getWhiteSpaceElements(),t.nodeName)},X=function(e,t){return j(R.fromDom(e),t)},Y=function(e,t,n,r,o,i){void 0===i&&(i=!0);for(var a=i?t(!1):n;a;){var u=J(e,a);if(u||Q(e,a)){if(u?r.cef(a):r.boundary(a))break;a=t(!0)}else{if(K(e,a)){if(r.boundary(a))break}else 3===a.nodeType&&r.text(a);if(a===o)break;a=t(!1)}}},Z=function(e,t,n,r,o){if(!function(e,t){return K(e,t)||J(e,t)||Q(e,t)||function(e,t){return"true"===e.getContentEditable(t)&&"false"===e.getContentEditableParent(t.parentNode)}(e,t)}(e,n)){var i=e.getParent(r,e.isBlock),a=new G(n,i),u=o?a.next:a.prev;Y(e,u,n,{boundary:s,cef:s,text:function(e){o?t.fOffset+=e.length:t.sOffset+=e.length,t.elements.push(R.fromDom(e))}})}},ee=function(e,t,n,r,o,i){void 0===i&&(i=!0);var a=new G(n,t),u=[],c={sOffset:0,fOffset:0,elements:[]};Z(e,c,n,t,!1);var f=function(){return c.elements.length>0&&(u.push(c),c={sOffset:0,fOffset:0,elements:[]}),!1};return Y(e,a.next,n,{boundary:f,cef:function(e){return f(),o&&u.push.apply(u,o.cef(e)),!1},text:function(e){c.elements.push(R.fromDom(e)),o&&o.text(e,c)}},r,i),r&&Z(e,c,r,t,!0),f(),u},te=function(t,n){var r=X(n.startContainer,n.startOffset),o=r.element().dom(),i=X(n.endContainer,n.endOffset),a=i.element().dom();return ee(t,n.commonAncestorContainer,o,a,{text:function(e,t){e===a?t.fOffset+=e.length-i.offset():e===o&&(t.sOffset+=r.offset())},cef:function(n){var r,o,i,a=D(z(R.fromDom(n),"*[contenteditable=true]"),function(e){var n=e.dom();return ee(t,n,n)});return r=a,o=function(t,n){return function(t,n){return function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)}(t,n,e.Node.DOCUMENT_POSITION_PRECEDING)}(t.elements[0].dom(),n.elements[0].dom())?1:-1},(i=N.call(r,0)).sort(o),i}},!1)},ne=function(e,t){return t.collapsed?[]:te(e,t)},re=function(e,t){var n=e.createRng();return n.selectNode(t),ne(e,n)},oe=function(e,t){var n,r,o;return function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,a=e.length;i<a;i++){var u=e[i],c=t(u);c!==n&&(r.push(o),o=[]),n=c,o.push(u)}return 0!==o.length&&r.push(o),r}((n=e,r=function(e,n){var r=$(n),o=e.last,i=o+r.length,a=D(t,function(e,t){return e.start<i&&e.finish>o?[{element:n,start:Math.max(o,e.start)-o,finish:Math.min(i,e.finish)-o,matchId:t}]:[]});return{results:e.results.concat(a),last:i}},o={results:[],last:0},S(n,function(e){o=r(o,e)}),o).results,function(e){return e.matchId})},ie=function(e,t){return D(t,function(t){var n=t.elements,r=k(n,$).join(""),o=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=e.length);var o=t.regex;o.lastIndex=n;for(var i,a=[];i=o.exec(e);){var u=i[t.matchIndex],c=i.index+i[0].indexOf(u),f=c+u.length;if(f>r)break;a.push({start:c,finish:f}),o.lastIndex=f}return a}(r,e,t.sOffset,r.length-t.fOffset);return oe(n,o)})},ae=function(e,t){A(e,function(e,n){A(e,function(e){var r=R.fromDom(t.cloneNode(!1));P(r,"data-mce-index",n);var o=e.element.dom();if(o.length===e.finish&&0===e.start)V(e.element,r);else{o.length!==e.finish&&o.splitText(e.finish);var i=o.splitText(e.start);V(R.fromDom(i),r)}})})},ue=function(e,t,n,r){var o=n.getBookmark(),i=e.select("td[data-mce-selected],th[data-mce-selected]"),a=i.length>0?function(e,t){return D(t,function(t){return re(e,t)})}(e,i):ne(e,n.getRng()),u=ie(t,a);return ae(u,r),n.moveToBookmark(o),u.length},ce=function(e){var t=e.getAttribute("data-mce-index");return"number"==typeof t?""+t:t},fe=function(e,t,n,r){var o,i;return(i=e.dom.create("span",{"data-mce-bogus":1})).className="mce-match-marker",o=e.getBody(),xe(e,t,!1),r?ue(e.dom,n,e.selection,i):function(e,t,n,r){var o=re(e,n),i=ie(t,o);return ae(i,r),i.length}(e.dom,n,o,i)},le=function(e){var t=e.parentNode;e.firstChild&&t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)},se=function(e,t){var n,r=[];if((n=y.toArray(e.getBody().getElementsByTagName("span"))).length)for(var o=0;o<n.length;o++){var i=ce(n[o]);null!==i&&i.length&&(i===t.toString()&&r.push(n[o]))}return r},de=function(e,t,n){var r=t.get(),o=r.index,i=e.dom;(n=!1!==n)?o+1===r.count?o=0:o++:o-1==-1?o=r.count-1:o--,i.removeClass(se(e,r.index),"mce-match-marker-selected");var a=se(e,o);return a.length?(i.addClass(se(e,o),"mce-match-marker-selected"),e.selection.scrollIntoView(a[0]),o):-1},me=function(e,t){var n=t.parentNode;e.remove(t),e.isEmpty(n)&&e.remove(n)},he=function(e,t,n,r,o,i){var a=function(e,t){var n="("+e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\s/g,"[^\\S\\r\\n]")+")";return t?"(?:^|\\s|"+v()+")"+n+"(?=$|\\s|"+v()+")":n}(n,o),u={regex:new RegExp(a,r?"g":"gi"),matchIndex:1},c=fe(e,t,u,i);if(c){var f=de(e,t,!0);t.set({index:f,count:c,text:n,matchCase:r,wholeWord:o,inSelection:i})}return c},ge=function(e,t){var n=de(e,t,!0);t.set(u(u({},t.get()),{index:n}))},pe=function(e,t){var n=de(e,t,!1);t.set(u(u({},t.get()),{index:n}))},ve=function(e){var t=ce(e);return null!==t&&t.length>0},ye=function(e,t,n,r,o){var i,a,c,f,l,s=t.get(),d=s.index,m=d;for(r=!1!==r,c=e.getBody(),a=y.grep(y.toArray(c.getElementsByTagName("span")),ve),i=0;i<a.length;i++){var h=ce(a[i]);if(f=l=parseInt(h,10),o||f===s.index){for(n.length?(a[i].firstChild.nodeValue=n,le(a[i])):me(e.dom,a[i]);a[++i];){if((f=parseInt(ce(a[i]),10))!==l){i--;break}me(e.dom,a[i])}r&&m--}else l>d&&a[i].setAttribute("data-mce-index",String(l-1))}return t.set(u(u({},s),{count:o?0:s.count-1,index:m})),r?ge(e,t):pe(e,t),!o&&t.get().count>0},xe=function(e,t,n){var r,o,i,a,c=t.get();for(o=y.toArray(e.getBody().getElementsByTagName("span")),r=0;r<o.length;r++){var f=ce(o[r]);null!==f&&f.length&&(f===c.index.toString()&&(i||(i=o[r].firstChild),a=o[r].firstChild),le(o[r]))}if(t.set(u(u({},c),{index:-1,count:0,text:""})),i&&a){var l=e.dom.createRng();return l.setStart(i,0),l.setEnd(a,a.data.length),!1!==n&&e.selection.setRng(l),l}},we=function(e,t){return t.get().count>1},be=function(e,t){return t.get().count>1},Oe=function(e,t){return{done:function(n){return xe(e,t,n)},find:function(n,r,o,i){return void 0===i&&(i=!1),he(e,t,n,r,o,i)},next:function(){return ge(e,t)},prev:function(){return pe(e,t)},replace:function(n,r,o){return ye(e,t,n,r,o)}}},Ce=tinymce.util.Tools.resolve("tinymce.Env"),Te=function(e,t){var n,r=(n=i(p.none()),{clear:function(){n.set(p.none())},set:function(e){n.set(p.some(e))},isSet:function(){return n.get().isSome()},on:function(e){n.get().each(e)}});e.undoManager.add();var o=y.trim(e.selection.getContent({format:"text"}));function a(n){(we(e,t)?n.enable:n.disable)("next"),(be(e,t)?n.enable:n.disable)("prev")}var c=function(e,t){var n=t?e.disable:e.enable;S(["replace","replaceall","prev","next"],n)};var f=function(e,t){Ce.browser.isSafari()&&Ce.deviceType.isTouch()&&("find"===t||"replace"===t||"replaceall"===t)&&e.focus(t)},l=function(n){xe(e,t,!1),c(n,!0),a(n)},s=function(n){var r=n.getData(),o=t.get();if(r.findtext.length){if(o.text===r.findtext&&o.matchCase===r.matchcase&&o.wholeWord===r.wholewords)ge(e,t);else{var i=he(e,t,r.findtext,r.matchcase,r.wholewords,r.inselection);i<=0&&function(t){e.windowManager.alert("Could not find the specified string.",function(){t.focus("findtext")})}(n),c(n,0===i)}a(n)}else l(n)},d=t.get(),m={title:"Find and Replace",size:"normal",body:{type:"panel",items:[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",disabled:!0,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",disabled:!0,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}]},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"},{type:"togglemenuitem",name:"inselection",text:"Find in selection"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",disabled:!0},{type:"custom",name:"replaceall",text:"Replace All",disabled:!0}],initialData:{findtext:o,replacetext:"",wholewords:d.wholeWord,matchcase:d.matchCase,inselection:d.inSelection},onChange:function(e,n){"findtext"===n.name&&t.get().count>0&&l(e)},onAction:function(n,r){var o=n.getData();switch(r.name){case"find":s(n);break;case"replace":ye(e,t,o.replacetext)?a(n):l(n);break;case"replaceall":ye(e,t,o.replacetext,!0,!0),l(n);break;case"prev":pe(e,t),a(n);break;case"next":ge(e,t),a(n);break;case"matchcase":case"wholewords":case"inselection":!function(e){var n=e.getData(),r=t.get();t.set(u(u({},r),{matchCase:n.matchcase,wholeWord:n.wholewords,inSelection:n.inselection}))}(n),l(n)}f(n,r.name)},onSubmit:function(e){s(e),f(e,"find")},onClose:function(){e.focus(),xe(e,t),e.undoManager.add()}};r.set(e.windowManager.open(m,{inline:"toolbar"}))},Ne=function(e,t){e.addCommand("SearchReplace",function(){Te(e,t)})},Ee=function(e,t){return function(){Te(e,t)}},ke=function(e,t){e.ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:Ee(e,t),icon:"search"}),e.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:Ee(e,t),icon:"search"}),e.shortcuts.add("Meta+F","",Ee(e,t))};a.add("searchreplace",function(e){var t=i({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1,inSelection:!1});return Ne(e,t),ke(e,t),Oe(e,t)})}(window);