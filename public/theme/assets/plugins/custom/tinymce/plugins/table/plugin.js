!function(n){"use strict";var t=function(n){var t=n;return{get:function(){return t},set:function(n){t=n}}},e=function(){},r=function(n){return function(){return n}},o=function(n){return n};function u(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=t.concat(e);return n.apply(null,o)}}var i=function(n){return function(t){return!n(t)}},c=r(!1),a=r(!0),l=function(){return f},f=function(){var n=function(n){return n.isNone()},t=function(n){return n()},o=function(n){return n};return{fold:function(n,t){return n()},is:c,isSome:c,isNone:a,getOr:o,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:r(null),getOrUndefined:r(void 0),or:o,orThunk:t,map:l,each:e,bind:l,exists:c,forall:a,filter:l,equals:n,equals_:n,toArray:function(){return[]},toString:r("none()")}}(),s=function(n){var t=r(n),e=function(){return u},o=function(t){return t(n)},u={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:a,isNone:c,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return s(t(n))},each:function(t){t(n)},bind:o,exists:o,forall:o,filter:function(t){return t(n)?u:f},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(c,function(t){return e(n,t)})}};return u},d={some:s,none:l,from:function(n){return null==n?f:s(n)}},m=tinymce.util.Tools.resolve("tinymce.PluginManager"),g=function(n){return function(t){return r=typeof(e=t),(null===e?"null":"object"===r&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":r)===n;var e,r}},p=function(n){return function(t){return typeof t===n}},h=g("string"),v=g("array"),b=p("boolean"),w=p("function"),y=p("number"),S=Array.prototype.slice,x=Array.prototype.indexOf,C=Array.prototype.push,R=function(n,t){return e=n,r=t,x.call(e,r)>-1;var e,r},T=function(n,t){for(var e=0,r=n.length;e<r;e++){if(t(n[e],e))return!0}return!1},O=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var u=n[o];r[o]=t(u,o)}return r},D=function(n,t){for(var e=0,r=n.length;e<r;e++){t(n[e],e)}},A=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var u=n[r];t(u,r)&&e.push(u)}return e},E=function(n,t,e){return function(n,t){for(var e=n.length-1;e>=0;e--)t(n[e],e)}(n,function(n){e=t(e,n)}),e},k=function(n,t,e){return D(n,function(n){e=t(e,n)}),e},B=function(n,t){return function(n,t,e){for(var r=0,o=n.length;r<o;r++){var u=n[r];if(t(u,r))return d.some(u);if(e(u,r))break}return d.none()}(n,t,c)},N=function(n,t){for(var e=0,r=n.length;e<r;e++){if(t(n[e],e))return d.some(e)}return d.none()},I=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!v(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);C.apply(t,n[e])}return t},P=function(n,t){return I(O(n,t))},M=function(n,t){for(var e=0,r=n.length;e<r;++e){if(!0!==t(n[e],e))return!1}return!0},_=function(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return d.none()},W=Object.keys,j=Object.hasOwnProperty,z=function(n,t){for(var e=W(n),r=0,o=e.length;r<o;r++){var u=e[r];t(n[u],u)}},L=function(n,t){return F(n,function(n,e){return{k:e,v:t(n,e)}})},F=function(n,t){var e={};return z(n,function(n,r){var o=t(n,r);e[o.k]=o.v}),e},H=function(n,t){return q(n,t)?d.from(n[t]):d.none()},q=function(n,t){return j.call(n,t)},U=(void 0!==n.window?n.window:Function("return this;")(),function(n){return n.dom().nodeName.toLowerCase()}),V=function(n){return n.dom().nodeType},K=function(n){return function(t){return V(t)===n}},X=function(n){return 8===V(n)||"#comment"===U(n)},$=K(1),G=K(3),Y=function(t,e,r){if(!(h(r)||b(r)||y(r)))throw n.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,r+"")},J=function(n,t,e){Y(n.dom(),t,e)},Q=function(n,t){var e=n.dom();z(t,function(n,t){Y(e,t,n)})},Z=function(n,t){var e=n.dom().getAttribute(t);return null===e?void 0:e},nn=function(n,t){return d.from(Z(n,t))},tn=function(n,t){var e=n.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(t)},en=function(n,t){n.dom().removeAttribute(t)},rn=function(n){return k(n.dom().attributes,function(n,t){return n[t.name]=t.value,n},{})},on=function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t},un=function(n,t){return-1!==n.indexOf(t)},cn=function(n,t){return on(n,t,0)},an=function(n){return function(t){return t.replace(n,"")}}(/^\s+|\s+$/g),ln=function(n){return void 0!==n.style&&w(n.style.getPropertyValue)},fn=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:r(n)}},sn={fromHtml:function(t,e){var r=(e||n.document).createElement("div");if(r.innerHTML=t,!r.hasChildNodes()||r.childNodes.length>1)throw n.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return fn(r.childNodes[0])},fromTag:function(t,e){var r=(e||n.document).createElement(t);return fn(r)},fromText:function(t,e){var r=(e||n.document).createTextNode(t);return fn(r)},fromDom:fn,fromPoint:function(n,t,e){var r=n.dom();return d.from(r.elementFromPoint(t,e)).map(fn)}},dn=function(n){var t=G(n)?n.dom().parentNode:n.dom();return null!=t&&t.ownerDocument.body.contains(t)},mn=function(n){var t=n.dom().body;if(null==t)throw new Error("Body is not available yet");return sn.fromDom(t)},gn=function(t,e,r){if(!h(r))throw n.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",t),new Error("CSS value must be a string: "+r);ln(t)&&t.style.setProperty(e,r)},pn=function(n,t,e){var r=n.dom();gn(r,t,e)},hn=function(n,t){var e=n.dom();z(t,function(n,t){gn(e,t,n)})},vn=function(t,e){var r=t.dom(),o=n.window.getComputedStyle(r).getPropertyValue(e);return""!==o||dn(t)?o:bn(r,e)},bn=function(n,t){return ln(n)?n.style.getPropertyValue(t):""},wn=function(n,t){var e=n.dom(),r=bn(e,t);return d.from(r).filter(function(n){return n.length>0})},yn=function(n,t){!function(n,t){ln(n)&&n.style.removeProperty(t)}(n.dom(),t),nn(n,"style").map(an).is("")&&en(n,"style")},Sn=function(){return(Sn=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)},xn=function(n){var t,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,t=n.apply(null,r)),t}},Cn=function(){return Rn(0,0)},Rn=function(n,t){return{major:n,minor:t}},Tn={nu:Rn,detect:function(n,t){var e=String(t).toLowerCase();return 0===n.length?Cn():function(n,t){var e=function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.test(t))return r}}(n,t);if(!e)return{major:0,minor:0};var r=function(n){return Number(t.replace(e,"$"+n))};return Rn(r(1),r(2))}(n,e)},unknown:Cn},On=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r("Firefox"),isSafari:r("Safari")}},Dn={unknown:function(){return On({current:void 0,version:Tn.unknown()})},nu:On,edge:r("Edge"),chrome:r("Chrome"),ie:r("IE"),opera:r("Opera"),firefox:r("Firefox"),safari:r("Safari")},An=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isWindows:r("Windows"),isiOS:r("iOS"),isAndroid:r("Android"),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r("Solaris"),isFreeBSD:r("FreeBSD"),isChromeOS:r("ChromeOS")}},En={unknown:function(){return An({current:void 0,version:Tn.unknown()})},nu:An,windows:r("Windows"),ios:r("iOS"),android:r("Android"),linux:r("Linux"),osx:r("OSX"),solaris:r("Solaris"),freebsd:r("FreeBSD"),chromeos:r("ChromeOS")},kn=function(n,t){var e=String(t).toLowerCase();return B(n,function(n){return n.search(e)})},Bn=function(n,t){return kn(n,t).map(function(n){var e=Tn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Nn=function(n,t){return kn(n,t).map(function(n){var e=Tn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},In=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Pn=function(n){return function(t){return un(t,n)}},Mn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return un(n,"edge/")&&un(n,"chrome")&&un(n,"safari")&&un(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,In],search:function(n){return un(n,"chrome")&&!un(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return un(n,"msie")||un(n,"trident")}},{name:"Opera",versionRegexes:[In,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Pn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Pn("firefox")},{name:"Safari",versionRegexes:[In,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(un(n,"safari")||un(n,"mobile/"))&&un(n,"applewebkit")}}],_n=[{name:"Windows",search:Pn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return un(n,"iphone")||un(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Pn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Pn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Pn("linux"),versionRegexes:[]},{name:"Solaris",search:Pn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Pn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Pn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Wn={browsers:r(Mn),oses:r(_n)},jn=function(n,t){var e=Wn.browsers(),o=Wn.oses(),u=Bn(e,n).fold(Dn.unknown,Dn.nu),i=Nn(o,n).fold(En.unknown,En.nu),c=function(n,t,e,o){var u=n.isiOS()&&!0===/ipad/i.test(e),i=n.isiOS()&&!u,c=n.isiOS()||n.isAndroid(),a=c||o("(pointer:coarse)"),l=u||!i&&c&&o("(min-device-width:768px)"),f=i||c&&!l,s=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),d=!f&&!l&&!s;return{isiPad:r(u),isiPhone:r(i),isTablet:r(l),isPhone:r(f),isTouch:r(a),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:r(s),isDesktop:r(d)}}(i,u,n,t);return{browser:u,os:i,deviceType:c}},zn=function(t){return n.window.matchMedia(t).matches},Ln=xn(function(){return jn(n.navigator.userAgent,zn)}),Fn=function(){return Ln()},Hn=function(n,t){var e=n.dom();if(1!==e.nodeType)return!1;var r=e;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},qn=function(n){return 1!==n.nodeType&&9!==n.nodeType||0===n.childElementCount},Un=function(n,t){return n.dom()===t.dom()},Vn=function(t,e){return r=t.dom(),o=e.dom(),function(n,t,e){return 0!=(n.compareDocumentPosition(t)&e)}(r,o,n.Node.DOCUMENT_POSITION_CONTAINED_BY);var r,o},Kn=function(n,t){return Fn().browser.isIE()?Vn(n,t):function(n,t){var e=n.dom(),r=t.dom();return e!==r&&e.contains(r)}(n,t)},Xn=Hn,$n=function(n){return sn.fromDom(n.dom().ownerDocument)},Gn=function(n){return d.from(n.dom().parentNode).map(sn.fromDom)},Yn=function(n,t){for(var e=w(t)?t:c,r=n.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=sn.fromDom(u);if(o.push(i),!0===e(i))break;r=u}return o},Jn=function(n){return d.from(n.dom().previousSibling).map(sn.fromDom)},Qn=function(n){return d.from(n.dom().nextSibling).map(sn.fromDom)},Zn=function(n){return O(n.dom().childNodes,sn.fromDom)},nt=function(n,t){var e=n.dom().childNodes;return d.from(e[t]).map(sn.fromDom)},tt=function(n,t){Gn(n).each(function(e){e.dom().insertBefore(t.dom(),n.dom())})},et=function(n,t){Qn(n).fold(function(){Gn(n).each(function(n){ot(n,t)})},function(n){tt(n,t)})},rt=function(n,t){(function(n){return nt(n,0)})(n).fold(function(){ot(n,t)},function(e){n.dom().insertBefore(t.dom(),e.dom())})},ot=function(n,t){n.dom().appendChild(t.dom())},ut=function(n,t){tt(n,t),ot(t,n)},it=function(n,t){D(t,function(e,r){var o=0===r?n:t[r-1];et(o,e)})},ct=function(n,t){D(t,function(t){ot(n,t)})},at=function(n){n.dom().textContent="",D(Zn(n),function(n){lt(n)})},lt=function(n){var t=n.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},ft=function(n){var t,e=Zn(n);e.length>0&&(t=n,D(e,function(n){tt(t,n)})),lt(n)},st=function(n,t,e){return{element:r(n),rowspan:r(t),colspan:r(e)}},dt=function(n,t,e){return{element:r(n),cells:r(t),section:r(e)}},mt=function(n,t){return{element:r(n),isNew:r(t)}},gt=function(n,t){return{cells:r(n),section:r(t)}},pt=function(n,t){var e=[];return D(Zn(n),function(n){t(n)&&(e=e.concat([n])),e=e.concat(pt(n,t))}),e},ht=function(n,t,e){return function(n,t,e){return A(Yn(n,e),t)}(n,function(n){return Hn(n,t)},e)},vt=function(n,t){return function(n,t){return A(Zn(n),t)}(n,function(n){return Hn(n,t)})},bt=function(t,e){return function(t,e){var r=void 0===e?n.document:e.dom();return qn(r)?[]:O(r.querySelectorAll(t),sn.fromDom)}(e,t)};function wt(n,t,e,r,o){return n(e,r)?d.some(e):w(o)&&o(e)?d.none():t(e,r,o)}var yt=function(n,t,e){for(var o=n.dom(),u=w(e)?e:r(!1);o.parentNode;){o=o.parentNode;var i=sn.fromDom(o);if(t(i))return d.some(i);if(u(i))break}return d.none()},St=function(n,t,e){return yt(n,function(n){return Hn(n,t)},e)},xt=function(n,t){return function(n,t){return B(n.dom().childNodes,function(n){return t(sn.fromDom(n))}).map(sn.fromDom)}(n,function(n){return Hn(n,t)})},Ct=function(t,e){return function(t,e){var r=void 0===e?n.document:e.dom();return qn(r)?d.none():d.from(r.querySelector(t)).map(sn.fromDom)}(e,t)},Rt=function(n,t,e){return wt(function(n,t){return Hn(n,t)},St,n,t,e)},Tt=function(n,t,e){return void 0===e&&(e=0),nn(n,t).map(function(n){return parseInt(n,10)}).getOr(e)},Ot=function(n,t){return Tt(n,t,1)},Dt=function(n){return Ot(n,"colspan")>1},At=function(n){return Ot(n,"rowspan")>1},Et=function(n,t){return parseInt(vn(n,t),10)},kt=r(10),Bt=r(10),Nt=function(n,t){return It(n,t,r(!0))},It=function(n,t,e){return P(Zn(n),function(n){return Hn(n,t)?e(n)?[n]:[]:It(n,t,e)})},Pt=function(n,t){return function(n,t,e){if(void 0===e&&(e=c),e(t))return d.none();if(R(n,U(t)))return d.some(t);return St(t,n.join(","),function(n){return Hn(n,"table")||e(n)})}(["td","th"],n,t)},Mt=function(n){return Nt(n,"th,td")},_t=function(n,t){return Gn(t).map(function(t){return vt(t,n)})},Wt=(u(_t,"th,td"),u(_t,"tr"),function(n,t){return Rt(n,"table",t)}),jt=function(n){var t=Nt(n,"tr");return O(t,function(n){var t=n,e=Gn(t).map(function(n){var t=U(n);return"tfoot"===t||"thead"===t||"tbody"===t?t:"tbody"}).getOr("tbody"),r=O(Mt(n),function(n){var t=Tt(n,"rowspan",1),e=Tt(n,"colspan",1);return st(n,t,e)});return dt(t,r,e)})},zt=function(n,t){return n+","+t},Lt=function(n,t){var e=P(n.all,function(n){return n.cells()});return A(e,t)},Ft={generate:function(n){var t,e={},o=[],u=n.length,i=0;return D(n,function(n,t){var u=[];D(n.cells(),function(n){for(var o=0;void 0!==e[zt(t,o)];)o++;for(var c,a,l,f,s,d=(c=n.element(),a=n.rowspan(),l=n.colspan(),f=t,s=o,{element:r(c),rowspan:r(a),colspan:r(l),row:r(f),column:r(s)}),m=0;m<n.colspan();m++)for(var g=0;g<n.rowspan();g++){var p=o+m,h=zt(t+g,p);e[h]=d,i=Math.max(i,p+1)}u.push(d)}),o.push(dt(n.element(),u,n.section()))}),{grid:(t=i,{rows:r(u),columns:r(t)}),access:e,all:o}},getAt:function(n,t,e){var r=n.access[zt(t,e)];return void 0!==r?d.some(r):d.none()},findItem:function(n,t,e){var r=Lt(n,function(n){return e(t,n.element())});return r.length>0?d.some(r[0]):d.none()},filterItems:Lt,justCells:function(n){var t=O(n.all,function(n){return n.cells()});return I(t)}},Ht=function(n,t,e){var r=n[e].element(),o=sn.fromTag("td");ot(o,sn.fromTag("br")),(t?ot:rt)(r,o)},qt=function(n,t){var e=function(n){return Hn(n.element(),t)},r=jt(n),o=Ft.generate(r),u=function(n,t){var e=n.grid.columns(),r=n.grid.rows(),o=e,u=0,i=0;return z(n.access,function(n){if(t(n)){var e=n.row(),c=e+n.rowspan()-1,a=n.column(),l=a+n.colspan()-1;e<r?r=e:c>u&&(u=c),a<o?o=a:l>i&&(i=l)}}),function(n,t,e,r){return{minRow:n,minCol:t,maxRow:e,maxCol:r}}(r,o,u,i)}(o,e),i="th:not("+t+"),td:not("+t+")",c=It(n,"th,td",function(n){return Hn(n,i)});return D(c,lt),function(n,t,e,r){for(var o=t.grid.columns(),u=t.grid.rows(),i=0;i<u;i++)for(var c=!1,a=0;a<o;a++)i<e.minRow||i>e.maxRow||a<e.minCol||a>e.maxCol||(Ft.getAt(t,i,a).filter(r).isNone()?Ht(n,c,i):c=!0)}(r,o,u,e),function(n,t){var e=A(Nt(n,"tr"),function(n){return 0===n.dom().childElementCount});D(e,lt),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||D(Nt(n,"th,td"),function(n){en(n,"rowspan"),en(n,"colspan")}),en(n,"width"),en(n,"height"),yn(n,"width"),yn(n,"height")}(n,u),n};var Ut=function(n,t){var e=function(t){return n(t)?d.from(t.dom().nodeValue):d.none()};return{get:function(r){if(!n(r))throw new Error("Can only get "+t+" value of a "+t+" node");return e(r).getOr("")},getOption:e,set:function(e,r){if(!n(e))throw new Error("Can only set raw "+t+" value of a "+t+" node");e.dom().nodeValue=r}}}(G,"text"),Vt=function(n){return Ut.get(n)},Kt=function(n){return Ut.getOption(n)},Xt=function(n,t){return Ut.set(n,t)},$t=function(n){return"img"===U(n)?1:Kt(n).fold(function(){return Zn(n).length},function(n){return n.length})},Gt=["img","br"],Yt=function(n){return Kt(n).filter(function(n){return 0!==n.trim().length||n.indexOf("Â ")>-1}).isSome()||R(Gt,U(n))},Jt=function(n){return t=Yt,(e=function(n){for(var r=0;r<n.childNodes.length;r++){var o=sn.fromDom(n.childNodes[r]);if(t(o))return d.some(o);var u=e(n.childNodes[r]);if(u.isSome())return u}return d.none()})(n.dom());var t,e},Qt=function(n){return Zt(n,Yt)},Zt=function(n,t){var e=function(n){for(var r=Zn(n),o=r.length-1;o>=0;o--){var u=r[o];if(t(u))return d.some(u);var i=e(u);if(i.isSome())return i}return d.none()};return e(n)},ne=function(n,t){return sn.fromDom(n.dom().cloneNode(t))},te=function(n){return ne(n,!1)},ee=function(n){return ne(n,!0)},re=function(n,t){var e=function(n,t){var e=sn.fromTag(t),r=rn(n);return Q(e,r),e}(n,t),r=Zn(ee(n));return ct(e,r),e},oe=function(){var n=sn.fromTag("td");return ot(n,sn.fromTag("br")),n},ue=function(n,t,e){var r=re(n,t);return z(e,function(n,t){null===n?en(r,t):J(r,t,n)}),r},ie=function(n){return n},ce=function(n){return function(){return sn.fromTag("tr",n.dom())}},ae=function(n,t,e){return{row:ce(t),cell:function(t){var r,o,u,i,c=$n(t.element()),a=sn.fromTag(U(t.element()),c.dom()),l=e.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),f=l.length>0?function(n,t,e){return Jt(n).map(function(r){var o=e.join(","),u=ht(r,o,function(t){return Un(t,n)});return E(u,function(n,t){var e=te(t);return en(e,"contenteditable"),ot(n,e),e},t)}).getOr(t)}(t.element(),a,l):a;return ot(f,sn.fromTag("br")),r=t.element(),o=a,u=r.dom(),i=o.dom(),ln(u)&&ln(i)&&(i.style.cssText=u.style.cssText),yn(a,"height"),1!==t.colspan()&&yn(t.element(),"width"),n(t.element(),a),a},replace:ue,gap:oe}},le=function(n){return{row:ce(n),cell:oe,replace:ie,gap:oe}},fe=function(n,t){var e=t.column(),r=t.column()+t.colspan()-1,o=t.row(),u=t.row()+t.rowspan()-1;return e<=n.finishCol()&&r>=n.startCol()&&o<=n.finishRow()&&u>=n.startRow()},se=function(n,t){return t.column()>=n.startCol()&&t.column()+t.colspan()-1<=n.finishCol()&&t.row()>=n.startRow()&&t.row()+t.rowspan()-1<=n.finishRow()},de=function(n,t){return e=Math.min(n.row(),t.row()),o=Math.min(n.column(),t.column()),u=Math.max(n.row()+n.rowspan()-1,t.row()+t.rowspan()-1),i=Math.max(n.column()+n.colspan()-1,t.column()+t.colspan()-1),{startRow:r(e),startCol:r(o),finishRow:r(u),finishCol:r(i)};var e,o,u,i},me=function(n,t,e){var r=Ft.findItem(n,t,Un),o=Ft.findItem(n,e,Un);return r.bind(function(n){return o.map(function(t){return de(n,t)})})},ge=function(n,t,e){return me(n,t,e).bind(function(t){return function(n,t){for(var e=!0,r=u(se,t),o=t.startRow();o<=t.finishRow();o++)for(var i=t.startCol();i<=t.finishCol();i++)e=e&&Ft.getAt(n,o,i).exists(r);return e?d.some(t):d.none()}(n,t)})},pe=function(n,t,e){return me(n,t,e).map(function(t){var e=Ft.filterItems(n,u(fe,t));return O(e,function(n){return n.element()})})},he=function(n,t){return Ft.findItem(n,t,function(n,t){return Kn(t,n)}).map(function(n){return n.element()})},ve=function(n,t,e){return Wt(n).bind(function(r){return function(n,t,e,r){return Ft.findItem(n,t,Un).bind(function(t){var o=e>0?t.row()+t.rowspan()-1:t.row(),u=r>0?t.column()+t.colspan()-1:t.column();return Ft.getAt(n,o+e,u+r).map(function(n){return n.element()})})}(we(r),n,t,e)})},be=function(n,t,e,r,o){var u=we(n),i=Un(n,e)?d.some(t):he(u,t),c=Un(n,o)?d.some(r):he(u,r);return i.bind(function(n){return c.bind(function(t){return pe(u,n,t)})})},we=function(n){var t=jt(n);return Ft.generate(t)},ye=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Se(){return{up:r({selector:St,closest:Rt,predicate:yt,all:Yn}),down:r({selector:bt,predicate:pt}),styles:r({get:vn,getRaw:wn,set:pn,remove:yn}),attrs:r({get:Z,set:J,remove:en,copyTo:function(n,t){var e=rn(n);Q(t,e)}}),insert:r({before:tt,after:et,afterAll:it,append:ot,appendAll:ct,prepend:rt,wrap:ut}),remove:r({unwrap:ft,remove:lt}),create:r({nu:sn.fromTag,clone:function(n){return sn.fromDom(n.dom().cloneNode(!1))},text:sn.fromText}),query:r({comparePosition:function(n,t){return n.dom().compareDocumentPosition(t.dom())},prevSibling:Jn,nextSibling:Qn}),property:r({children:Zn,name:U,parent:Gn,document:function(n){return n.dom().ownerDocument},isText:G,isComment:X,isElement:$,getText:Vt,setText:Xt,isBoundary:function(n){return!!$(n)&&("body"===U(n)||R(ye,U(n)))},isEmptyTag:function(n){return!!$(n)&&R(["br","img","hr","input"],U(n))},isNonEditable:function(n){return $(n)&&"false"===Z(n,"contenteditable")}}),eq:Un,is:Xn}}var xe=function(n,t,e,r){var o=t(n,e);return E(r,function(e,r){var o=t(n,r);return Ce(n,e,o)},o)},Ce=function(n,t,e){return t.bind(function(t){return e.filter(u(n.eq,t))})},Re=function(n,t,e){return e.length>0?function(n,t,e,r){return r(n,t,e[0],e.slice(1))}(n,t,e,xe):d.none()},Te=function(n,t,e,o){void 0===o&&(o=c);var i=[t].concat(n.up().all(t)),a=[e].concat(n.up().all(e)),l=function(n){return N(n,o).fold(function(){return n},function(t){return n.slice(0,t+1)})},f=l(i),s=l(a),d=B(f,function(t){return T(s,function(n,t){return u(n.eq,t)}(n,t))});return{firstpath:r(f),secondpath:r(s),shared:r(d)}},Oe=Se(),De=function(n,t){return Re(Oe,function(t,e){return n(e)},t)},Ae=function(n){return St(n,"table")},Ee=function(n,t,e){var r=function(n){return function(t){return void 0!==e&&e(t)||Un(t,n)}};return Un(n,t)?d.some({boxes:d.some([n]),start:n,finish:t}):Ae(n).bind(function(o){return Ae(t).bind(function(u){if(Un(o,u))return d.some({boxes:(l=o,f=n,s=t,m=we(l),pe(m,f,s)),start:n,finish:t});if(Kn(o,u)){var i=(c=ht(t,"td,th",r(o))).length>0?c[c.length-1]:t;return d.some({boxes:be(o,n,o,t,u),start:n,finish:i})}if(Kn(u,o)){var c,a=(c=ht(n,"td,th",r(u))).length>0?c[c.length-1]:n;return d.some({boxes:be(u,n,o,t,u),start:n,finish:a})}return function(n,t,e){return Te(Oe,n,t,e)}(n,t).shared().bind(function(i){return Rt(i,"table",e).bind(function(e){var i=ht(t,"td,th",r(e)),c=i.length>0?i[i.length-1]:t,a=ht(n,"td,th",r(e)),l=a.length>0?a[a.length-1]:n;return d.some({boxes:be(e,n,o,t,u),start:l,finish:c})})});var l,f,s,m})})},ke=function(n,t){var e=bt(n,t);return e.length>0?d.some(e):d.none()},Be=function(n,t,e){return Ct(n,t).bind(function(t){return Ct(n,e).bind(function(n){return De(Ae,[t,n]).map(function(e){return{first:r(t),last:r(n),table:r(e)}})})})},Ne=function(n,t,e,r,o){return function(n,t){return B(n,function(n){return Hn(n,t)})}(n,o).bind(function(n){return ve(n,t,e).bind(function(n){return function(n,t){return St(n,"table").bind(function(e){return Ct(e,t).bind(function(t){return Ee(t,n).bind(function(n){return n.boxes.map(function(t){return{boxes:t,start:n.start,finish:n.finish}})})})})}(n,r)})})},Ie=function(n,t,e){return Be(n,t,e).bind(function(t){var e=function(t){return Un(n,t)},r=St(t.first(),"thead,tfoot,tbody,table",e),o=St(t.last(),"thead,tfoot,tbody,table",e);return r.bind(function(n){return o.bind(function(e){return Un(n,e)?(r=t.table(),o=t.first(),u=t.last(),i=we(r),ge(i,o,u)):d.none();var r,o,u,i})})})},Pe="data-mce-first-selected",Me="data-mce-last-selected",_e=Object.freeze({__proto__:null,selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",attributeSelector:"[data-mce-selected]",firstSelected:Pe,firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:Me,lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"}),We=function(t){if(!v(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var e=[],r={};return D(t,function(o,u){var i=W(o);if(1!==i.length)throw new Error("one and only one name per case");var c=i[0],a=o[c];if(void 0!==r[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!v(a))throw new Error("case arguments must be an array");e.push(c),r[c]=function(){var r=arguments.length;if(r!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+r);for(var o=new Array(r),i=0;i<o.length;i++)o[i]=arguments[i];return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[u].apply(null,o)},match:function(n){var t=W(n);if(e.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+t.join(","));if(!M(e,function(n){return R(t,n)}))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+e.join(", "));return n[c].apply(null,o)},log:function(t){n.console.log(t,{constructors:e,constructor:c,params:o})}}}}),r},je=We([{none:[]},{multiple:["elements"]},{single:["selection"]}]),ze=function(n,t,e,r){return n.fold(t,e,r)},Le=je.none,Fe=je.multiple,He=je.single,qe=function(n,t){return ze(t.get(),r([]),o,r([n]))},Ue=function(n,t){var e=qe(n,t);return e.length>0&&M(e,function(n){return tn(n,"rowspan")&&parseInt(Z(n,"rowspan"),10)>1||tn(n,"colspan")&&parseInt(Z(n,"colspan"),10)>1})?d.some(e):d.none()},Ve=function(n,t){return ze(t.get(),d.none,function(t,e){return 0===t.length?d.none():Ie(n,"td[data-mce-first-selected],th[data-mce-first-selected]","td[data-mce-last-selected],th[data-mce-last-selected]").bind(function(n){return t.length>1?d.some({bounds:r(n),cells:r(t)}):d.none()})},d.none)},Ke=function(n){return{element:r(n),mergable:d.none,unmergable:d.none,selection:r([n])}},Xe=function(n,t,e){return{element:r(e),mergable:r(Ve(t,n)),unmergable:r(Ue(e,n)),selection:r(qe(e,n))}},$e=function(t,o,u,i){t.on("BeforeGetContent",function(n){!0===n.selection&&ze(o.get(),e,function(e){n.preventDefault(),function(n){return Wt(n[0]).map(ee).map(function(n){return[qt(n,"[data-mce-selected]")]})}(e).each(function(e){n.content="text"===n.format?function(n){return O(n,function(n){return n.dom().innerText}).join("")}(e):function(n,t){return O(t,function(t){return n.selection.serializer.serialize(t.dom(),{})}).join("")}(t,e)})},e)}),t.on("BeforeSetContent",function(e){!0===e.selection&&!0===e.paste&&d.from(t.dom.getParent(t.selection.getStart(),"th,td")).each(function(o){var c=sn.fromDom(o);Wt(c).each(function(o){var a,l,f,s=A((a=e.content,(f=(l||n.document).createElement("div")).innerHTML=a,Zn(sn.fromDom(f))),function(n){return"meta"!==U(n)});if(1===s.length&&"table"===U(s[0])){e.preventDefault();var d=sn.fromDom(t.getDoc()),m=le(d),g=function(n,t,e){return{element:r(n),clipboard:r(t),generators:r(e)}}(c,s[0],m);u.pasteCells(o,g).each(function(n){t.selection.setRng(n),t.focus(),i.clear(o)})}})})})};function Ge(n,t){var e=function(e){var r=t(e);if(r<=0||null===r){var o=vn(e,n);return parseFloat(o)||0}return r},r=function(n,t){return k(t,function(t,e){var r=vn(n,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o},0)};return{set:function(t,e){if(!y(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e);var r=t.dom();ln(r)&&(r.style[n]=e+"px")},get:e,getOuter:e,aggregate:r,max:function(n,t,e){var o=r(n,e);return t>o?t-o:0}}}var Ye=Ge("height",function(n){var t=n.dom();return dn(n)?t.getBoundingClientRect().height:t.offsetHeight}),Je=function(n){return Ye.get(n)},Qe=function(n){return Ye.getOuter(n)},Ze=Ge("width",function(n){return n.dom().offsetWidth}),nr=function(n){return Ze.get(n)},tr=function(n){return Ze.getOuter(n)},er=function(n,t,e){return function(n,t){var e=parseFloat(n);return isNaN(e)?t:e}(vn(n,t),e)},rr=function(n){return(t=Fn()).browser.isIE()||t.browser.isEdge()?function(n){var t=er(n,"padding-top",0),e=er(n,"padding-bottom",0),r=er(n,"border-top-width",0),o=er(n,"border-bottom-width",0),u=n.dom().getBoundingClientRect().height;return"border-box"===vn(n,"box-sizing")?u:u-t-e-(r+o)}(n):er(n,"height",Je(n));var t},or=/(\d+(\.\d+)?)(\w|%)*/,ur=/(\d+(\.\d+)?)%/,ir=/(\d+(\.\d+)?)px|em/,cr=function(n,t){pn(n,"width",t+"px")},ar=function(n,t){pn(n,"width",t+"%")},lr=function(n,t){pn(n,"height",t+"px")},fr=function(n,t,e,r){var o,u,i=parseInt(n,10);return on(o=n,u="%",o.length-u.length)&&"table"!==U(t)?function(n,t,e,r){var o=Wt(n).map(function(n){var r=e(n);return Math.floor(t/100*r)}).getOr(t);return r(n,o),o}(t,i,e,r):i},sr=function(n){var t=function(n){return wn(n,"height").getOrThunk(function(){return rr(n)+"px"})}(n);return t?fr(t,n,Je,lr):Je(n)},dr=function(n){return wn(n,"width").fold(function(){return d.from(Z(n,"width"))},function(n){return d.some(n)})},mr=function(n,t){return n/t.pixelWidth()*100},gr=function(n,t){return dr(n).fold(function(){var e=nr(n);return mr(e,t)},function(e){return function(n,t,e){var r=ur.exec(t);if(null!==r)return parseFloat(r[1]);var o=nr(n);return mr(o,e)}(n,e,t)})},pr=function(n,t){return dr(n).fold(function(){return nr(n)},function(e){return function(n,t,e){var r=ir.exec(t);if(null!==r)return parseInt(r[1],10);var o=ur.exec(t);return null!==o?function(n,t){return n/100*t.pixelWidth()}(parseFloat(o[1]),e):nr(n)}(n,e,t)})},hr=function(n){return function(n,t,e){return e(n)/Ot(n,t)}(n,"rowspan",sr)},vr=function(n,t,e){pn(n,"width",t+e)},br=r(ur),wr=r(ir),yr=function(n,t){dr(n).bind(function(n){var t=or.exec(n);return null!==t?d.some({width:r(parseFloat(t[1])),unit:r(t[3])}):d.none()}).each(function(e){var r=e.width()/2;vr(n,r,e.unit()),vr(t,r,e.unit())})},Sr=function(n,t){return{left:r(n),top:r(t),translate:function(e,r){return Sr(n+e,t+r)}}},xr=Sr,Cr=function(n,t){return void 0!==n?n:void 0!==t?t:0},Rr=function(n){var t=n.dom().ownerDocument,e=t.body,r=t.defaultView,o=t.documentElement;if(e===n.dom())return xr(e.offsetLeft,e.offsetTop);var u=Cr(r.pageYOffset,o.scrollTop),i=Cr(r.pageXOffset,o.scrollLeft),c=Cr(o.clientTop,e.clientTop),a=Cr(o.clientLeft,e.clientLeft);return Tr(n).translate(i-a,u-c)},Tr=function(n){var t=n.dom(),e=t.ownerDocument.body;return e===t?xr(e.offsetLeft,e.offsetTop):dn(n)?function(n){var t=n.getBoundingClientRect();return xr(t.left,t.top)}(t):xr(0,0)},Or=function(n,t){return{row:n,y:t}},Dr=function(n,t){return{col:n,x:t}},Ar=function(n){return Rr(n).left()+tr(n)},Er=function(n){return Rr(n).left()},kr=function(n,t){return Dr(n,Er(t))},Br=function(n,t){return Dr(n,Ar(t))},Nr=function(n){return Rr(n).top()},Ir=function(n,t){return Or(n,Nr(t))},Pr=function(n,t){return Or(n,Nr(t)+Qe(t))},Mr=function(n,t,e){if(0===e.length)return[];var r=O(e.slice(1),function(t,e){return t.map(function(t){return n(e,t)})}),o=e[e.length-1].map(function(n){return t(e.length-1,n)});return r.concat([o])},_r={delta:o,positions:function(n){return Mr(Ir,Pr,n)},edge:Nr},Wr={ltr:{delta:o,edge:Er,positions:function(n){return Mr(kr,Br,n)}},rtl:{delta:function(n){return-n},edge:Ar,positions:function(n){return Mr(Br,kr,n)}}};function jr(n){var t=function(t){return n(t).isRtl()?Wr.rtl:Wr.ltr};return{delta:function(n,e){return t(e).delta(n,e)},edge:function(n){return t(n).edge(n)},positions:function(n,e){return t(e).positions(n,e)}}}var zr=function(n){var t=jt(n);return Ft.generate(t).grid},Lr=function(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t},Fr=function(n,t,e,r){e===r?en(n,t):J(n,t,e)},Hr=function(n,t){var e=[],r=[],o=function(t,o){t.length>0?function(t,o){var u=xt(n,o).getOrThunk(function(){var t=sn.fromTag(o,$n(n).dom());return ot(n,t),t});at(u);var i=O(t,function(n){n.isNew()&&e.push(n.element());var t=n.element();return at(t),D(n.cells(),function(n){n.isNew()&&r.push(n.element()),Fr(n.element(),"colspan",n.colspan(),1),Fr(n.element(),"rowspan",n.rowspan(),1),ot(t,n.element())}),t});ct(u,i)}(t,o):function(t){xt(n,t).each(lt)}(o)},u=[],i=[],c=[];return D(t,function(n){switch(n.section()){case"thead":u.push(n);break;case"tbody":i.push(n);break;case"tfoot":c.push(n)}}),o(u,"thead"),o(i,"tbody"),o(c,"tfoot"),{newRows:e,newCells:r}},qr=function(n,t){var e=Z(n,t);return void 0===e||""===e?[]:e.split(" ")},Ur=function(n){return void 0!==n.dom().classList},Vr=function(n,t){return function(n,t,e){var r=qr(n,t).concat([e]);return J(n,t,r.join(" ")),!0}(n,"class",t)},Kr=function(n,t){return function(n,t,e){var r=A(qr(n,t),function(n){return n!==e});return r.length>0?J(n,t,r.join(" ")):en(n,t),!1}(n,"class",t)},Xr=function(n,t){Ur(n)?n.dom().classList.add(t):Vr(n,t)},$r=function(n){0===(Ur(n)?n.dom().classList:function(n){return qr(n,"class")}(n)).length&&en(n,"class")},Gr=function(n,t){return Ur(n)&&n.dom().classList.contains(t)},Yr=function(n,t){for(var e=[],r=n;r<t;r++)e.push(r);return e},Jr=function(n,t){if(t<0||t>=n.length-1)return d.none();var e=n[t].fold(function(){var e=function(n){var t=S.call(n,0);return t.reverse(),t}(n.slice(0,t));return _(e,function(n,t){return n.map(function(n){return{value:n,delta:t+1}})})},function(n){return d.some({value:n,delta:0})}),r=n[t+1].fold(function(){var e=n.slice(t+1);return _(e,function(n,t){return n.map(function(n){return{value:n,delta:t+1}})})},function(n){return d.some({value:n,delta:1})});return e.bind(function(n){return r.map(function(t){var e=t.delta+n.delta;return Math.abs(t.value-n.value)/e})})},Qr=function(n){var t=n.grid,e=Yr(0,t.columns()),o=Yr(0,t.rows());return O(e,function(t){return Zr(function(){return P(o,function(e){return Ft.getAt(n,e,t).filter(function(n){return n.column()===t}).fold(r([]),function(n){return[n]})})},function(n){return 1===n.colspan()},function(){return Ft.getAt(n,0,t)})})},Zr=function(n,t,e){var r=n();return B(r,t).orThunk(function(){return d.from(r[0]).orThunk(e)}).map(function(n){return n.element()})},no=function(n){var t=n.grid,e=Yr(0,t.rows()),o=Yr(0,t.columns());return O(e,function(t){return Zr(function(){return P(o,function(e){return Ft.getAt(n,t,e).filter(function(n){return n.row()===t}).fold(r([]),function(n){return[n]})})},function(n){return 1===n.rowspan()},function(){return Ft.getAt(n,t,0)})})},to=function(n){var t=n.replace(/\./g,"-");return{resolve:function(n){return t+"-"+n}}},eo=to("ephox-snooker"),ro=eo.resolve,oo=ro("resizer-bar"),uo=ro("resizer-rows"),io=ro("resizer-cols"),co=function(n){var t=bt(n.parent(),"."+oo);D(t,lt)},ao=function(n,t,e){var r=n.origin();D(t,function(t){t.each(function(t){var o=e(r,t);Xr(o,oo),ot(n.parent(),o)})})},lo=function(n,t,e,r){ao(n,t,function(n,t){var o,u,i,c,a,l,f=(o=t.col,u=t.x-n.left(),i=e.top()-n.top(),c=7,a=r,l=sn.fromTag("div"),hn(l,{position:"absolute",left:u-c/2+"px",top:i+"px",height:a+"px",width:c+"px"}),Q(l,{"data-column":o,role:"presentation"}),l);return Xr(f,io),f})},fo=function(n,t,e,r){ao(n,t,function(n,t){var o,u,i,c,a,l,f=(o=t.row,u=e.left()-n.left(),i=t.y-n.top(),c=r,a=7,l=sn.fromTag("div"),hn(l,{position:"absolute",left:u+"px",top:i-a/2+"px",height:a+"px",width:c+"px"}),Q(l,{"data-row":o,role:"presentation"}),l);return Xr(f,uo),f})},so=function(n,t,e,r){co(n);var o=jt(t),u=Ft.generate(o);!function(n,t,e,r,o,u){var i=Rr(t),c=e.length>0?o.positions(e,t):[];fo(n,c,i,tr(t));var a=r.length>0?u.positions(r,t):[];lo(n,a,i,Qe(t))}(n,t,no(u),Qr(u),e,r)},mo=function(n,t){var e=bt(n.parent(),"."+oo);D(e,t)},go=function(n){mo(n,function(n){pn(n,"display","none")})},po=function(n){mo(n,function(n){pn(n,"display","block")})},ho=function(n,t,e){n.cells()[t]=e},vo=function(n,t){return gt(t,n.section())},bo=function(n,t){var e=n.cells(),r=O(e,t);return gt(r,n.section())},wo=function(n,t){return n.cells()[t]},yo=function(n,t){return wo(n,t).element()},So=function(n){return n.cells().length},xo=function(n,t){if(0===n.length)return 0;var e=n[0];return N(n,function(n){return!t(e.element(),n.element())}).fold(function(){return n.length},function(n){return n})},Co=function(n,t,e,r){var o=function(n,t){return n[t]}(n,t).cells().slice(e),u=xo(o,r),i=function(n,t){return O(n,function(n){return wo(n,t)})}(n,e).slice(t);return{colspan:u,rowspan:xo(i,r)}},Ro=function(n,t){var e=O(n,function(n){return O(n.cells(),function(){return!1})});return O(n,function(o,u){return function(n,t){return{details:r(n),section:r(t)}}(P(o.cells(),function(o,i){if(!1===e[u][i]){var c=Co(n,u,i,t);return function(n,t,r,o){for(var u=n;u<n+r;u++)for(var i=t;i<t+o;i++)e[u][i]=!0}(u,i,c.rowspan,c.colspan),[(a=o.element(),l=c.rowspan,f=c.colspan,s=o.isNew(),{element:r(a),rowspan:r(l),colspan:r(f),isNew:r(s)})]}return[];var a,l,f,s}),o.section())})},To=function(n,t,e){for(var r=[],o=0;o<n.grid.rows();o++){for(var u=[],i=0;i<n.grid.columns();i++){var c=Ft.getAt(n,o,i).map(function(n){return mt(n.element(),e)}).getOrThunk(function(){return mt(t.gap(),!0)});u.push(c)}var a=gt(u,n.all[o].section());r.push(a)}return r},Oo=function(n,t){return O(n,function(n){var e,o,u,i,c=function(n){return _(n,function(n){return Gn(n.element()).map(function(n){var t=Gn(n).isNone();return mt(n,t)})}).getOrThunk(function(){return mt(t.row(),!0)})}(n.details());return e=c.element(),o=n.details(),u=n.section(),i=c.isNew(),{element:r(e),cells:r(o),section:r(u),isNew:r(i)}})},Do=function(n,t){var e=Ro(n,Un);return Oo(e,t)},Ao=function(n,t){return _(n.all,function(n){return B(n.cells(),function(n){return Un(t,n.element())})})},Eo=function(n,t,e,o,u){return function(i,c,a,l,f){var s=jt(c),m=Ft.generate(s);return t(m,a).map(function(t){var e=function(n,t){return To(n,t,!1)}(m,l),o=n(e,t,Un,u(l)),i=Do(o.grid(),l);return{grid:r(i),cursor:o.cursor}}).fold(function(){return d.none()},function(n){var t=Hr(c,n.grid());return e(c,n.grid(),f),o(c),so(i,c,_r,f),d.some({cursor:n.cursor,newRows:r(t.newRows),newCells:r(t.newCells)})})}},ko=function(n,t){return Pt(t.element()).bind(function(t){return Ao(n,t)})},Bo=function(n,t){var e=O(t.selection(),function(t){return Pt(t).bind(function(t){return Ao(n,t)})}),r=Lr(e);return r.length>0?d.some({cells:r,generators:t.generators,clipboard:t.clipboard}):d.none()},No=function(n,t){var e=O(t.selection(),function(t){return Pt(t).bind(function(t){return Ao(n,t)})}),r=Lr(e);return r.length>0?d.some(r):d.none()},Io=function(n){return{is:function(t){return n===t},isValue:a,isError:c,getOr:r(n),getOrThunk:r(n),getOrDie:r(n),or:function(t){return Io(n)},orThunk:function(t){return Io(n)},fold:function(t,e){return e(n)},map:function(t){return Io(t(n))},mapError:function(t){return Io(n)},each:function(t){t(n)},bind:function(t){return t(n)},exists:function(t){return t(n)},forall:function(t){return t(n)},toOption:function(){return d.some(n)}}},Po=function(n){return{is:c,isValue:c,isError:a,getOr:o,getOrThunk:function(n){return n()},getOrDie:function(){return(t=String(n),function(){throw new Error(t)})();var t},or:function(n){return n},orThunk:function(n){return n()},fold:function(t,e){return t(n)},map:function(t){return Po(n)},mapError:function(t){return Po(t(n))},each:e,bind:function(t){return Po(n)},exists:c,forall:a,toOption:d.none}},Mo={value:Io,error:Po,fromOption:function(n,t){return n.fold(function(){return Po(t)},Io)}},_o=function(n,t){return{rowDelta:0,colDelta:So(n[0])-So(t[0])}},Wo=function(n,t){return O(n,function(){return mt(t.cell(),!0)})},jo=function(n,t,e){return n.concat(function(n,t){for(var e=[],r=0;r<n;r++)e.push(t(r));return e}(t,function(t){return vo(n[n.length-1],Wo(n[n.length-1].cells(),e))}))},zo=function(n,t,e){return O(n,function(n){return vo(n,n.cells().concat(Wo(Yr(0,t),e)))})},Lo=function(n,t,e){var r=t.colDelta<0?zo:o;return(t.rowDelta<0?jo:o)(r(n,Math.abs(t.colDelta),e),Math.abs(t.rowDelta),e)},Fo=function(n,t,e,r){for(var o=!0,u=0;u<n.length;u++)for(var i=0;i<So(n[0]);i++){var c=e(yo(n[u],i),t);!0===c&&!1===o?ho(n[u],i,mt(r(),!0)):!0===c&&(o=!1)}return n},Ho=function(n,t,e,r){if(t>0&&t<n.length){var o=function(n,t){return k(n,function(n,e){return T(n,function(n){return t(n.element(),e.element())})?n:n.concat([e])},[])}(n[t-1].cells(),e);D(o,function(o){for(var u=d.none(),i=function(t){for(var i=function(i){var c=n[t].cells()[i];e(c.element(),o.element())&&(u.isNone()&&(u=d.some(r())),u.each(function(e){ho(n[t],i,mt(e,!0))}))},c=0;c<So(n[0]);c++)i(c)},c=t;c<n.length;c++)i(c)})}return n},qo=function(n,t,e,r){var o=u(r,wo(n[t],e).element()),i=n[t];return n.length>1&&So(i)>1&&(e>0&&o(yo(i,e-1))||e<i.cells().length-1&&o(yo(i,e+1))||t>0&&o(yo(n[t-1],e))||t<n.length-1&&o(yo(n[t+1],e)))},Uo=function(n,t,e,r,o){return function(n,t,e){if(n.row()>=t.length||n.column()>So(t[0]))return Mo.error("invalid start address out of table bounds, row: "+n.row()+", column: "+n.column());var r=t.slice(n.row()),o=r[0].cells().slice(n.column()),u=So(e[0]),i=e.length;return Mo.value({rowDelta:r.length-i,colDelta:o.length-u})}(n,t,e).map(function(u){var i=Lo(t,u,r);return function(n,t,e,r,o){for(var u=n.row(),i=n.column(),c=u+e.length,a=i+So(e[0]),l=u;l<c;l++)for(var f=i;f<a;f++){qo(t,l,f,o)&&Fo(t,yo(t[l],f),o,r.cell);var s=yo(e[l-u],f-i),d=r.replace(s);ho(t[l],f,mt(d,!0))}return t}(n,i,e,r,o)})},Vo=function(n,t,e,r,o){Ho(t,n,o,r.cell);var u=_o(e,t),i=Lo(e,u,r),c=_o(t,i),a=Lo(t,c,r);return a.slice(0,n).concat(i).concat(a.slice(n,a.length))},Ko=function(n,t,e,r,o){var u=n.slice(0,t),i=n.slice(t),c=bo(n[e],function(e,u){return t>0&&t<n.length&&r(yo(n[t-1],u),yo(n[t],u))?wo(n[t],u):mt(o(e.element(),r),!0)});return u.concat([c]).concat(i)},Xo=function(n,t,e,r,o){return O(n,function(n){var u=t>0&&t<So(n)&&r(yo(n,t-1),yo(n,t))?wo(n,t):mt(o(yo(n,e),r),!0);return function(n,t,e){var r=n.cells(),o=r.slice(0,t),u=r.slice(t),i=o.concat([e]).concat(u);return vo(n,i)}(n,t,u)})},$o=function(n,t,e,r){return O(n,function(n){return bo(n,function(n){return function(n){return T(t,function(t){return e(n.element(),t.element())})}(n)?mt(r(n.element(),e),!0):n})})},Go=function(n,t,e,r){return void 0!==yo(n[t],e)&&t>0&&r(yo(n[t-1],e),yo(n[t],e))},Yo=function(n,t,e){return t>0&&e(yo(n,t-1),yo(n,t))},Jo=function(n,t,e,r){var o=P(n,function(r,o){return Go(n,o,t,e)||Yo(r,t,e)?[]:[wo(r,t)]});return $o(n,o,e,r)},Qo=function(n,t,e,r){var o=n[t],u=P(o.cells(),function(r,u){return Go(n,t,u,e)||Yo(o,u,e)?[]:[r]});return $o(n,u,e,r)},Zo=We([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),nu=Sn({},Zo),tu=function(n,t,e,o){var u=n.slice(0),i=function(n,t){return 0===n.length?nu.none():1===n.length?nu.only(0):0===t?nu.left(0,1):t===n.length-1?nu.right(t-1,t):t>0&&t<n.length-1?nu.middle(t-1,t,t+1):nu.none()}(n,t),c=function(n){return O(n,r(0))},a=r(c(u)),l=function(n,t){if(e>=0){var r=Math.max(o.minCellWidth(),u[t]-e);return c(u.slice(0,n)).concat([e,r-u[t]]).concat(c(u.slice(t+1)))}var i=Math.max(o.minCellWidth(),u[n]+e),a=u[n]-i;return c(u.slice(0,n)).concat([i-u[n],a]).concat(c(u.slice(t+1)))},f=l;return i.fold(a,function(n){return o.singleColumnWidth(u[n],e)},f,function(n,t,e){return l(t,e)},function(n,t){if(e>=0)return c(u.slice(0,t)).concat([e]);var r=Math.max(o.minCellWidth(),u[t]+e);return c(u.slice(0,t)).concat([r-u[t]])})},eu=function(n,t,e,r,o){var u=Qr(n),c=O(u,function(n){return n.map(t.edge)});return O(u,function(n,t){return n.filter(i(Dt)).fold(function(){var n=Jr(c,t);return r(n)},function(n){return e(n,o)})})},ru=function(n,t,e){return eu(n,t,gr,function(n){return n.fold(function(){return e.minCellWidth()},function(n){return n/e.pixelWidth()*100})},e)},ou=function(n,t,e){return eu(n,t,pr,function(n){return n.getOrThunk(e.minCellWidth)},e)},uu=function(n,t){return function(n,t,e,r){var o=no(n),u=O(o,function(n){return n.map(t.edge)});return O(o,function(n,t){return n.filter(i(At)).fold(function(){var n=Jr(u,t);return r(n)},function(n){return e(n)})})}(n,t,hr,function(n){return n.getOrThunk(Bt)})},iu=function(n,t,e){for(var r=0,o=n;o<t;o++)r+=void 0!==e[o]?e[o]:0;return r},cu=function(n,t){var e=Ft.justCells(n);return O(e,function(n){var e=iu(n.column(),n.column()+n.colspan(),t);return{element:n.element(),width:e,colspan:n.colspan()}})},au=function(n,t){var e=Ft.justCells(n);return O(e,function(n){var e=iu(n.row(),n.row()+n.rowspan(),t);return{element:n.element,height:r(e),rowspan:n.rowspan}})},lu=function(n){var t=o;return{width:r(n),pixelWidth:r(n),getWidths:ou,getCellDelta:t,singleColumnWidth:function(n,t){return[Math.max(kt(),n+t)-n]},minCellWidth:kt,setElementWidth:cr,setTableWidth:function(n,t,e){var r=E(t,function(n,t){return n+t},0);cr(n,r)}}},fu=function(n,t){var e=br().exec(t);if(null!==e)return function(n,t){var e=parseFloat(n),o=nr(t);return{width:r(e),pixelWidth:r(o),getWidths:ru,getCellDelta:function(n){return n/o*100},singleColumnWidth:function(n,t){return[100-n]},minCellWidth:function(){return kt()/o*100},setElementWidth:ar,setTableWidth:function(n,t,r){ar(n,e+r/100*e)}}}(e[1],n);var o=wr().exec(t);if(null!==o){var u=parseInt(o[1],10);return lu(u)}var i=nr(n);return lu(i)},su=function(n){return dr(n).fold(function(){var t=nr(n);return lu(t)},function(t){return fu(n,t)})},du=function(n){return Ft.generate(n)},mu=function(n){var t=jt(n);return du(t)},gu=function(n,t,e,o){var u=mu(n),i=uu(u,o),c=O(i,function(n,r){return e===r?Math.max(t+n,Bt()):n}),a=au(u,c),l=function(n,t){return O(n.all,function(n,e){return{element:n.element,height:r(t[e])}})}(u,c);D(l,function(n){lr(n.element(),n.height())}),D(a,function(n){lr(n.element(),n.height())});var f=E(c,function(n,t){return n+t},0);lr(n,f)},pu=function(n){return n.slice(0).sort()},hu=function(n,t,e){if(0===t.length)throw new Error("You must specify at least one required field.");var r;return function(n,t){if(!v(t))throw new Error("The "+n+" fields must be an array. Was: "+t+".");D(t,function(t){if(!h(t))throw new Error("The value "+t+" in the "+n+" fields was not a string.")})}("required",t),r=pu(t),B(r,function(n,t){return t<r.length-1&&n===r[t+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+r.join(", ")+"].")}),function(r){var o=W(r);M(t,function(n){return R(o,n)})||function(n,t){throw new Error("All required keys ("+pu(n).join(", ")+") were not specified. Specified keys were: "+pu(t).join(", ")+".")}(t,o),n(t,o);var u=A(t,function(n){return!e.validate(r[n],n)});return u.length>0&&function(n,t){throw new Error("All values need to be of type: "+t+". Keys ("+pu(n).join(", ")+") were not.")}(u,e.label),r}},vu=function(n,t){var e=A(t,function(t){return!R(n,t)});e.length>0&&function(n){throw new Error("Unsupported keys for object: "+pu(n).join(", "))}(e)},bu=function(n){return function(n,t){return hu(n,t,{validate:w,label:"function"})}(vu,n)},wu=bu(["cell","row","replace","gap"]),yu=function(n){var t=Tt(n,"colspan",1),e=Tt(n,"rowspan",1);return{element:r(n),colspan:r(t),rowspan:r(e)}},Su=function(n,e){void 0===e&&(e=yu),wu(n);var r=t(d.none()),o=function(t){return function(t){return n.cell(t)}(e(t))},u=function(n){var t=o(n);return r.get().isNone()&&r.set(d.some(t)),i=d.some({item:n,replacement:t}),t},i=d.none();return{getOrInit:function(n,t){return i.fold(function(){return u(n)},function(e){return t(n,e.item)?e.replacement:u(n)})},cursor:r.get}},xu=function(n,e){return function(r){var o=t(d.none());wu(r);var u=[],i=function(t){var i={scope:n},c=r.replace(t,e,i);return u.push({item:t,sub:c}),o.get().isNone()&&o.set(d.some(c)),c};return{replaceOrInit:function(n,t){return function(n,t){return B(u,function(e){return t(e.item,n)})}(n,t).fold(function(){return i(n)},function(e){return t(n,e.item)?e.sub:i(n)})},cursor:o.get}}},Cu=function(n){wu(n);var e=t(d.none());return{combine:function(t){return e.get().isNone()&&e.set(d.some(t)),function(){var e=n.cell({element:r(t),colspan:r(1),rowspan:r(1)});return yn(e,"width"),yn(t,"width"),e}},cursor:e.get}},Ru=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Tu=Se(),Ou=function(n){return t=n,e=Tu.property().name(t),R(Ru,e);var t,e},Du=function(n){return t=n,e=Tu.property().name(t),R(["ol","ul"],e);var t,e},Au=function(n){return t=n,R(["br","img","hr","input"],Tu.property().name(t));var t},Eu=function(n){var t,e=function(n){return"br"===U(n)},r=function(n){return Qt(n).bind(function(t){var r=Qn(t).map(function(n){return!!Ou(n)||!!Au(n)&&"img"!==U(n)}).getOr(!1);return Gn(t).map(function(o){return!0===r||("li"===U(u=o)||yt(u,Du).isSome())||e(t)||Ou(o)&&!Un(n,o)?[]:[sn.fromTag("br")];var u})}).getOr([])},o=0===(t=P(n,function(n){var t=Zn(n);return function(n){return M(n,function(n){return e(n)||G(n)&&0===Vt(n).trim().length})}(t)?[]:t.concat(r(n))})).length?[sn.fromTag("br")]:t;at(n[0]),ct(n[0],o)},ku=function(n){0===Mt(n).length&&lt(n)},Bu=function(n,t){return{grid:r(n),cursor:r(t)}},Nu=function(n,t,e){return Iu(n,t,e).orThunk(function(){return Iu(n,0,0)})},Iu=function(n,t,e){return d.from(n[t]).bind(function(n){return d.from(n.cells()[e]).bind(function(n){return d.from(n.element())})})},Pu=function(n,t,e){return Bu(n,Iu(n,t,e))},Mu=function(n){return k(n,function(n,t){return T(n,function(n){return n.row()===t.row()})?n:n.concat([t])},[]).sort(function(n,t){return n.row()-t.row()})},_u=function(n){return k(n,function(n,t){return T(n,function(n){return n.column()===t.column()})?n:n.concat([t])},[]).sort(function(n,t){return n.column()-t.column()})},Wu=function(n,t,e){var r=function(n,t){return O(n,function(n){var e=O(Mt(n),function(n){var t=Tt(n,"rowspan",1),e=Tt(n,"colspan",1);return st(n,t,e)});return dt(n,e,t.section())})}(n,e),o=Ft.generate(r);return To(o,t,!0)},ju=function(n,t,e){var r=su(n),o=du(t),u=r.getWidths(o,e,r),i=cu(o,u);D(i,function(n){r.setElementWidth(n.element,n.width)}),i.length>0&&r.setTableWidth(n,u,r.getCellDelta(0))},zu=Eo(function(n,t,e,r){var o=t[0].row(),u=t[0].row(),i=Mu(t),c=k(i,function(n,t){return Ko(n,u,o,e,r.getOrInit)},n);return Pu(c,u,t[0].column())},No,e,e,Su),Lu=Eo(function(n,t,e,r){var o=Mu(t),u=o[o.length-1].row(),i=o[o.length-1].row()+o[o.length-1].rowspan(),c=k(o,function(n,t){return Ko(n,i,u,e,r.getOrInit)},n);return Pu(c,i,t[0].column())},No,e,e,Su),Fu=Eo(function(n,t,e,r){var o=_u(t),u=o[0].column(),i=o[0].column(),c=k(o,function(n,t){return Xo(n,i,u,e,r.getOrInit)},n);return Pu(c,t[0].row(),i)},No,ju,e,Su),Hu=Eo(function(n,t,e,r){var o=t[t.length-1].column(),u=t[t.length-1].column()+t[t.length-1].colspan(),i=_u(t),c=k(i,function(n,t){return Xo(n,u,o,e,r.getOrInit)},n);return Pu(c,t[0].row(),u)},No,ju,e,Su),qu=Eo(function(n,t,e,r){var o=_u(t),u=function(n,t,e){var r=O(n,function(n){var r=n.cells().slice(0,t).concat(n.cells().slice(e+1));return gt(r,n.section())});return A(r,function(n){return n.cells().length>0})}(n,o[0].column(),o[o.length-1].column()),i=Nu(u,t[0].row(),t[0].column());return Bu(u,i)},No,ju,ku,Su),Uu=Eo(function(n,t,e,r){var o=Mu(t),u=function(n,t,e){return n.slice(0,t).concat(n.slice(e+1))}(n,o[0].row(),o[o.length-1].row()),i=Nu(u,t[0].row(),t[0].column());return Bu(u,i)},No,e,ku,Su),Vu=(Eo(function(n,t,e,r){var o=Jo(n,t.column(),e,r.replaceOrInit);return Pu(o,t.row(),t.column())},ko,e,e,xu("row","th")),Eo(function(n,t,e,r){var o=Jo(n,t.column(),e,r.replaceOrInit);return Pu(o,t.row(),t.column())},ko,e,e,xu(null,"td")),Eo(function(n,t,e,r){var o=Qo(n,t.row(),e,r.replaceOrInit);return Pu(o,t.row(),t.column())},ko,e,e,xu("col","th")),Eo(function(n,t,e,r){var o=Qo(n,t.row(),e,r.replaceOrInit);return Pu(o,t.row(),t.column())},ko,e,e,xu(null,"td")),Eo(function(n,t,e,o){var u=t.cells();Eu(u);var i=function(n,t,e,r){if(0===n.length)return n;for(var o=t.startRow();o<=t.finishRow();o++)for(var u=t.startCol();u<=t.finishCol();u++)ho(n[o],u,mt(r(),!1));return n}(n,t.bounds(),0,r(u[0]));return Bu(i,d.from(u[0]))},function(n,t){return t.mergable()},e,e,Cu)),Ku=Eo(function(n,t,e,r){var o=E(t,function(n,t){return Fo(n,t,e,r.combine(t))},n);return Bu(o,d.from(t[0]))},function(n,t){return t.unmergable()},ju,e,Cu),Xu=Eo(function(n,t,e,o){var u,i,c,a,l,f,s=(u=t.clipboard(),i=t.generators(),c=jt(u),a=Ft.generate(c),To(a,i,!0)),m=(l=t.row(),f=t.column(),{row:r(l),column:r(f)});return Uo(m,n,s,t.generators(),e).fold(function(){return Bu(n,d.some(t.element()))},function(n){var e=Nu(n,t.row(),t.column());return Bu(n,e)})},function(n,t){return Pt(t.element()).bind(function(e){return Ao(n,e).map(function(n){return Sn(Sn({},n),{generators:t.generators,clipboard:t.clipboard})})})},ju,e,Su),$u=Eo(function(n,t,e,r){var o=n[t.cells[0].row()],u=t.cells[0].row(),i=Wu(t.clipboard(),t.generators(),o),c=Vo(u,n,i,t.generators(),e),a=Nu(c,t.cells[0].row(),t.cells[0].column());return Bu(c,a)},Bo,e,e,Su),Gu=Eo(function(n,t,e,r){var o=n[t.cells[0].row()],u=t.cells[t.cells.length-1].row()+t.cells[t.cells.length-1].rowspan(),i=Wu(t.clipboard(),t.generators(),o),c=Vo(u,n,i,t.generators(),e),a=Nu(c,t.cells[0].row(),t.cells[0].column());return Bu(c,a)},Bo,e,e,Su),Yu=function(n){return sn.fromDom(n.getBody())},Ju=function(n){return n.getBoundingClientRect().width},Qu=function(n){return n.getBoundingClientRect().height},Zu=function(n){return function(t){return Un(t,Yu(n))}},ni=function(n){return/^[0-9]+$/.test(n)&&(n+="px"),n},ti=function(n){var t=bt(n,"td[data-mce-style],th[data-mce-style]");en(n,"data-mce-style"),D(t,function(n){en(n,"data-mce-style")})},ei={isRtl:r(!1)},ri={isRtl:r(!0)},oi=function(n){return"rtl"===function(n){return"rtl"===vn(n,"direction")?"rtl":"ltr"}(n)?ri:ei},ui={"border-collapse":"collapse",width:"100%"},ii={border:"1"},ci=function(n){return n.getParam("table_default_attributes",ii,"object")},ai=function(n){return n.getParam("table_default_styles",ui,"object")},li=function(n){return n.getParam("table_tab_navigation",!0,"boolean")},fi=function(n){return n.getParam("table_cell_advtab",!0,"boolean")},si=function(n){return n.getParam("table_row_advtab",!0,"boolean")},di=function(n){return n.getParam("table_advtab",!0,"boolean")},mi=function(n){return n.getParam("table_style_by_css",!1,"boolean")},gi=function(n){return n.getParam("table_class_list",[],"array")},pi=function(n){return!1===n.getParam("table_responsive_width")},hi=function(n){var t=n.getParam("table_clone_elements");return h(t)?d.some(t.split(/[ ,]/)):Array.isArray(t)?d.some(t):d.none()},vi=function(n,t){return n.fire("newrow",{node:t})},bi=function(n,t){return n.fire("newcell",{node:t})},wi=function(n,t,e,r,o){n.fire("TableSelectionChange",{cells:t,start:e,finish:r,otherCells:o})},yi=function(n){n.fire("TableSelectionClear")},Si=function(n,t){return{element:r(n),offset:r(t)}},xi=function(n,t,e){return n.property().isText(t)&&0===n.property().getText(t).trim().length||n.property().isComment(t)?e(t).bind(function(t){return xi(n,t,e).orThunk(function(){return d.some(t)})}):d.none()},Ci=function(n,t){return n.property().isText(t)?n.property().getText(t).length:n.property().children(t).length},Ri=function(n,t){var e=xi(n,t,n.query().prevSibling).getOr(t);if(n.property().isText(e))return Si(e,Ci(n,e));var r=n.property().children(e);return r.length>0?Ri(n,r[r.length-1]):Si(e,Ci(n,e))},Ti=Ri,Oi=Se(),Di=function(n,t){var r=function(n){return"table"===U(Yu(n))},o=hi(n),u=function(t,e,r,u){return function(i,c){ti(i);var a=u(),l=sn.fromDom(n.getDoc()),f=jr(oi),s=ae(r,l,o);return e(i)?t(a,i,c,s,f).bind(function(t){return D(t.newRows(),function(t){vi(n,t.dom())}),D(t.newCells(),function(t){bi(n,t.dom())}),t.cursor().map(function(t){var e=Ti(Oi,t),r=n.dom.createRng();return r.setStart(e.element().dom(),e.offset()),r.setEnd(e.element().dom(),e.offset()),r})}):d.none()}};return{deleteRow:u(Uu,function(t){var e=zr(t);return!1===r(n)||e.rows()>1},e,t),deleteColumn:u(qu,function(t){var e=zr(t);return!1===r(n)||e.columns()>1},e,t),insertRowsBefore:u(zu,a,e,t),insertRowsAfter:u(Lu,a,e,t),insertColumnsBefore:u(Fu,a,yr,t),insertColumnsAfter:u(Hu,a,yr,t),mergeCells:u(Vu,a,e,t),unmergeCells:u(Ku,a,e,t),pasteRowsBefore:u($u,a,e,t),pasteRowsAfter:u(Gu,a,e,t),pasteCells:u(Xu,a,e,t)}},Ai=function(n,t,e){var r=jt(n),o=Ft.generate(r);return No(o,t).map(function(n){var t=To(o,e,!1).slice(n[0].row(),n[n.length-1].row()+n[n.length-1].rowspan());return function(n){return O(n,function(n){var t=te(n.element());return D(n.cells(),function(n){var e=ee(n.element());Fr(e,"colspan",n.colspan(),1),Fr(e,"rowspan",n.rowspan(),1),ot(t,e)}),t})}(Do(t,e))})},Ei=tinymce.util.Tools.resolve("tinymce.util.Tools"),ki=function(n){return function(t){return d.from(t.dom.getParent(t.selection.getStart(),n)).map(sn.fromDom)}},Bi=ki("th,td"),Ni=ki("th,td,caption"),Ii=function(n,t,e){var r;return r=function(t,r){for(var o=0;o<r.length;o++){var u=n.getStyle(r[o],e);if(void 0===t&&(t=u),t!==u)return""}return t}(r,n.select("td,th",t))},Pi=function(n,t,e){e&&n.formatter.apply("align"+e,{},t)},Mi=function(n,t,e){e&&n.formatter.apply("valign"+e,{},t)},_i=function(n,t){Ei.each("left center right".split(" "),function(e){n.formatter.remove("align"+e,{},t)})},Wi=function(n,t,e){var r=function(n,e){return e=e||[],Ei.each(n,function(n){var o={text:n.text||n.title};n.menu?o.menu=r(n.menu):(o.value=n.value,t&&t(o)),e.push(o)}),e};return r(n,e||[])},ji=function(n,t){var e=function(t){return cn(t,"rgb")?n.toHex(t):t};return{borderwidth:wn(sn.fromDom(t),"border-width").getOr(""),borderstyle:wn(sn.fromDom(t),"border-style").getOr(""),bordercolor:wn(sn.fromDom(t),"border-color").map(e).getOr(""),backgroundcolor:wn(sn.fromDom(t),"background-color").map(e).getOr("")}},zi=function(n){var t=n[0],e=n.slice(1),r=W(t);return D(e,function(n){D(r,function(e){z(n,function(n,r){var o=t[e];""!==o&&e===r&&o!==n&&(t[e]="")})})}),t},Li=function(n){var t=[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===n?[{name:"borderwidth",type:"input",label:"Border width"}].concat(t):t}},Fi=function(n,t,e,r,o){var u={};return Ei.each(n.split(" "),function(n){r.formatter.matchNode(o,t+n)&&(u[e]=n)}),u[e]||(u[e]=""),u},Hi=u(Fi,"left center right"),qi=u(Fi,"top middle bottom"),Ui=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"selectbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"selectbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"selectbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"selectbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],Vi=function(n){return function(n){var t=function(n){return n.getParam("table_cell_class_list",[],"array")}(n),e=Wi(t,function(t){t.value&&(t.textStyle=function(){return n.formatter.getCssText({block:"tr",classes:[t.value]})})});return t.length>0?d.some({name:"class",type:"selectbox",label:"Class",items:e}):d.none()}(n).fold(function(){return Ui},function(n){return Ui.concat(n)})},Ki={normal:function(n,t){return{setAttrib:function(e,r){n.setAttrib(t,e,r)},setStyle:function(e,r){n.setStyle(t,e,r)}}},ifTruthy:function(n,t){return{setAttrib:function(e,r){r&&n.setAttrib(t,e,r)},setStyle:function(e,r){r&&n.setStyle(t,e,r)}}}},Xi=function(n,t){n.setAttrib("scope",t.scope),n.setAttrib("class",t.class),n.setStyle("width",ni(t.width)),n.setStyle("height",ni(t.height))},$i=function(n,t){n.setStyle("background-color",t.backgroundcolor),n.setStyle("border-color",t.bordercolor),n.setStyle("border-style",t.borderstyle),n.setStyle("border-width",ni(t.borderwidth))},Gi=function(n,t,e){var r=n.dom,o=e.celltype&&t[0].nodeName.toLowerCase()!==e.celltype?r.rename(t[0],e.celltype):t[0],u=Ki.normal(r,o);Xi(u,e),fi(n)&&$i(u,e),_i(n,o),function(n,t){Ei.each("top middle bottom".split(" "),function(e){n.formatter.remove("valign"+e,{},t)})}(n,o),e.halign&&Pi(n,o,e.halign),e.valign&&Mi(n,o,e.valign)},Yi=function(n,t,e){var r=n.dom;Ei.each(t,function(t){e.celltype&&t.nodeName.toLowerCase()!==e.celltype&&(t=r.rename(t,e.celltype));var o=Ki.ifTruthy(r,t);Xi(o,e),fi(n)&&$i(o,e),e.halign&&Pi(n,t,e.halign),e.valign&&Mi(n,t,e.valign)})},Ji=function(n,t,e){var r=e.getData();e.close(),n.undoManager.transact(function(){(1===t.length?Gi:Yi)(n,t,r),n.focus()})},Qi=function(n){var t,e=[];if(e=n.dom.select("td[data-mce-selected],th[data-mce-selected]"),t=n.dom.getParent(n.selection.getStart(),"td,th"),!e.length&&t&&e.push(t),t=t||e[0]){var r=Ei.map(e,function(t){return function(n,t,e){var r=n.dom;return Sn(Sn(Sn({width:r.getStyle(t,"width")||r.getAttrib(t,"width"),height:r.getStyle(t,"height")||r.getAttrib(t,"height"),scope:r.getAttrib(t,"scope"),celltype:t.nodeName.toLowerCase(),class:r.getAttrib(t,"class","")},Hi("align","halign",n,t)),qi("valign","valign",n,t)),e?ji(r,t):{})}(n,t,fi(n))}),o=zi(r),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:Vi(n)},Li("cell")]},c={type:"panel",items:[{type:"grid",columns:2,items:Vi(n)}]};n.windowManager.open({title:"Cell Properties",size:"normal",body:fi(n)?i:c,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:u(Ji,n,e)})}},Zi=[{type:"selectbox",name:"type",label:"Row type",items:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],nc=function(n){return function(n){var t=function(n){return n.getParam("table_row_class_list",[],"array")}(n),e=Wi(t,function(t){t.value&&(t.textStyle=function(){return n.formatter.getCssText({block:"tr",classes:[t.value]})})});return t.length>0?d.some({name:"class",type:"selectbox",label:"Class",items:e}):d.none()}(n).fold(function(){return Zi},function(n){return Zi.concat(n)})},tc=function(n,t,e,r){var o=n.dom,u=r.getData();r.close();var i=1===t.length?Ki.normal:Ki.ifTruthy;n.undoManager.transact(function(){Ei.each(t,function(t){u.type!==t.parentNode.nodeName.toLowerCase()&&function(n,t,e){var r=n.getParent(t,"table"),o=t.parentNode,u=n.select(e,r)[0];u||(u=n.create(e),r.firstChild?"CAPTION"===r.firstChild.nodeName?n.insertAfter(u,r.firstChild):r.insertBefore(u,r.firstChild):r.appendChild(u)),"tbody"===e&&"THEAD"===o.nodeName&&u.firstChild?u.insertBefore(t,u.firstChild):u.appendChild(t),o.hasChildNodes()||n.remove(o)}(n.dom,t,u.type);var r=i(o,t);r.setAttrib("scope",u.scope),r.setAttrib("class",u.class),r.setStyle("height",ni(u.height)),si(n)&&function(n,t){n.setStyle("background-color",t.backgroundcolor),n.setStyle("border-color",t.bordercolor),n.setStyle("border-style",t.borderstyle)}(r,u),u.align!==e.align&&(_i(n,t),Pi(n,t,u.align))}),n.focus()})},ec=function(n){var t,e,r=n.dom,o=[];if((t=r.getParent(n.selection.getStart(),"table"))&&(e=r.getParent(n.selection.getStart(),"td,th"),Ei.each(t.rows,function(n){Ei.each(n.cells,function(t){if((r.getAttrib(t,"data-mce-selected")||t===e)&&o.indexOf(n)<0)return o.push(n),!1})}),o[0])){var i=Ei.map(o,function(t){return function(n,t,e){var r=n.dom;return Sn(Sn({height:r.getStyle(t,"height")||r.getAttrib(t,"height"),scope:r.getAttrib(t,"scope"),class:r.getAttrib(t,"class",""),align:"",type:t.parentNode.nodeName.toLowerCase()},Hi("align","align",n,t)),e?ji(r,t):{})}(n,t,si(n))}),c=zi(i),a={type:"tabpanel",tabs:[{title:"General",name:"general",items:nc(n)},Li("row")]},l={type:"panel",items:[{type:"grid",columns:2,items:nc(n)}]};n.windowManager.open({title:"Row Properties",size:"normal",body:si(n)?a:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:c,onSubmit:u(tc,n,o,c)})}},rc=tinymce.util.Tools.resolve("tinymce.Env"),oc={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},uc=function(n,t,e,r,o){void 0===o&&(o=oc);var u=sn.fromTag("table");hn(u,o.styles),Q(u,o.attributes);var i=sn.fromTag("tbody");ot(u,i);for(var c=[],a=0;a<n;a++){for(var l=sn.fromTag("tr"),f=0;f<t;f++){var s=a<e||f<r?sn.fromTag("th"):sn.fromTag("td");f<r&&J(s,"scope","row"),a<e&&J(s,"scope","col"),ot(s,sn.fromTag("br")),o.percentages&&pn(s,"width",100/t+"%"),ot(l,s)}c.push(l)}return ct(i,c),u},ic=function(n,t){n.selection.select(t.dom(),!0),n.selection.collapse(!0)},cc=function(n,t,e){var r,o=ai(n),i={styles:o,attributes:ci(n),percentages:(r=o.width,h(r)&&-1!==r.indexOf("%")&&!pi(n))},c=uc(e,t,0,0,i);J(c,"data-mce-id","__mce");var a,l,f,s=(a=c,l=sn.fromTag("div"),f=sn.fromDom(a.dom().cloneNode(!0)),ot(l,f),function(n){return n.dom().innerHTML}(l));return n.insertContent(s),Ct(Yu(n),'table[data-mce-id="__mce"]').map(function(t){return pi(n)&&pn(t,"width",vn(t,"width")),en(t,"data-mce-id"),function(n,t){D(bt(t,"tr"),function(t){vi(n,t.dom()),D(bt(t,"th,td"),function(t){bi(n,t.dom())})})}(n,t),function(n,t){Ct(t,"td,th").each(u(ic,n))}(n,t),t.dom()}).getOr(null)},ac=function(n,t,e){var r=e?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=function(n){return n.getParam("table_appearance_options",!0,"boolean")}(n)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],u=t?[{type:"selectbox",name:"class",label:"Class",items:Wi(gi(n),function(t){t.value&&(t.textStyle=function(){return n.formatter.getCssText({block:"table",classes:[t.value]})})})}]:[];return r.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(o).concat([{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(u)},lc=function(n,t,e,r){if("TD"===t.tagName||"TH"===t.tagName)h(e)?n.setStyle(t,e,r):n.setStyle(t,e);else if(t.children)for(var o=0;o<t.children.length;o++)lc(n,t.children[o],e,r)},fc=function(n,t,e){var r,o=n.dom,u=e.getData();e.close(),""===u.class&&delete u.class,n.undoManager.transact(function(){if(!t){var e=parseInt(u.cols,10)||1,i=parseInt(u.rows,10)||1;t=cc(n,e,i)}!function(n,t,e){var r,o=n.dom,u={},i={};if(u.class=e.class,i.height=ni(e.height),o.getAttrib(t,"width")&&!mi(n)?u.width=(r=e.width)?r.replace(/px$/,""):"":i.width=ni(e.width),mi(n)?(i["border-width"]=ni(e.border),i["border-spacing"]=ni(e.cellspacing)):(u.border=e.border,u.cellpadding=e.cellpadding,u.cellspacing=e.cellspacing),mi(n)&&t.children)for(var c=0;c<t.children.length;c++)lc(o,t.children[c],{"border-width":ni(e.border),padding:ni(e.cellpadding)}),di(n)&&lc(o,t.children[c],{"border-color":e.bordercolor});di(n)&&(i["background-color"]=e.backgroundcolor,i["border-color"]=e.bordercolor,i["border-style"]=e.borderstyle),u.style=o.serializeStyle(Sn(Sn({},ai(n)),i)),o.setAttribs(t,Sn(Sn({},ci(n)),u))}(n,t,u),(r=o.select("caption",t)[0])&&!u.caption&&o.remove(r),!r&&u.caption&&((r=o.create("caption")).innerHTML=rc.ie?"Â ":'<br data-mce-bogus="1"/>',t.insertBefore(r,t.firstChild)),""===u.align?_i(n,t):Pi(n,t,u.align),n.focus(),n.addVisual()})},sc=function(n,t){var e,r=n.dom,o=function(n,t){var e,r,o,u=ai(n),i=ci(n),c=n.dom,a=t?function(n){var t=function(t){return cn(t,"rgb")?n.toHex(t):t},e=H(u,"border-style").getOr(""),r=H(u,"border-color").getOr(""),o=H(u,"background-color").getOr("");return{borderstyle:e,bordercolor:t(r),backgroundcolor:t(o)}}(c):{};return Sn(Sn(Sn(Sn(Sn(Sn({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),u),i),a),(o=u["border-width"],mi(n)&&o?{border:o}:H(i,"border").fold(function(){return{}},function(n){return{border:n}}))),(e=H(u,"border-spacing").or(H(i,"cellspacing")).fold(function(){return{}},function(n){return{cellspacing:n}}),r=H(u,"border-padding").or(H(i,"cellpadding")).fold(function(){return{}},function(n){return{cellpadding:n}}),Sn(Sn({},e),r)))}(n,di(n));!1===t?(e=r.getParent(n.selection.getStart(),"table"))?o=function(n,t,e){var r=n.dom;return Sn(Sn({width:r.getStyle(t,"width")||r.getAttrib(t,"width"),height:r.getStyle(t,"height")||r.getAttrib(t,"height"),cellspacing:r.getStyle(t,"border-spacing")||r.getAttrib(t,"cellspacing"),cellpadding:r.getAttrib(t,"cellpadding")||Ii(n.dom,t,"padding"),border:function(t,e){var r=wn(sn.fromDom(e),"border-width");return mi(n)&&r.isSome()?r.getOr(""):t.getAttrib(e,"border")||Ii(n.dom,e,"border-width")||Ii(n.dom,e,"border")}(r,t),caption:!!r.select("caption",t)[0],class:r.getAttrib(t,"class","")},Hi("align","align",n,t)),e?ji(r,t):{})}(n,e,di(n)):di(n)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""):(o.cols="1",o.rows="1",di(n)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""));var i=gi(n).length>0;i&&o.class&&(o.class=o.class.replace(/\s*mce\-item\-table\s*/g,""));var c={type:"grid",columns:2,items:ac(n,i,t)},a=di(n)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[c]},Li("table")]}:{type:"panel",items:[c]};n.windowManager.open({title:"Table Properties",size:"normal",body:a,onSubmit:u(fc,n,e),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})},dc=Ei.each,mc=function(n,t,o,c,a){var l=Zu(n),f=function(n){return Wt(n,l)},s=function(t){Bi(n).each(function(e){f(e).each(function(r){var u=Xe(c,r,e);t(r,u).each(function(t){n.selection.setRng(t),n.focus(),o.clear(r),ti(r)})})})},m=function(t){return Bi(n).map(function(t){return f(t).bind(function(r){var o=sn.fromDom(n.getDoc()),u=Xe(c,r,t),i=ae(e,o,d.none());return Ai(r,u,i)})})},g=function(t){a.get().each(function(e){var u=O(e,function(n){return ee(n)});Bi(n).each(function(e){f(e).each(function(i){var a=sn.fromDom(n.getDoc()),l=le(a),f=function(n,t,e,o,u){return{element:r(e),mergable:d.none,unmergable:d.none,selection:r(qe(e,n)),clipboard:r(o),generators:r(u)}}(c,0,e,u,l);t(i,f).each(function(t){n.selection.setRng(t),n.focus(),o.clear(i)})})})})};dc({mceTableSplitCells:function(){s(t.unmergeCells)},mceTableMergeCells:function(){s(t.mergeCells)},mceTableInsertRowBefore:function(){s(t.insertRowsBefore)},mceTableInsertRowAfter:function(){s(t.insertRowsAfter)},mceTableInsertColBefore:function(){s(t.insertColumnsBefore)},mceTableInsertColAfter:function(){s(t.insertColumnsAfter)},mceTableDeleteCol:function(){s(t.deleteColumn)},mceTableDeleteRow:function(){s(t.deleteRow)},mceTableCutRow:function(n){m().each(function(n){a.set(n),s(t.deleteRow)})},mceTableCopyRow:function(n){m().each(function(n){a.set(n)})},mceTablePasteRowBefore:function(n){g(t.pasteRowsBefore)},mceTablePasteRowAfter:function(n){g(t.pasteRowsAfter)},mceTableDelete:function(){Ni(n).each(function(t){Wt(t,l).filter(i(l)).each(function(t){var e=sn.fromText("");if(et(t,e),lt(t),n.dom.isEmpty(n.getBody()))n.setContent(""),n.selection.setCursorLocation();else{var r=n.dom.createRng();r.setStart(e.dom(),0),r.setEnd(e.dom(),0),n.selection.setRng(r),n.nodeChanged()}})})}},function(t,e){n.addCommand(e,t)}),dc({mceInsertTable:u(sc,n,!0),mceTableProps:u(sc,n,!1),mceTableRowProps:u(ec,n),mceTableCellProps:u(Qi,n)},function(t,e){n.addCommand(e,function(){t()})})},gc=function(n){var t=d.from(n.dom().documentElement).map(sn.fromDom).getOr(n);return{parent:r(t),view:r(n),origin:r(xr(0,0))}},pc=function(n,t){return{parent:r(t),view:r(n),origin:r(xr(0,0))}},hc=function(n){var t=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(n.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+n.length+']", got '+t.length+" arguments");var o={};return D(n,function(n,e){o[n]=r(t[e])}),o}}.apply(null,n),e=[];return{bind:function(n){if(void 0===n)throw new Error("Event bind error: undefined handler");e.push(n)},unbind:function(n){e=A(e,function(t){return t!==n})},trigger:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.apply(null,n);D(e,function(n){n(o)})}}},vc=function(n){return{registry:L(n,function(n){return{bind:n.bind,unbind:n.unbind}}),trigger:L(n,function(n){return n.trigger})}},bc=function(n){var t,e,o=sn.fromDom(n.target),u=function(){return n.stopPropagation()},i=function(){return n.preventDefault()},c=(t=i,e=u,function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))});return function(n,t,e,o,u,i,c){return{target:r(n),x:r(t),y:r(e),stop:o,prevent:u,kill:i,raw:r(c)}}(o,n.clientX,n.clientY,u,i,c,n)},wc=function(n,t,e,r,o){var i=function(n,t){return function(e){n(e)&&t(bc(e))}}(e,r);return n.dom().addEventListener(t,i,o),{unbind:u(yc,n,t,i,o)}},yc=function(n,t,e,r){n.dom().removeEventListener(t,e,r)},Sc=r(!0),xc=function(n,t,e){return function(n,t,e,r){return wc(n,t,e,r,!1)}(n,t,Sc,e)},Cc=bc,Rc=to("ephox-dragster").resolve,Tc=bu(["compare","extract","mutate","sink"]),Oc=bu(["element","start","stop","destroy"]),Dc=bu(["forceDrop","drop","move","delayDrop"]),Ac=Tc({compare:function(n,t){return xr(t.left()-n.left(),t.top()-n.top())},extract:function(n){return d.some(xr(n.x(),n.y()))},sink:function(n,t){var e=function(n){var t=Sn({layerClass:Rc("blocker")},n),e=sn.fromTag("div");return J(e,"role","presentation"),hn(e,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Xr(e,Rc("blocker")),Xr(e,t.layerClass),{element:function(){return e},destroy:function(){lt(e)}}}(t),r=xc(e.element(),"mousedown",n.forceDrop),o=xc(e.element(),"mouseup",n.drop),u=xc(e.element(),"mousemove",n.move),i=xc(e.element(),"mouseout",n.delayDrop);return Oc({element:e.element,start:function(n){ot(n,e.element())},stop:function(){lt(e.element())},destroy:function(){e.destroy(),o.unbind(),u.unbind(),i.unbind(),r.unbind()}})},mutate:function(n,t){n.mutate(t.left(),t.top())}});function Ec(){var n=d.none(),t=vc({move:hc(["info"])});return{onEvent:function(e,r){r.extract(e).each(function(e){(function(t,e){var r=n.map(function(n){return t.compare(n,e)});return n=d.some(e),r})(r,e).each(function(n){t.trigger.move(n)})})},reset:function(){n=d.none()},events:t.registry}}function kc(){var n={onEvent:e,reset:e},t=Ec(),r=n;return{on:function(){r.reset(),r=t},off:function(){r.reset(),r=n},isOn:function(){return r===t},onEvent:function(n,t){r.onEvent(n,t)},events:t.events}}var Bc=function(t,e,r){var o,u,i,c=!1,a=vc({start:hc([]),stop:hc([])}),l=kc(),f=function(){m.stop(),l.isOn()&&(l.off(),a.trigger.stop())},s=(o=f,u=200,i=null,{cancel:function(){null!==i&&(n.clearTimeout(i),i=null)},throttle:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];null!==i&&n.clearTimeout(i),i=n.setTimeout(function(){o.apply(null,t),i=null},u)}});l.events.move.bind(function(n){e.mutate(t,n.info())});var d=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];c&&n.apply(null,t)}},m=e.sink(Dc({forceDrop:f,drop:d(f),move:d(function(n){s.cancel(),l.onEvent(n,e)}),delayDrop:d(s.throttle)}),r);return{element:m.element,go:function(n){m.start(n),l.on(),a.trigger.start()},on:function(){c=!0},off:function(){c=!1},destroy:function(){m.destroy()},events:a.registry}},Nc=function(n){return"true"===Z(n,"contenteditable")},Ic=function(){var n=vc({drag:hc(["xDelta","yDelta","target"])}),t=d.none(),e=function(){var n=vc({drag:hc(["xDelta","yDelta"])});return{mutate:function(t,e){n.trigger.drag(t,e)},events:n.registry}}();e.events.drag.bind(function(e){t.each(function(t){n.trigger.drag(e.xDelta(),e.yDelta(),t)})});return{assign:function(n){t=d.some(n)},get:function(){return t},mutate:e.mutate,events:n.registry}},Pc=ro("resizer-bar-dragging"),Mc=function(n,t,e){var r=Ic(),o=function(n,t){void 0===t&&(t={});var e=void 0!==t.mode?t.mode:Ac;return Bc(n,e,t)}(r,{}),i=d.none(),c=function(n,t){return d.from(Z(n,t))};r.events.drag.bind(function(n){c(n.target(),"data-row").each(function(t){var e=Et(n.target(),"top");pn(n.target(),"top",e+n.yDelta()+"px")}),c(n.target(),"data-column").each(function(t){var e=Et(n.target(),"left");pn(n.target(),"left",e+n.xDelta()+"px")})});var a=function(n,t){return Et(n,t)-Tt(n,"data-initial-"+t,0)};o.events.stop.bind(function(){r.get().each(function(r){i.each(function(o){c(r,"data-row").each(function(n){var t=a(r,"top");en(r,"data-initial-top"),p.trigger.adjustHeight(o,t,parseInt(n,10))}),c(r,"data-column").each(function(n){var t=a(r,"left");en(r,"data-initial-left"),p.trigger.adjustWidth(o,t,parseInt(n,10))}),so(n,o,e,t)})})});var l=function(t,e){p.trigger.startAdjust(),r.assign(t),J(t,"data-initial-"+e,Et(t,e)),Xr(t,Pc),pn(t,"opacity","0.2"),o.go(n.parent())},f=xc(n.parent(),"mousedown",function(n){var t;t=n.target(),Gr(t,uo)&&l(n.target(),"top"),function(n){return Gr(n,io)}(n.target())&&l(n.target(),"left")}),s=function(t){return Un(t,n.view())},m=function(n){return Rt(n,"table",s).filter(function(n){return function(n,t){return Rt(n,"[contenteditable]",t)}(n,s).exists(Nc)})},g=xc(n.view(),"mouseover",function(r){m(r.target()).fold(function(){dn(r.target())&&co(n)},function(r){i=d.some(r),so(n,r,e,t)})}),p=vc({adjustHeight:hc(["table","delta","row"]),adjustWidth:hc(["table","delta","column"]),startAdjust:hc([])});return{destroy:function(){f.unbind(),g.unbind(),o.destroy(),co(n)},refresh:function(r){so(n,r,e,t)},on:o.on,off:o.off,hideBars:u(go,n),showBars:u(po,n),events:p.registry}},_c=function(n,t){var e=_r,r=Mc(n,t,e),o=vc({beforeResize:hc(["table"]),afterResize:hc(["table"]),startDrag:hc([])});return r.events.adjustHeight.bind(function(n){o.trigger.beforeResize(n.table());var t=e.delta(n.delta(),n.table());gu(n.table(),t,n.row(),e),o.trigger.afterResize(n.table())}),r.events.startAdjust.bind(function(n){o.trigger.startDrag()}),r.events.adjustWidth.bind(function(n){o.trigger.beforeResize(n.table());var e=t.delta(n.delta(),n.table());!function(n,t,e,r){var o=su(n),u=o.getCellDelta(t),i=mu(n),c=o.getWidths(i,r,o),a=tu(c,e,u,o),l=O(a,function(n,t){return n+c[t]}),f=cu(i,l);D(f,function(n){o.setElementWidth(n.element,n.width)}),e===i.grid.columns()-1&&o.setTableWidth(n,l,u)}(n.table(),e,n.column(),t),o.trigger.afterResize(n.table())}),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}},Wc=function(){var t=sn.fromTag("div");return hn(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),ot(mn(sn.fromDom(n.document)),t),t},jc=function(n,t){return Ju(n.dom())/Ju(t.dom())*100+"%"},zc=function(n){var t,e,r=d.none(),o=d.none(),u=d.none(),i=/(\d+(\.\d+)?)%/,c=function(n){return"TABLE"===n.nodeName},a=function(t){var e=n.dom.getStyle(t,"width")||n.dom.getAttrib(t,"width");return d.from(e).filter(function(n){return n.length>0})},l=function(){return o};return n.on("init",function(){var t=jr(oi),e=function(n,t){return n.inline?pc(Yu(n),Wc()):gc(sn.fromDom(n.getDoc()))}(n);if(u=d.some(e),function(n){var t=n.getParam("object_resizing",!0);return h(t)?"table"===t:t}(n)&&function(n){return n.getParam("table_resize_bars",!0,"boolean")}(n)){var i=_c(e,t);i.on(),i.events.startDrag.bind(function(t){r=d.some(n.selection.getRng())}),i.events.beforeResize.bind(function(t){var e=t.table().dom();!function(n,t,e,r){n.fire("ObjectResizeStart",{target:t,width:e,height:r})}(n,e,Ju(e),Qu(e))}),i.events.afterResize.bind(function(t){var e=t.table(),o=e.dom();ti(e),r.each(function(t){n.selection.setRng(t),n.focus()}),function(n,t,e,r){n.fire("ObjectResized",{target:t,width:e,height:r})}(n,o,Ju(o),Qu(o)),n.undoManager.add()}),o=d.some(i)}}),n.on("ObjectResizeStart",function(r){var o,u=r.target;if(c(u)){var l=a(u).map(function(n){return i.test(n)}).getOr(!1);l&&pi(n)?(o=u,pn(sn.fromDom(o),"width",Ju(o).toString()+"px")):!l&&function(n){return!0===n.getParam("table_responsive_width")}(n)&&function(n){var t=sn.fromDom(n);Gn(t).map(function(n){return jc(t,n)}).each(function(n){pn(t,"width",n),D(bt(t,"tr"),function(n){D(Zn(n),function(t){pn(t,"width",jc(t,n))})})})}(u),t=r.width,e=a(u).getOr("")}}),n.on("ObjectResized",function(r){var o=r.target;if(c(o)){var u=o;if(i.test(e)){var a=parseFloat(i.exec(e)[1]),l=r.width*a/t;n.dom.setStyle(u,"width",l+"%")}else{var f=[];Ei.each(u.rows,function(t){Ei.each(t.cells,function(t){var e=n.dom.getStyle(t,"width",!0);f.push({cell:t,width:e})})}),Ei.each(f,function(t){n.dom.setStyle(t.cell,"width",t.width),n.dom.setAttrib(t.cell,"width",null)})}}}),n.on("SwitchMode",function(){l().each(function(t){n.mode.isReadOnly()?t.hideBars():t.showBars()})}),{lazyResize:l,lazyWire:function(){return u.getOr(gc(sn.fromDom(n.getBody())))},destroy:function(){o.each(function(n){n.destroy()}),u.each(function(t){!function(n,t){n.inline&&lt(t.parent())}(n,t)})}}},Lc=We([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Fc=Sn(Sn({},Lc),{none:function(n){return void 0===n&&(n=void 0),Lc.none(n)}}),Hc=function(n,t){return Wt(n,t).bind(function(t){var e=Mt(t);return N(e,function(t){return Un(n,t)}).map(function(n){return{index:n,all:e}})})},qc=function(n,t,e,o){return{start:r(n),soffset:r(t),finish:r(e),foffset:r(o)}},Uc=We([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Vc={before:Uc.before,on:Uc.on,after:Uc.after,cata:function(n,t,e,r){return n.fold(t,e,r)},getStart:function(n){return n.fold(o,o,o)}},Kc=We([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Xc={domRange:Kc.domRange,relative:Kc.relative,exact:Kc.exact,exactFromRange:function(n){return Kc.exact(n.start(),n.soffset(),n.finish(),n.foffset())},getWin:function(n){var t,e=function(n){return n.match({domRange:function(n){return sn.fromDom(n.startContainer)},relative:function(n,t){return Vc.getStart(n)},exact:function(n,t,e,r){return n}})}(n);return t=e,sn.fromDom(t.dom().ownerDocument.defaultView)},range:qc},$c=function(n,t){return n.selectNodeContents(t.dom())},Gc=function(n,t,e){var r,o=n.document.createRange();return r=o,t.fold(function(n){r.setStartBefore(n.dom())},function(n,t){r.setStart(n.dom(),t)},function(n){r.setStartAfter(n.dom())}),function(n,t){t.fold(function(t){n.setEndBefore(t.dom())},function(t,e){n.setEnd(t.dom(),e)},function(t){n.setEndAfter(t.dom())})}(o,e),o},Yc=function(n,t,e,r,o){var u=n.document.createRange();return u.setStart(t.dom(),e),u.setEnd(r.dom(),o),u},Jc=function(n){return{left:r(n.left),top:r(n.top),right:r(n.right),bottom:r(n.bottom),width:r(n.width),height:r(n.height)}},Qc=We([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Zc=function(n,t,e){return t(sn.fromDom(e.startContainer),e.startOffset,sn.fromDom(e.endContainer),e.endOffset)},na=function(n,t){return function(n,t){var e=t.ltr();return e.collapsed?t.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return Qc.rtl(sn.fromDom(n.endContainer),n.endOffset,sn.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return Zc(0,Qc.ltr,e)}):Zc(0,Qc.ltr,e)}(0,function(n,t){return t.match({domRange:function(n){return{ltr:r(n),rtl:d.none}},relative:function(t,e){return{ltr:xn(function(){return Gc(n,t,e)}),rtl:xn(function(){return d.some(Gc(n,e,t))})}},exact:function(t,e,r,o){return{ltr:xn(function(){return Yc(n,t,e,r,o)}),rtl:xn(function(){return d.some(Yc(n,r,o,t,e))})}}})}(n,t))},ta=function(n,t){return na(n,t).match({ltr:function(t,e,r,o){var u=n.document.createRange();return u.setStart(t.dom(),e),u.setEnd(r.dom(),o),u},rtl:function(t,e,r,o){var u=n.document.createRange();return u.setStart(r.dom(),o),u.setEnd(t.dom(),e),u}})},ea=(Qc.ltr,Qc.rtl,function(n,t,e){return t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom}),ra=function(n,t,e,r,o){var u=function(e){var r=n.dom().createRange();return r.setStart(t.dom(),e),r.collapse(!0),r},i=Vt(t).length,c=function(n,t,e,r,o){if(0===o)return 0;if(t===r)return o-1;for(var u=r,i=1;i<o;i++){var c=n(i),a=Math.abs(t-c.left);if(e<=c.bottom){if(e<c.top||a>u)return i-1;u=a}}return 0}(function(n){return u(n).getBoundingClientRect()},e,r,o.right,i);return u(c)},oa=function(n,t,e,r){return G(t)?function(n,t,e,r){var o=n.dom().createRange();o.selectNode(t.dom());var u=o.getClientRects();return _(u,function(n){return ea(n,e,r)?d.some(n):d.none()}).map(function(o){return ra(n,t,e,r,o)})}(n,t,e,r):function(n,t,e,r){var o=n.dom().createRange(),u=Zn(t);return _(u,function(t){return o.selectNode(t.dom()),ea(o.getBoundingClientRect(),e,r)?oa(n,t,e,r):d.none()})}(n,t,e,r)},ua=function(n,t){return t-n.left<n.right-t},ia=function(n,t,e){var r=n.dom().createRange();return r.selectNode(t.dom()),r.collapse(e),r},ca=function(n,t,e){var r=n.dom().createRange();r.selectNode(t.dom());var o=r.getBoundingClientRect(),u=ua(o,e);return(!0===u?Jt:Qt)(t).map(function(t){return ia(n,t,u)})},aa=function(n,t,e){var r=t.dom().getBoundingClientRect(),o=ua(r,e);return d.some(ia(n,t,o))},la=function(n,t,e,r){var o=n.dom().createRange();o.selectNode(t.dom());var u=o.getBoundingClientRect();return function(n,t,e,r){var o=n.dom().createRange();o.selectNode(t.dom());var u=o.getBoundingClientRect(),i=Math.max(u.left,Math.min(u.right,e)),c=Math.max(u.top,Math.min(u.bottom,r));return oa(n,t,i,c)}(n,t,Math.max(u.left,Math.min(u.right,e)),Math.max(u.top,Math.min(u.bottom,r)))},fa=document.caretPositionFromPoint?function(n,t,e){return d.from(n.dom().caretPositionFromPoint(t,e)).bind(function(t){if(null===t.offsetNode)return d.none();var e=n.dom().createRange();return e.setStart(t.offsetNode,t.offset),e.collapse(),d.some(e)})}:document.caretRangeFromPoint?function(n,t,e){return d.from(n.dom().caretRangeFromPoint(t,e))}:function(n,t,e){return sn.fromPoint(n,t,e).bind(function(r){var o=function(){return function(n,t,e){return(0===Zn(t).length?aa:ca)(n,t,e)}(n,r,t)};return 0===Zn(r).length?o():la(n,r,t,e).orThunk(o)})},sa=function(n,t){var e=U(n);return"input"===e?Vc.after(n):R(["br","img"],e)?0===t?Vc.before(n):Vc.after(n):Vc.on(n,t)},da=function(n,t){var e=n.fold(Vc.before,sa,Vc.after),r=t.fold(Vc.before,sa,Vc.after);return Xc.relative(e,r)},ma=function(n,t,e,r){var o=sa(n,t),u=sa(e,r);return Xc.relative(o,u)},ga=function(n,t,e,r){var o=function(n,t,e,r){var o=$n(n).dom().createRange();return o.setStart(n.dom(),t),o.setEnd(e.dom(),r),o}(n,t,e,r),u=Un(n,e)&&t===r;return o.collapsed&&!u},pa=function(n,t){d.from(n.getSelection()).each(function(n){n.removeAllRanges(),n.addRange(t)})},ha=function(n,t,e,r,o){var u=Yc(n,t,e,r,o);pa(n,u)},va=function(n,t){return na(n,t).match({ltr:function(t,e,r,o){ha(n,t,e,r,o)},rtl:function(t,e,r,o){var u=n.getSelection();if(u.setBaseAndExtent)u.setBaseAndExtent(t.dom(),e,r.dom(),o);else if(u.extend)try{!function(n,t,e,r,o,u){t.collapse(e.dom(),r),t.extend(o.dom(),u)}(0,u,t,e,r,o)}catch(u){ha(n,r,o,t,e)}else ha(n,r,o,t,e)}})},ba=function(n,t,e,r,o){var u=ma(t,e,r,o);va(n,u)},wa=function(n,t,e){var r=da(t,e);va(n,r)},ya=function(n){var t=Xc.getWin(n).dom(),e=function(n,e,r,o){return Yc(t,n,e,r,o)},r=function(n){return n.match({domRange:function(n){var t=sn.fromDom(n.startContainer),e=sn.fromDom(n.endContainer);return ma(t,n.startOffset,e,n.endOffset)},relative:da,exact:ma})}(n);return na(t,r).match({ltr:e,rtl:e})},Sa=function(n){var t=sn.fromDom(n.anchorNode),e=sn.fromDom(n.focusNode);return ga(t,n.anchorOffset,e,n.focusOffset)?d.some(qc(t,n.anchorOffset,e,n.focusOffset)):function(n){if(n.rangeCount>0){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return d.some(qc(sn.fromDom(t.startContainer),t.startOffset,sn.fromDom(e.endContainer),e.endOffset))}return d.none()}(n)},xa=function(n,t){var e=function(n,t){var e=n.document.createRange();return $c(e,t),e}(n,t);pa(n,e)},Ca=function(n){return function(n){return d.from(n.getSelection()).filter(function(n){return n.rangeCount>0}).bind(Sa)}(n).map(function(n){return Xc.exact(n.start(),n.soffset(),n.finish(),n.foffset())})},Ra=function(n,t){return function(n){var t=n.getClientRects(),e=t.length>0?t[0]:n.getBoundingClientRect();return e.width>0||e.height>0?d.some(e).map(Jc):d.none()}(ta(n,t))},Ta=function(n,t,e){return function(n,t,e){var r=sn.fromDom(n.document);return fa(r,t,e).map(function(n){return qc(sn.fromDom(n.startContainer),n.startOffset,sn.fromDom(n.endContainer),n.endOffset)})}(n,t,e)},Oa=tinymce.util.Tools.resolve("tinymce.util.VK"),Da=function(n,t,e,r){return Ba(n,t,function(n,t){return Hc(n,t).fold(function(){return Fc.none(n)},function(t){return t.index+1<t.all.length?Fc.middle(n,t.all[t.index+1]):Fc.last(n)})}(e),r)},Aa=function(n,t,e,r){return Ba(n,t,function(n,t){return Hc(n,t).fold(function(){return Fc.none()},function(t){return t.index-1>=0?Fc.middle(n,t.all[t.index-1]):Fc.first(n)})}(e),r)},Ea=function(n,t){var e=Xc.exact(t,0,t,0);return ya(e)},ka=function(n,t){var e,r=bt(t,"tr");return(e=r,0===e.length?d.none():d.some(e[e.length-1])).bind(function(n){return Ct(n,"td,th").map(function(n){return Ea(0,n)})})},Ba=function(n,t,e,r,o){return e.fold(d.none,d.none,function(n,t){return Jt(t).map(function(n){return Ea(0,n)})},function(e){return Wt(e,t).bind(function(t){var o=Ke(e);return n.undoManager.transact(function(){r.insertRowsAfter(t,o)}),ka(0,t)})})},Na=["table","li","dl"],Ia=function(n,t,e,r){if(n.keyCode===Oa.TAB){var o=Yu(t),u=function(n){var t=U(n);return Un(n,o)||R(Na,t)},i=t.selection.getRng();if(i.collapsed){var c=sn.fromDom(i.startContainer);Pt(c,u).each(function(o){n.preventDefault(),(n.shiftKey?Aa:Da)(t,u,o,e,r).each(function(n){t.selection.setRng(n)})})}}},Pa=function(n,t){return{selection:r(n),kill:r(t)}},Ma=function(n,t,e,o){return{start:r(Vc.on(n,t)),finish:r(Vc.on(e,o))}},_a=function(n,t){var e=ta(n,t);return qc(sn.fromDom(e.startContainer),e.startOffset,sn.fromDom(e.endContainer),e.endOffset)},Wa=Ma,ja=function(n,t,e,r,o){return Un(e,r)?d.none():Ee(e,r,t).bind(function(t){var r=t.boxes.getOr([]);return r.length>0?(o(n,r,t.start,t.finish),d.some(Pa(d.some(Wa(e,0,e,$t(e))),!0))):d.none()})},za=function(n,t){return{item:r(n),mode:r(t)}},La=function(n,t,e,r){return void 0===r&&(r=Fa),n.property().parent(t).map(function(n){return za(n,r)})},Fa=function(n,t,e,r){return void 0===r&&(r=Ha),e.sibling(n,t).map(function(n){return za(n,r)})},Ha=function(n,t,e,r){void 0===r&&(r=Ha);var o=n.property().children(t);return e.first(o).map(function(n){return za(n,r)})},qa=[{current:La,next:Fa,fallback:d.none()},{current:Fa,next:Ha,fallback:d.some(La)},{current:Ha,next:Ha,fallback:d.some(Fa)}],Ua=function(n,t,e,r,o){return void 0===o&&(o=qa),B(o,function(n){return n.current===e}).bind(function(e){return e.current(n,t,r,e.next).orThunk(function(){return e.fallback.bind(function(e){return Ua(n,t,e,r)})})})},Va=function(){return{sibling:function(n,t){return n.query().prevSibling(t)},first:function(n){return n.length>0?d.some(n[n.length-1]):d.none()}}},Ka=function(){return{sibling:function(n,t){return n.query().nextSibling(t)},first:function(n){return n.length>0?d.some(n[0]):d.none()}}},Xa=function(n,t,e,r,o,u){return Ua(n,t,r,o).bind(function(t){return u(t.item())?d.none():e(t.item())?d.some(t.item()):Xa(n,t.item(),e,t.mode(),o,u)})},$a=function(n){return function(t){return 0===n.property().children(t).length}},Ga=function(n,t,e,r){return Xa(n,t,e,Fa,Va(),r)},Ya=function(n,t,e,r){return Xa(n,t,e,Fa,Ka(),r)},Ja=Se(),Qa=function(n,t){return function(n,t,e){return Ga(n,t,$a(n),e)}(Ja,n,t)},Za=function(n,t){return function(n,t,e){return Ya(n,t,$a(n),e)}(Ja,n,t)},nl=We([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),tl=function(n){return Rt(n,"tr")},el=Sn(Sn({},nl),{verify:function(n,t,e,r,o,u,i){return Rt(r,"td,th",i).bind(function(e){return Rt(t,"td,th",i).map(function(t){return Un(e,t)?Un(r,e)&&$t(e)===o?u(t):nl.none("in same cell"):De(tl,[e,t]).fold(function(){return function(n,t,e){var r=n.getRect(t),o=n.getRect(e);return o.right>r.left&&o.left<r.right}(n,t,e)?nl.success():u(t)},function(n){return u(t)})})}).getOr(nl.none("default"))},cata:function(n,t,e,r,o){return n.fold(t,e,r,o)}}),rl=function(n){return Gn(n).bind(function(t){var e=Zn(t);return ol(e,n).map(function(o){return function(n,t,e,o){return{parent:r(n),children:r(t),element:r(e),index:r(o)}}(t,e,n,o)})})},ol=function(n,t){return N(n,u(Un,t))},ul=function(n){return"br"===U(n)},il=function(n,t,e){return t(n,e).bind(function(n){return G(n)&&0===Vt(n).trim().length?il(n,t,e):d.some(n)})},cl=function(n,t,e,r){return function(n,t){return nt(n,t).filter(ul).orThunk(function(){return nt(n,t-1).filter(ul)})}(t,e).bind(function(t){return r.traverse(t).fold(function(){return il(t,r.gather,n).map(r.relative)},function(n){return rl(n).map(function(n){return Vc.on(n.parent(),n.index())})})})},al=function(n,t,e,o){return(ul(t)?function(n,t,e){return e.traverse(t).orThunk(function(){return il(t,e.gather,n)}).map(e.relative)}(n,t,o):cl(n,t,e,o)).map(function(n){return{start:r(n),finish:r(n)}})},ll=function(n,t){return{left:n.left,top:n.top+t,right:n.right,bottom:n.bottom+t}},fl=function(n,t){return{left:n.left,top:n.top-t,right:n.right,bottom:n.bottom-t}},sl=function(n,t,e){return{left:n.left+t,top:n.top+e,right:n.right+t,bottom:n.bottom+e}},dl=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom}},ml=function(n,t){return d.some(n.getRect(t))},gl=function(n,t,e){return $(t)?ml(n,t).map(dl):G(t)?function(n,t,e){return e>=0&&e<$t(t)?n.getRangedRect(t,e,t,e+1):e>0?n.getRangedRect(t,e-1,t,e):d.none()}(n,t,e).map(dl):d.none()},pl=function(n,t){return $(t)?ml(n,t).map(dl):G(t)?n.getRangedRect(t,0,t,$t(t)).map(dl):d.none()},hl=We([{none:[]},{retry:["caret"]}]),vl=function(n,t,e){return(o=t,u=Ou,wt(function(n,t){return t(n)},yt,o,u,i)).fold(r(!1),function(t){return pl(n,t).exists(function(n){return function(n,t){return n.left<t.left||Math.abs(t.right-n.left)<1||n.left>t.right}(e,n)})});var o,u,i},bl={point:function(n){return n.bottom},adjuster:function(n,t,e,r,o){var u=ll(o,5);return Math.abs(e.bottom-r.bottom)<1?hl.retry(u):e.top>o.bottom?hl.retry(u):e.top===o.bottom?hl.retry(ll(o,1)):vl(n,t,o)?hl.retry(sl(u,5,0)):hl.none()},move:ll,gather:Za},wl=function(n,t,e,r,o){return 0===o?d.some(r):function(n,t,e){return n.elementFromPoint(t,e).filter(function(n){return"table"===U(n)}).isSome()}(n,r.left,t.point(r))?function(n,t,e,r,o){return wl(n,t,e,t.move(r,5),o)}(n,t,e,r,o-1):n.situsFromPoint(r.left,t.point(r)).bind(function(u){return u.start().fold(d.none,function(u){return pl(n,u).bind(function(i){return t.adjuster(n,u,i,e,r).fold(d.none,function(r){return wl(n,t,e,r,o-1)})}).orThunk(function(){return d.some(r)})},d.none)})},yl=function(n,t,e){var r=n.move(e,5),o=wl(t,n,e,r,100).getOr(r);return function(n,t,e){return n.point(t)>e.getInnerHeight()?d.some(n.point(t)-e.getInnerHeight()):n.point(t)<0?d.some(-n.point(t)):d.none()}(n,o,t).fold(function(){return t.situsFromPoint(o.left,n.point(o))},function(e){return t.scrollBy(0,e),t.situsFromPoint(o.left,n.point(o)-e)})},Sl={tryUp:u(yl,{point:function(n){return n.top},adjuster:function(n,t,e,r,o){var u=fl(o,5);return Math.abs(e.top-r.top)<1?hl.retry(u):e.bottom<o.top?hl.retry(u):e.bottom===o.top?hl.retry(fl(o,1)):vl(n,t,o)?hl.retry(sl(u,5,0)):hl.none()},move:fl,gather:Qa}),tryDown:u(yl,bl),ieTryUp:function(n,t){return n.situsFromPoint(t.left,t.top-5)},ieTryDown:function(n,t){return n.situsFromPoint(t.left,t.bottom+5)},getJumpSize:r(5)},xl=function(n,t,e){return n.getSelection().bind(function(r){return al(t,r.finish(),r.foffset(),e).fold(function(){return d.some(Si(r.finish(),r.foffset()))},function(o){var u=n.fromSitus(o);return function(n){return el.cata(n,function(n){return d.none()},function(){return d.none()},function(n){return d.some(Si(n,0))},function(n){return d.some(Si(n,$t(n)))})}(el.verify(n,r.finish(),r.foffset(),u.finish(),u.foffset(),e.failure,t))})})},Cl=function(n,t,e,r,o,u){return 0===u?d.none():Ol(n,t,e,r,o).bind(function(i){var c=n.fromSitus(i),a=el.verify(n,e,r,c.finish(),c.foffset(),o.failure,t);return el.cata(a,function(){return d.none()},function(){return d.some(i)},function(i){return Un(e,i)&&0===r?Rl(n,e,r,fl,o):Cl(n,t,i,0,o,u-1)},function(i){return Un(e,i)&&r===$t(i)?Rl(n,e,r,ll,o):Cl(n,t,i,$t(i),o,u-1)})})},Rl=function(n,t,e,r,o){return gl(n,t,e).bind(function(t){return Tl(n,o,r(t,Sl.getJumpSize()))})},Tl=function(n,t,e){var r=Fn().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?t.otherRetry(n,e):r.isIE()?t.ieRetry(n,e):d.none()},Ol=function(n,t,e,r,o){return gl(n,e,r).bind(function(t){return Tl(n,o,t)})},Dl=function(n,t){return yt(n,function(n){return Gn(n).exists(function(n){return Un(n,t)})},e).isSome();var e},Al=function(n,t,e,o,u){return Rt(o,"td,th",t).bind(function(o){return Rt(o,"table",t).bind(function(i){return Dl(u,i)?function(n,t,e){return xl(n,t,e).bind(function(r){return Cl(n,t,r.element(),r.offset(),e,20).map(n.fromSitus)})}(n,t,e).bind(function(n){return Rt(n.finish(),"td,th",t).map(function(t){return{start:r(o),finish:r(t),range:r(n)}})}):d.none()})})},El=function(n,t,e,r,o,u){return Fn().browser.isIE()?d.none():u(r,t).orThunk(function(){return Al(n,t,e,r,o).map(function(n){var t=n.range();return Pa(d.some(Wa(t.start(),t.soffset(),t.finish(),t.foffset())),!0)})})},kl=function(n,t){return Rt(n,"tr",t).bind(function(n){return Rt(n,"table",t).bind(function(e){var r=bt(e,"tr");return Un(n,r[0])?function(n,t,e){return Ga(Ja,n,t,e)}(e,function(n){return Qt(n).isSome()},t).map(function(n){var t=$t(n);return Pa(d.some(Wa(n,t,n,t)),!0)}):d.none()})})},Bl=function(n,t){return Rt(n,"tr",t).bind(function(n){return Rt(n,"table",t).bind(function(e){var r=bt(e,"tr");return Un(n,r[r.length-1])?function(n,t,e){return Ya(Ja,n,t,e)}(e,function(n){return Jt(n).isSome()},t).map(function(n){return Pa(d.some(Wa(n,0,n,0)),!0)}):d.none()})})},Nl=function(n,t,e,r,o,u,i){return Al(n,e,r,o,u).bind(function(n){return ja(t,e,n.start(),n.finish(),i)})},Il=function(n,t){return Rt(n,"td,th",t)};var Pl={traverse:Qn,gather:Za,relative:Vc.before,otherRetry:Sl.tryDown,ieRetry:Sl.ieTryDown,failure:el.failedDown},Ml={traverse:Jn,gather:Qa,relative:Vc.before,otherRetry:Sl.tryUp,ieRetry:Sl.ieTryUp,failure:el.failedUp},_l=function(n){return function(t){return t===n}},Wl=_l(38),jl=_l(40),zl=function(n){return n>=37&&n<=40},Ll={isBackward:_l(37),isForward:_l(39)},Fl={isBackward:_l(39),isForward:_l(37)},Hl=function(n){return{left:n.left(),top:n.top(),right:n.right(),bottom:n.bottom(),width:n.width(),height:n.height()}},ql=function(t){return{elementFromPoint:function(n,e){return sn.fromPoint(sn.fromDom(t.document),n,e)},getRect:function(n){return n.dom().getBoundingClientRect()},getRangedRect:function(n,e,r,o){var u=Xc.exact(n,e,r,o);return Ra(t,u).map(Hl)},getSelection:function(){return Ca(t).map(function(n){return _a(t,n)})},fromSitus:function(n){var e=Xc.relative(n.start(),n.finish());return _a(t,e)},situsFromPoint:function(n,e){return Ta(t,n,e).map(function(n){return Ma(n.start(),n.soffset(),n.finish(),n.foffset())})},clearSelection:function(){!function(n){n.getSelection().removeAllRanges()}(t)},collapseSelection:function(n){void 0===n&&(n=!1),Ca(t).each(function(e){return e.fold(function(t){return t.collapse(n)},function(e,r){var o=n?e:r;wa(t,o,o)},function(e,r,o,u){var i=n?e:o,c=n?r:u;ba(t,i,c,i,c)})})},setSelection:function(n){ba(t,n.start(),n.soffset(),n.finish(),n.foffset())},setRelativeSelection:function(n,e){wa(t,n,e)},selectContents:function(n){xa(t,n)},getInnerHeight:function(){return t.innerHeight},getScrollY:function(){var e,r,o,u;return(e=sn.fromDom(t.document),r=void 0!==e?e.dom():n.document,o=r.body.scrollLeft||r.documentElement.scrollLeft,u=r.body.scrollTop||r.documentElement.scrollTop,xr(o,u)).top()},scrollBy:function(e,r){!function(t,e,r){(void 0!==r?r.dom():n.document).defaultView.scrollBy(t,e)}(e,r,sn.fromDom(t.document))}}},Ul=function(n,t){return{rows:n,cols:t}},Vl=function(n,t,e,r){var o=function(n,t,e,r){var o=d.none(),u=function(){o=d.none()};return{mousedown:function(n){r.clear(t),o=Il(n.target(),e)},mouseover:function(u){o.each(function(o){r.clearBeforeUpdate(t),Il(u.target(),e).each(function(u){Ee(o,u,e).each(function(e){var i=e.boxes.getOr([]);(i.length>1||1===i.length&&!Un(o,u))&&(r.selectRange(t,i,e.start,e.finish),n.selectContents(u))})})})},mouseup:function(n){o.each(u)}}}(ql(n),t,e,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},Kl=function(n,t,e,r){var o=ql(n),i=function(){return r.clear(t),d.none()};return{keydown:function(n,c,a,l,f,s){var m=n.raw(),g=m.which,p=!0===m.shiftKey;return ke(t,r.selectedSelector).fold(function(){return jl(g)&&p?u(Nl,o,t,e,Pl,l,c,r.selectRange):Wl(g)&&p?u(Nl,o,t,e,Ml,l,c,r.selectRange):jl(g)?u(El,o,e,Pl,l,c,Bl):Wl(g)?u(El,o,e,Ml,l,c,kl):d.none},function(n){var e=function(e){return function(){return _(e,function(e){return function(n,t,e,r,o){return Ne(r,n,t,o.firstSelectedSelector,o.lastSelectedSelector).map(function(n){return o.clearBeforeUpdate(e),o.selectRange(e,n.boxes,n.start,n.finish),n.boxes})}(e.rows,e.cols,t,n,r)}).fold(function(){return Be(t,r.firstSelectedSelector,r.lastSelectedSelector).map(function(n){var e=jl(g)||s.isForward(g)?Vc.after:Vc.before;return o.setRelativeSelection(Vc.on(n.first(),0),e(n.table())),r.clear(t),Pa(d.none(),!0)})},function(n){return d.some(Pa(d.none(),!0))})}};return jl(g)&&p?e([Ul(1,0)]):Wl(g)&&p?e([Ul(-1,0)]):s.isBackward(g)&&p?e([Ul(0,-1),Ul(-1,0)]):s.isForward(g)&&p?e([Ul(0,1),Ul(1,0)]):zl(g)&&!1===p?i:d.none})()},keyup:function(n,o,u,i,c){return ke(t,r.selectedSelector).fold(function(){var a=n.raw(),l=a.which;return!1==(!0===a.shiftKey)?d.none():zl(l)?function(n,t,e,r,o,u,i){return Un(e,o)&&r===u?d.none():Rt(e,"td,th",t).bind(function(e){return Rt(o,"td,th",t).bind(function(r){return ja(n,t,e,r,i)})})}(t,e,o,u,i,c,r.selectRange):d.none()},d.none)}}},Xl=function(n,t,e,r){var o=ql(n);return function(n,u){r.clearBeforeUpdate(t),Ee(n,u,e).each(function(n){var e=n.boxes.getOr([]);r.selectRange(t,e,n.start,n.finish),o.selectContents(u),o.collapseSelection()})}},$l=function(n,t){D(t,function(t){!function(n,t){Ur(n)?n.dom().classList.remove(t):Kr(n,t);$r(n)}(n,t)})},Gl={byClass:function(n){var t,e,r=(t=n.selected,function(n){Xr(n,t)}),o=(e=[n.selected,n.lastSelected,n.firstSelected],function(n){$l(n,e)}),u=function(t){var e=bt(t,n.selectedSelector);D(e,o)};return{clearBeforeUpdate:u,clear:u,selectRange:function(t,e,o,i){u(t),D(e,r),Xr(o,n.firstSelected),Xr(i,n.lastSelected)},selectedSelector:n.selectedSelector,firstSelectedSelector:n.firstSelectedSelector,lastSelectedSelector:n.lastSelectedSelector}},byAttr:function(n,t,e){var r=function(t){en(t,n.selected),en(t,n.firstSelected),en(t,n.lastSelected)},o=function(t){J(t,n.selected,"1")},u=function(n){i(n),e()},i=function(t){var e=bt(t,n.selectedSelector);D(e,r)};return{clearBeforeUpdate:i,clear:u,selectRange:function(e,r,i,c){u(e),D(r,o),J(i,n.firstSelected,"1"),J(c,n.lastSelected,"1"),t(r,i,c)},selectedSelector:n.selectedSelector,firstSelectedSelector:n.firstSelectedSelector,lastSelectedSelector:n.lastSelectedSelector}}},Yl=function(n,t,e){var r=jt(n),o=Ft.generate(r);return No(o,t).map(function(n){var t=To(o,e,!1);return{upOrLeftCells:function(n,t,e){var r=n.slice(0,t[t.length-1].row()+1),o=Do(r,e);return P(o,function(n){var e=n.cells().slice(0,t[t.length-1].column()+1);return O(e,function(n){return n.element()})})}(t,n,e),downOrRightCells:function(n,t,e){var r=n.slice(t[0].row()+t[0].rowspan()-1,n.length),o=Do(r,e);return P(o,function(n){var e=n.cells().slice(t[0].column()+t[0].colspan()-1,+n.cells().length);return O(e,function(n){return n.element()})})}(t,n,e)}})},Jl=function(n){return!1===Gr(sn.fromDom(n.target),"ephox-snooker-resizer-bar")};function Ql(n,r,o){var u=d.none(),i=hi(n),c=Gl.byAttr(_e,function(t,r,u){o.targets().each(function(o){Wt(r).each(function(c){var a=sn.fromDom(n.getDoc()),l=ae(e,a,i),f=Yl(c,o,l);wi(n,t,r,u,f)})})},function(){yi(n)});n.on("init",function(o){var i=n.getWin(),a=Yu(n),l=Zu(n),f=Vl(i,a,l,c),s=Kl(i,a,l,c),m=Xl(i,a,l,c);n.on("TableSelectorChange",function(n){m(n.start,n.finish)});var g,p,h=function(t,e){(function(n){return!0===n.raw().shiftKey})(t)&&(e.kill()&&t.kill(),e.selection().each(function(t){var e=Xc.relative(t.start(),t.finish()),r=ta(i,e);n.selection.setRng(r)}))},v=function(t){var e=Cc(t);if(e.raw().shiftKey&&zl(e.raw().which)){var r=n.selection.getRng(),o=sn.fromDom(r.startContainer),u=sn.fromDom(r.endContainer);s.keyup(e,o,r.startOffset,u,r.endOffset).each(function(n){h(e,n)})}},b=function(t){var e=Cc(t);r().each(function(n){n.hideBars()});var o=n.selection.getRng(),u=sn.fromDom(n.selection.getStart()),i=sn.fromDom(o.startContainer),c=sn.fromDom(o.endContainer),a=oi(u).isRtl()?Fl:Ll;s.keydown(e,i,o.startOffset,c,o.endOffset,a).each(function(n){h(e,n)}),r().each(function(n){n.showBars()})},w=function(n){return 0===n.button},y=function(n){w(n)&&Jl(n)&&f.mousedown(Cc(n))},S=function(n){var t;(void 0===(t=n).buttons||rc.browser.isEdge()&&0===t.buttons||0!=(1&t.buttons))&&Jl(n)&&f.mouseover(Cc(n))},x=function(n){w(n)&&Jl(n)&&f.mouseup(Cc(n))},C=(g=t(sn.fromDom(a)),p=t(0),{touchEnd:function(n){var t=sn.fromDom(n.target);if("td"===U(t)||"th"===U(t)){var e=g.get(),r=p.get();Un(e,t)&&n.timeStamp-r<300&&(n.preventDefault(),m(t,t))}g.set(t),p.set(n.timeStamp)}});n.on("mousedown",y),n.on("mouseover",S),n.on("mouseup",x),n.on("touchend",C.touchEnd),n.on("keyup",v),n.on("keydown",b),n.on("NodeChange",function(){var t=n.selection,r=sn.fromDom(t.getStart()),o=sn.fromDom(t.getEnd());De(Wt,[r,o]).fold(function(){c.clear(a)},e)}),u=d.some({mousedown:y,mouseover:S,mouseup:x,keyup:v,keydown:b})});return{clear:c.clear,destroy:function(){u.each(function(n){})}}}var Zl=function(n){return{get:function(){var t,e,r=Yu(n);return(t=r,e="td[data-mce-selected],th[data-mce-selected]",ke(t,e)).fold(function(){return void 0===n.selection.getStart()?Le():He(n.selection)},function(n){return Fe(n)})}}},nf=function(n,e){var r=t(d.none()),o=t([]),u=function(){return Ni(n).bind(function(n){return Wt(n).map(function(t){return"caption"===U(n)?Ke(n):Xe(e,t,n)})})},i=function(){r.set(xn(u)()),D(o.get(),function(n){return n()})},c=function(n,t){var e=function(){return r.get().fold(function(){n.setDisabled(!0)},function(e){n.setDisabled(t(e))})};return e(),o.set(o.get().concat([e])),function(){o.set(A(o.get(),function(n){return n!==e}))}};return n.on("NodeChange TableSelectorChange",i),{onSetupTable:function(n){return c(n,function(n){return!1})},onSetupCellOrRow:function(n){return c(n,function(n){return"caption"===U(n.element())})},onSetupMergeable:function(n){return c(n,function(n){return n.mergable().isNone()})},onSetupUnmergeable:function(n){return c(n,function(n){return n.unmergable().isNone()})},resetTargets:i,targets:function(){return r.get()}}},tf=function(n,t){n.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(n){return n("inserttable | cell row column | advtablesort | tableprops deletetable")}});var e=function(t){return function(){return n.execCommand(t)}};n.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:e("mceTableProps"),icon:"table",onSetup:t.onSetupTable}),n.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:e("mceTableDelete"),icon:"table-delete-table",onSetup:t.onSetupTable}),n.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:e("mceTableCellProps"),icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:e("mceTableMergeCells"),icon:"table-merge-cells",onSetup:t.onSetupMergeable}),n.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:e("mceTableSplitCells"),icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),n.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:e("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:e("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:e("mceTableDeleteRow"),icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:e("mceTableRowProps"),icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:e("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:e("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:e("mceTableDeleteCol"),icon:"table-delete-column",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",onAction:e("mceTableCutRow"),icon:"temporary-placeholder",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",onAction:e("mceTableCopyRow"),icon:"temporary-placeholder",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",onAction:e("mceTablePasteRowBefore"),icon:"temporary-placeholder",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",onAction:e("mceTablePasteRowAfter"),icon:"temporary-placeholder",onSetup:t.onSetupCellOrRow}),n.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:e("mceInsertTable"),icon:"table"})},ef=function(n){var t=function(n){return n.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")}(n);t.length>0&&n.ui.registry.addContextToolbar("table",{predicate:function(t){return n.dom.is(t,"table")&&n.getBody().contains(t)},items:t,scope:"node",position:"node"})},rf=function(n,t){var e=function(t){return function(){return n.execCommand(t)}},r=function(t){var e=t.numRows,r=t.numColumns;n.undoManager.transact(function(){cc(n,r,e)}),n.addVisual()},o={text:"Table properties",onSetup:t.onSetupTable,onAction:e("mceTableProps")},u={text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,onAction:e("mceTableDelete")},i=[{type:"menuitem",text:"Insert row before",icon:"table-insert-row-above",onAction:e("mceTableInsertRowBefore"),onSetup:t.onSetupCellOrRow},{type:"menuitem",text:"Insert row after",icon:"table-insert-row-after",onAction:e("mceTableInsertRowAfter"),onSetup:t.onSetupCellOrRow},{type:"menuitem",text:"Delete row",icon:"table-delete-row",onAction:e("mceTableDeleteRow"),onSetup:t.onSetupCellOrRow},{type:"menuitem",text:"Row properties",icon:"table-row-properties",onAction:e("mceTableRowProps"),onSetup:t.onSetupCellOrRow},{type:"separator"},{type:"menuitem",text:"Cut row",onAction:e("mceTableCutRow"),onSetup:t.onSetupCellOrRow},{type:"menuitem",text:"Copy row",onAction:e("mceTableCopyRow"),onSetup:t.onSetupCellOrRow},{type:"menuitem",text:"Paste row before",onAction:e("mceTablePasteRowBefore"),onSetup:t.onSetupCellOrRow},{type:"menuitem",text:"Paste row after",onAction:e("mceTablePasteRowAfter"),onSetup:t.onSetupCellOrRow}],c={type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return i}},a=[{type:"menuitem",text:"Insert column before",icon:"table-insert-column-before",onAction:e("mceTableInsertColBefore"),onSetup:t.onSetupCellOrRow},{type:"menuitem",text:"Insert column after",icon:"table-insert-column-after",onAction:e("mceTableInsertColAfter"),onSetup:t.onSetupCellOrRow},{type:"menuitem",text:"Delete column",icon:"table-delete-column",onAction:e("mceTableDeleteCol"),onSetup:t.onSetupCellOrRow}],l={type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return a}},f=[{type:"menuitem",text:"Cell properties",icon:"table-cell-properties",onAction:e("mceTableCellProps"),onSetup:t.onSetupCellOrRow},{type:"menuitem",text:"Merge cells",icon:"table-merge-cells",onAction:e("mceTableMergeCells"),onSetup:t.onSetupMergeable},{type:"menuitem",text:"Split cell",icon:"table-split-cells",onAction:e("mceTableSplitCells"),onSetup:t.onSetupUnmergeable}],s={type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return f}};!1===function(n){return n.getParam("table_grid",!0,"boolean")}(n)?n.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:e("mceInsertTable")}):n.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:r}]}}),n.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:e("mceInsertTable")}),n.ui.registry.addMenuItem("tableprops",o),n.ui.registry.addMenuItem("deletetable",u),n.ui.registry.addNestedMenuItem("row",c),n.ui.registry.addNestedMenuItem("column",l),n.ui.registry.addNestedMenuItem("cell",s),n.ui.registry.addContextMenu("table",{update:function(){return t.resetTargets(),t.targets().fold(function(){return""},function(n){return"caption"===U(n.element())?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"})}})},of=function(n,t,e,r){return{insertTable:function(t,e){return cc(n,t,e)},setClipboardRows:function(n){return function(n,t){var e=O(n,sn.fromDom);t.set(d.from(e))}(n,t)},getClipboardRows:function(){return function(n){return n.get().fold(function(){},function(n){return O(n,function(n){return n.dom()})})}(t)},resizeHandler:e,selectionTargets:r}};function uf(n){var e=Zl(n),r=nf(n,e),o=zc(n),u=Ql(n,o.lazyResize,r),i=Di(n,o.lazyWire),c=t(d.none());return mc(n,i,u,e,c),$e(n,e,i,u),rf(n,r),tf(n,r),ef(n),n.on("PreInit",function(){n.serializer.addTempAttr(Pe),n.serializer.addTempAttr(Me)}),li(n)&&n.on("keydown",function(t){Ia(t,n,i,o.lazyWire)}),n.on("remove",function(){o.destroy(),u.destroy()}),of(n,c,o,r)}m.add("table",uf)}(window);