!function(t){"use strict";var n=function(t){var n=t;return{get:function(){return n},set:function(t){n=t}}},e=function(){},r=function(t){return function(){return t}},o=function(t){return t};function i(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=n.concat(e);return t.apply(null,o)}}var u,c,a,l,f=function(t){return function(n){return!t(n)}},s=r(!1),d=r(!0),m=function(){return g},g=(u=function(t){return t.isNone()},{fold:function(t,n){return t()},is:s,isSome:s,isNone:d,getOr:a=function(t){return t},getOrThunk:c=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:r(null),getOrUndefined:r(void 0),or:a,orThunk:c,map:m,each:e,bind:m,exists:s,forall:d,filter:m,equals:u,equals_:u,toArray:function(){return[]},toString:r("none()")}),p=function(t){var n=r(t),e=function(){return i},o=function(n){return n(t)},i={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:d,isNone:s,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return p(n(t))},each:function(n){n(t)},bind:o,exists:o,forall:o,filter:function(n){return n(t)?i:g},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(s,function(n){return e(t,n)})}};return i},h={some:p,none:m,from:function(t){return null==t?g:p(t)}},v=tinymce.util.Tools.resolve("tinymce.PluginManager"),b=function(t){return function(n){return r=typeof(e=n),(null===e?"null":"object"==r&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":r)===t;var e,r}},w=function(t){return function(n){return typeof n===t}},y=b("string"),S=b("array"),x=w("boolean"),C=w("function"),R=w("number"),T=Array.prototype.slice,O=Array.prototype.indexOf,D=Array.prototype.push,A=function(t,n){return e=t,r=n,-1<O.call(e,r);var e,r},E=function(t,n){for(var e=0,r=t.length;e<r;e++)if(n(t[e],e))return!0;return!1},B=function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o)}return r},N=function(t,n){for(var e=0,r=t.length;e<r;e++)n(t[e],e)},k=function(t,n){for(var e=[],r=0,o=t.length;r<o;r++){var i=t[r];n(i,r)&&e.push(i)}return e},P=function(t,n,e){return function(t,n){for(var e=t.length-1;0<=e;e--)n(t[e])}(t,function(t){e=n(e,t)}),e},I=function(t,n,e){return N(t,function(t){e=n(e,t)}),e},M=function(t,n){return function(t,n,e){for(var r=0,o=t.length;r<o;r++){var i=t[r];if(n(i,r))return h.some(i);if(e(i,r))break}return h.none()}(t,n,s)},_=function(t,n){for(var e=0,r=t.length;e<r;e++)if(n(t[e],e))return h.some(e);return h.none()},W=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!S(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);D.apply(n,t[e])}return n},j=function(t,n){return W(B(t,n))},z=function(t,n){for(var e=0,r=t.length;e<r;++e)if(!0!==n(t[e],e))return!1;return!0},L=function(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return h.none()},F=Object.keys,H=Object.hasOwnProperty,q=function(t,n){for(var e=F(t),r=0,o=e.length;r<o;r++){var i=e[r];n(t[i],i)}},U=function(t,n){return V(t,function(t,e){return{k:e,v:n(t,e)}})},V=function(t,n){var e={};return q(t,function(t,r){var o=n(t,r);e[o.k]=o.v}),e},K=function(t,n){return X(t,n)?h.from(t[n]):h.none()},X=function(t,n){return H.call(t,n)},$=(void 0!==t.window?t.window:Function("return this;")(),function(t){return t.dom().nodeName.toLowerCase()}),G=function(t){return t.dom().nodeType},Y=function(t){return function(n){return G(n)===t}},J=function(t){return 8===G(t)||"#comment"===$(t)},Q=Y(1),Z=Y(3),tt=function(n,e,r){if(!(y(r)||x(r)||R(r)))throw t.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,r+"")},nt=function(t,n,e){tt(t.dom(),n,e)},et=function(t,n){var e=t.dom();q(n,function(t,n){tt(e,n,t)})},rt=function(t,n){var e=t.dom().getAttribute(n);return null===e?void 0:e},ot=function(t,n){return h.from(rt(t,n))},it=function(t,n){var e=t.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},ut=function(t,n){t.dom().removeAttribute(n)},ct=function(t){return I(t.dom().attributes,function(t,n){return t[n.name]=n.value,t},{})},at=function(t,n,e){return""===n||t.length>=n.length&&t.substr(e,e+n.length)===n},lt=function(t,n){return-1!==t.indexOf(n)},ft=function(t,n){return at(t,n,0)},st=(l=/^\s+|\s+$/g,function(t){return t.replace(l,"")}),dt=function(t){return void 0!==t.style&&C(t.style.getPropertyValue)},mt=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:r(t)}},gt={fromHtml:function(n,e){var r=(e||t.document).createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||1<r.childNodes.length)throw t.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return mt(r.childNodes[0])},fromTag:function(n,e){var r=(e||t.document).createElement(n);return mt(r)},fromText:function(n,e){var r=(e||t.document).createTextNode(n);return mt(r)},fromDom:mt,fromPoint:function(t,n,e){var r=t.dom();return h.from(r.elementFromPoint(n,e)).map(mt)}},pt=function(t){var n=Z(t)?t.dom().parentNode:t.dom();return null!=n&&n.ownerDocument.body.contains(n)},ht=function(n,e,r){if(!y(r))throw t.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);dt(n)&&n.style.setProperty(e,r)},vt=function(t,n,e){var r=t.dom();ht(r,n,e)},bt=function(t,n){var e=t.dom();q(n,function(t,n){ht(e,n,t)})},wt=function(n,e){var r=n.dom(),o=t.window.getComputedStyle(r).getPropertyValue(e);return""!==o||pt(n)?o:yt(r,e)},yt=function(t,n){return dt(t)?t.style.getPropertyValue(n):""},St=function(t,n){var e=t.dom(),r=yt(e,n);return h.from(r).filter(function(t){return 0<t.length})},xt=function(t,n){var e,r,o=t.dom();r=n,dt(e=o)&&e.style.removeProperty(r),ot(t,"style").map(st).is("")&&ut(t,"style")},Ct=function(){return(Ct=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},Rt=function(t){var n,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,n=t.apply(null,r)),n}},Tt=function(){return Ot(0,0)},Ot=function(t,n){return{major:t,minor:n}},Dt=function(t,n){var e=String(n).toLowerCase();return 0===t.length?Tt():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(r.test(n))return r}}(t,n);if(!e)return{major:0,minor:0};var r=function(t){return Number(n.replace(e,"$"+t))};return Ot(r(1),r(2))}(t,e)},At=Tt,Et="Firefox",Bt=function(t){var n=t.current,e=t.version,r=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r(Et),isSafari:r("Safari")}},Nt=function(){return Bt({current:void 0,version:At()})},kt=Bt,Pt=(r("Edge"),r("Chrome"),r("IE"),r("Opera"),r(Et),r("Safari"),"Windows"),It="Android",Mt="Solaris",_t="FreeBSD",Wt="ChromeOS",jt=function(t){var n=t.current,e=t.version,r=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:r(Pt),isiOS:r("iOS"),isAndroid:r(It),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r(Mt),isFreeBSD:r(_t),isChromeOS:r(Wt)}},zt=function(){return jt({current:void 0,version:At()})},Lt=jt,Ft=(r(Pt),r("iOS"),r(It),r("Linux"),r("OSX"),r(Mt),r(_t),r(Wt),function(t,n){var e=String(n).toLowerCase();return M(t,function(t){return t.search(e)})}),Ht=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,qt=function(t){return function(n){return lt(n,t)}},Ut=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return lt(t,"edge/")&&lt(t,"chrome")&&lt(t,"safari")&&lt(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ht],search:function(t){return lt(t,"chrome")&&!lt(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return lt(t,"msie")||lt(t,"trident")}},{name:"Opera",versionRegexes:[Ht,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:qt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:qt("firefox")},{name:"Safari",versionRegexes:[Ht,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(lt(t,"safari")||lt(t,"mobile/"))&&lt(t,"applewebkit")}}],Vt=[{name:"Windows",search:qt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return lt(t,"iphone")||lt(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:qt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:qt("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:qt("linux"),versionRegexes:[]},{name:"Solaris",search:qt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:qt("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:qt("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Kt={browsers:r(Ut),oses:r(Vt)},Xt=function(t,n){var e,o,i,u,c,a,l,f,s,d,m,g,p=Kt.browsers(),h=Kt.oses(),v=function(t,n){return Ft(t,n).map(function(t){var e=Dt(t.versionRegexes,n);return{current:t.name,version:e}})}(p,t).fold(Nt,kt),b=function(t,n){return Ft(t,n).map(function(t){var e=Dt(t.versionRegexes,n);return{current:t.name,version:e}})}(h,t).fold(zt,Lt);return{browser:v,os:b,deviceType:(o=v,i=t,u=n,c=(e=b).isiOS()&&!0===/ipad/i.test(i),a=e.isiOS()&&!c,l=e.isiOS()||e.isAndroid(),f=l||u("(pointer:coarse)"),s=c||!a&&l&&u("(min-device-width:768px)"),d=a||l&&!s,m=o.isSafari()&&e.isiOS()&&!1===/safari/i.test(i),g=!d&&!s&&!m,{isiPad:r(c),isiPhone:r(a),isTablet:r(s),isPhone:r(d),isTouch:r(f),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:r(m),isDesktop:r(g)})}},$t=function(n){return t.window.matchMedia(n).matches},Gt=Rt(function(){return Xt(t.navigator.userAgent,$t)}),Yt=function(){return Gt()},Jt=function(t,n){var e=t.dom();if(1!==e.nodeType)return!1;var r=e;if(void 0!==r.matches)return r.matches(n);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(n);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(n);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},Qt=function(t){return 1!==t.nodeType&&9!==t.nodeType||0===t.childElementCount},Zt=function(t,n){return t.dom()===n.dom()},tn=function(n,e){return Yt().browser.isIE()?function(n,e){return r=n.dom(),o=e.dom(),i=t.Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(r.compareDocumentPosition(o)&i);var r,o,i}(n,e):(r=e,(o=n.dom())!==(i=r.dom())&&o.contains(i));var r,o,i},nn=Jt,en=function(t){return gt.fromDom(t.dom().ownerDocument)},rn=function(t){return h.from(t.dom().parentNode).map(gt.fromDom)},on=function(t,n){for(var e=C(n)?n:s,r=t.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=gt.fromDom(i);if(o.push(u),!0===e(u))break;r=i}return o},un=function(t){return h.from(t.dom().previousSibling).map(gt.fromDom)},cn=function(t){return h.from(t.dom().nextSibling).map(gt.fromDom)},an=function(t){return B(t.dom().childNodes,gt.fromDom)},ln=function(t,n){var e=t.dom().childNodes;return h.from(e[n]).map(gt.fromDom)},fn=function(t,n){rn(t).each(function(e){e.dom().insertBefore(n.dom(),t.dom())})},sn=function(t,n){cn(t).fold(function(){rn(t).each(function(t){mn(t,n)})},function(t){fn(t,n)})},dn=function(t,n){ln(t,0).fold(function(){mn(t,n)},function(e){t.dom().insertBefore(n.dom(),e.dom())})},mn=function(t,n){t.dom().appendChild(n.dom())},gn=function(t,n){fn(t,n),mn(n,t)},pn=function(t,n){N(n,function(e,r){var o=0===r?t:n[r-1];sn(o,e)})},hn=function(t,n){N(n,function(n){mn(t,n)})},vn=function(t){t.dom().textContent="",N(an(t),function(t){bn(t)})},bn=function(t){var n=t.dom();null!==n.parentNode&&n.parentNode.removeChild(n)},wn=function(t){var n,e=an(t);0<e.length&&(n=t,N(e,function(t){fn(n,t)})),bn(t)},yn=function(t,n,e){return{element:r(t),rowspan:r(n),colspan:r(e)}},Sn=function(t,n,e){return{element:r(t),cells:r(n),section:r(e)}},xn=function(t,n){return{element:r(t),isNew:r(n)}},Cn=function(t,n){return{cells:r(t),section:r(n)}},Rn=function(t,n){var e=[];return N(an(t),function(t){n(t)&&(e=e.concat([t])),e=e.concat(Rn(t,n))}),e},Tn=function(t,n,e){return r=function(t){return Jt(t,n)},k(on(t,e),r);var r},On=function(n,e){return r=e,i=void 0===(o=n)?t.document:o.dom(),Qt(i)?[]:B(i.querySelectorAll(r),gt.fromDom);var r,o,i};function Dn(t,n,e,r,o){return t(e,r)?h.some(e):C(o)&&o(e)?h.none():n(e,r,o)}var An=function(t,n,e){for(var o=t.dom(),i=C(e)?e:r(!1);o.parentNode;){o=o.parentNode;var u=gt.fromDom(o);if(n(u))return h.some(u);if(i(u))break}return h.none()},En=function(t,n,e){return An(t,function(t){return Jt(t,n)},e)},Bn=function(t,n){return e=function(t){return Jt(t,n)},M(t.dom().childNodes,function(t){return e(gt.fromDom(t))}).map(gt.fromDom);var e},Nn=function(n,e){return r=e,i=void 0===(o=n)?t.document:o.dom(),Qt(i)?h.none():h.from(i.querySelector(r)).map(gt.fromDom);var r,o,i},kn=function(t,n,e){return Dn(function(t,n){return Jt(t,n)},En,t,n,e)},Pn=function(t,n,e){return void 0===e&&(e=0),ot(t,n).map(function(t){return parseInt(t,10)}).getOr(e)},In=function(t,n){return Pn(t,n,1)},Mn=function(t){return 1<In(t,"colspan")},_n=function(t){return 1<In(t,"rowspan")},Wn=function(t,n){return parseInt(wt(t,n),10)},jn=r(10),zn=r(10),Ln=function(t,n){return Fn(t,n,r(!0))},Fn=function(t,n,e){return j(an(t),function(t){return Jt(t,n)?e(t)?[t]:[]:Fn(t,n,e)})},Hn=function(t,n){return function(t,n,e){return void 0===e&&(e=s),e(n)?h.none():A(t,$(n))?h.some(n):En(n,t.join(","),function(t){return Jt(t,"table")||e(t)})}(["td","th"],t,n)},qn=function(t){return Ln(t,"th,td")},Un=function(t,n){return rn(n).map(function(n){return function(t,n){return e=function(t){return Jt(t,n)},k(an(t),e);var e}(n,t)})},Vn=(i(Un,"th,td"),i(Un,"tr"),function(t,n){return kn(t,"table",n)}),Kn=function(t){var n=Ln(t,"tr");return B(n,function(t){var n=t,e=rn(n).map(function(t){var n=$(t);return"tfoot"===n||"thead"===n||"tbody"===n?n:"tbody"}).getOr("tbody"),r=B(qn(t),function(t){var n=Pn(t,"rowspan",1),e=Pn(t,"colspan",1);return yn(t,n,e)});return Sn(n,r,e)})},Xn=function(t,n){return t+","+n},$n=function(t,n){var e=j(t.all,function(t){return t.cells()});return k(e,n)},Gn=function(t){var n={},e=[],o=t.length,i=0;return N(t,function(t,o){var u=[];N(t.cells(),function(t){for(var e=0;void 0!==n[Xn(o,e)];)e++;for(var c,a,l,f=(c=t.element(),a=t.rowspan(),l=t.colspan(),{element:r(c),rowspan:r(a),colspan:r(l),row:r(o),column:r(e)}),s=0;s<t.colspan();s++)for(var d=0;d<t.rowspan();d++){var m=e+s,g=Xn(o+d,m);n[g]=f,i=Math.max(i,m+1)}u.push(f)}),e.push(Sn(t.element(),u,t.section()))}),{grid:{rows:r(o),columns:r(i)},access:n,all:e}},Yn=function(t,n,e){var r=t.access[Xn(n,e)];return void 0!==r?h.some(r):h.none()},Jn=function(t,n,e){var r=$n(t,function(t){return e(n,t.element())});return 0<r.length?h.some(r[0]):h.none()},Qn=$n,Zn=function(t){var n=B(t.all,function(t){return t.cells()});return W(n)},te=function(t,n){var e,r,o,i,u,c,a,l,f,s,d=function(t){return Jt(t.element(),n)},m=Kn(t),g=Gn(m),p=(r=d,o=(e=g).grid.columns(),i=e.grid.rows(),u=o,a=c=0,q(e.access,function(t){if(r(t)){var n=t.row(),e=n+t.rowspan()-1,o=t.column(),l=o+t.colspan()-1;n<i?i=n:c<e&&(c=e),o<u?u=o:a<l&&(a=l)}}),{minRow:i,minCol:u,maxRow:c,maxCol:a}),h="th:not("+n+"),td:not("+n+")",v=Fn(t,"th,td",function(t){return Jt(t,h)});return N(v,bn),function(t,n,e,r){for(var o,i,u,c=n.grid.columns(),a=n.grid.rows(),l=0;l<a;l++)for(var f=!1,s=0;s<c;s++)l<e.minRow||l>e.maxRow||s<e.minCol||s>e.maxCol||(Yn(n,l,s).filter(r).isNone()?(o=f,i=t[l].element(),u=gt.fromTag("td"),mn(u,gt.fromTag("br")),(o?mn:dn)(i,u)):f=!0)}(m,g,p,d),f=p,s=k(Ln(l=t,"tr"),function(t){return 0===t.dom().childElementCount}),N(s,bn),f.minCol!==f.maxCol&&f.minRow!==f.maxRow||N(Ln(l,"th,td"),function(t){ut(t,"rowspan"),ut(t,"colspan")}),ut(l,"width"),ut(l,"height"),xt(l,"width"),xt(l,"height"),t},ne=function(t,n){var e=function(n){return t(n)?h.from(n.dom().nodeValue):h.none()};return{get:function(r){if(!t(r))throw new Error("Can only get "+n+" value of a "+n+" node");return e(r).getOr("")},getOption:e,set:function(e,r){if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom().nodeValue=r}}}(Z,"text"),ee=function(t){return ne.get(t)},re=function(t){return ne.getOption(t)},oe=function(t,n){return ne.set(t,n)},ie=function(t){return"img"===$(t)?1:re(t).fold(function(){return an(t).length},function(t){return t.length})},ue=["img","br"],ce=function(t){return re(t).filter(function(t){return 0!==t.trim().length||-1<t.indexOf("Â ")}).isSome()||A(ue,$(t))},ae=function(t){return n=ce,(e=function(t){for(var r=0;r<t.childNodes.length;r++){var o=gt.fromDom(t.childNodes[r]);if(n(o))return h.some(o);var i=e(t.childNodes[r]);if(i.isSome())return i}return h.none()})(t.dom());var n,e},le=function(t){return fe(t,ce)},fe=function(t,n){var e=function(t){for(var r=an(t),o=r.length-1;0<=o;o--){var i=r[o];if(n(i))return h.some(i);var u=e(i);if(u.isSome())return u}return h.none()};return e(t)},se=function(t,n){return gt.fromDom(t.dom().cloneNode(n))},de=function(t){return se(t,!1)},me=function(t){return se(t,!0)},ge=function(){var t=gt.fromTag("td");return mn(t,gt.fromTag("br")),t},pe=function(t,n,e){var r=function(t,n){var e,r,o,i,u=(e=t,r=n,o=gt.fromTag(r),i=ct(e),et(o,i),o),c=an(me(t));return hn(u,c),u}(t,n);return q(e,function(t,n){null===t?ut(r,n):nt(r,n,t)}),r},he=function(t){return t},ve=function(t){return function(){return gt.fromTag("tr",t.dom())}},be=function(t,n,e){return{row:ve(n),cell:function(n){var r,o,i,u,c,a,l=en(n.element()),f=gt.fromTag($(n.element()),l.dom()),s=e.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),d=0<s.length?(r=n.element(),o=f,i=s,ae(r).map(function(t){var n=i.join(","),e=Tn(t,n,function(t){return Zt(t,r)});return P(e,function(t,n){var e=de(n);return ut(e,"contenteditable"),mn(t,e),e},o)}).getOr(o)):f;return mn(d,gt.fromTag("br")),u=f,c=n.element().dom(),a=u.dom(),dt(c)&&dt(a)&&(a.style.cssText=c.style.cssText),xt(f,"height"),1!==n.colspan()&&xt(n.element(),"width"),t(n.element(),f),f},replace:pe,gap:ge}},we=function(t){return{row:ve(t),cell:ge,replace:he,gap:ge}},ye=function(t,n){var e=n.column(),r=n.column()+n.colspan()-1,o=n.row(),i=n.row()+n.rowspan()-1;return e<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},Se=function(t,n){return n.column()>=t.startCol()&&n.column()+n.colspan()-1<=t.finishCol()&&n.row()>=t.startRow()&&n.row()+n.rowspan()-1<=t.finishRow()},xe=function(t,n,e){var o=Jn(t,n,Zt),i=Jn(t,e,Zt);return o.bind(function(t){return i.map(function(n){return function(t,n){return e=Math.min(t.row(),n.row()),o=Math.min(t.column(),n.column()),i=Math.max(t.row()+t.rowspan()-1,n.row()+n.rowspan()-1),u=Math.max(t.column()+t.colspan()-1,n.column()+n.colspan()-1),{startRow:r(e),startCol:r(o),finishRow:r(i),finishCol:r(u)};var e,o,i,u}(t,n)})})},Ce=function(t,n,e){return xe(t,n,e).map(function(n){var e=Qn(t,i(ye,n));return B(e,function(t){return t.element()})})},Re=function(t,n){return Jn(t,n,function(t,n){return tn(n,t)}).map(function(t){return t.element()})},Te=function(t,n,e,r,o){var i=Oe(t),u=Zt(t,e)?h.some(n):Re(i,n),c=Zt(t,o)?h.some(r):Re(i,r);return u.bind(function(t){return c.bind(function(n){return Ce(i,t,n)})})},Oe=function(t){var n=Kn(t);return Gn(n)},De=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Ae(){return{up:r({selector:En,closest:kn,predicate:An,all:on}),down:r({selector:On,predicate:Rn}),styles:r({get:wt,getRaw:St,set:vt,remove:xt}),attrs:r({get:rt,set:nt,remove:ut,copyTo:function(t,n){var e=ct(t);et(n,e)}}),insert:r({before:fn,after:sn,afterAll:pn,append:mn,appendAll:hn,prepend:dn,wrap:gn}),remove:r({unwrap:wn,remove:bn}),create:r({nu:gt.fromTag,clone:function(t){return gt.fromDom(t.dom().cloneNode(!1))},text:gt.fromText}),query:r({comparePosition:function(t,n){return t.dom().compareDocumentPosition(n.dom())},prevSibling:un,nextSibling:cn}),property:r({children:an,name:$,parent:rn,document:function(t){return t.dom().ownerDocument},isText:Z,isComment:J,isElement:Q,getText:ee,setText:oe,isBoundary:function(t){return!!Q(t)&&("body"===$(t)||A(De,$(t)))},isEmptyTag:function(t){return!!Q(t)&&A(["br","img","hr","input"],$(t))},isNonEditable:function(t){return Q(t)&&"false"===rt(t,"contenteditable")}}),eq:Zt,is:nn}}var Ee=function(t,n,e){return n.bind(function(n){return e.filter(i(t.eq,n))})},Be=function(t,n,e){return 0<e.length?function(t,n,e,r){var o=n(t,e);return P(r,function(e,r){var o=n(t,r);return Ee(t,e,o)},o)}(t,n,(r=e)[0],r.slice(1)):h.none();var r},Ne=function(t,n,e,o){void 0===o&&(o=s);var u=[n].concat(t.up().all(n)),c=[e].concat(t.up().all(e)),a=function(t){return _(t,o).fold(function(){return t},function(n){return t.slice(0,n+1)})},l=a(u),f=a(c),d=M(l,function(n){return E(f,(e=n,i(t.eq,e)));var e});return{firstpath:r(l),secondpath:r(f),shared:r(d)}},ke=Ae(),Pe=function(t,n){return Be(ke,function(n,e){return t(e)},n)},Ie=function(t){return En(t,"table")},Me=function(t,n,e){var r=function(t){return function(n){return void 0!==e&&e(n)||Zt(n,t)}};return Zt(t,n)?h.some({boxes:h.some([t]),start:t,finish:n}):Ie(t).bind(function(o){return Ie(n).bind(function(i){if(Zt(o,i))return h.some({boxes:(l=t,f=n,s=Oe(o),Ce(s,l,f)),start:t,finish:n});if(tn(o,i)){var u=0<(c=Tn(n,"td,th",r(o))).length?c[c.length-1]:n;return h.some({boxes:Te(o,t,o,n,i),start:t,finish:u})}if(tn(i,o)){var c,a=0<(c=Tn(t,"td,th",r(i))).length?c[c.length-1]:t;return h.some({boxes:Te(i,t,o,n,i),start:t,finish:a})}return Ne(ke,t,n,void 0).shared().bind(function(u){return kn(u,"table",e).bind(function(e){var u=Tn(n,"td,th",r(e)),c=0<u.length?u[u.length-1]:n,a=Tn(t,"td,th",r(e)),l=0<a.length?a[a.length-1]:t;return h.some({boxes:Te(e,t,o,n,i),start:l,finish:c})})});var l,f,s})})},_e=function(t,n){var e=On(t,n);return 0<e.length?h.some(e):h.none()},We=function(t,n,e){return Nn(t,n).bind(function(n){return Nn(t,e).bind(function(t){return Pe(Ie,[n,t]).map(function(e){return{first:r(n),last:r(t),table:r(e)}})})})},je=function(t,n,e,r,o){return i=o,M(t,function(t){return Jt(t,i)}).bind(function(t){return(o=t,i=n,u=e,Vn(o).bind(function(t){var n,e,r,c=Oe(t);return e=i,r=u,Jn(n=c,o,Zt).bind(function(t){var o=0<e?t.row()+t.rowspan()-1:t.row(),i=0<r?t.column()+t.colspan()-1:t.column();return Yn(n,o+e,i+r).map(function(t){return t.element()})})})).bind(function(t){return e=r,En(n=t,"table").bind(function(t){return Nn(t,e).bind(function(t){return Me(t,n).bind(function(t){return t.boxes.map(function(n){return{boxes:n,start:t.start,finish:t.finish}})})})});var n,e});var o,i,u});var i},ze=function(t,n,e){return We(t,n,e).bind(function(n){var e=function(n){return Zt(t,n)},r=En(n.first(),"thead,tfoot,tbody,table",e),o=En(n.last(),"thead,tfoot,tbody,table",e);return r.bind(function(t){return o.bind(function(e){return Zt(t,e)?(r=n.table(),o=n.first(),u=n.last(),function(t,n,e){return xe(t,n,e).bind(function(n){return function(t,n){for(var e=!0,r=i(Se,n),o=n.startRow();o<=n.finishRow();o++)for(var u=n.startCol();u<=n.finishCol();u++)e=e&&Yn(t,o,u).exists(r);return e?h.some(n):h.none()}(t,n)})}(Oe(r),o,u)):h.none();var r,o,u})})})},Le="td[data-mce-selected],th[data-mce-selected]",Fe="[data-mce-selected]",He="data-mce-first-selected",qe="td[data-mce-first-selected],th[data-mce-first-selected]",Ue="data-mce-last-selected",Ve="td[data-mce-last-selected],th[data-mce-last-selected]",Ke=Object.freeze({__proto__:null,selected:"data-mce-selected",selectedSelector:Le,attributeSelector:Fe,firstSelected:He,firstSelectedSelector:qe,lastSelected:Ue,lastSelectedSelector:Ve}),Xe=function(n){if(!S(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var e=[],r={};return N(n,function(o,i){var u=F(o);if(1!==u.length)throw new Error("one and only one name per case");var c=u[0],a=o[c];if(void 0!==r[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!S(a))throw new Error("case arguments must be an array");e.push(c),r[c]=function(){var r=arguments.length;if(r!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length);return arguments[i].apply(null,o)},match:function(t){var n=F(t);if(e.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+n.join(","));if(!z(e,function(t){return A(n,t)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+e.join(", "));return t[c].apply(null,o)},log:function(n){t.console.log(n,{constructors:e,constructor:c,params:o})}}}}),r},$e=Xe([{none:[]},{multiple:["elements"]},{single:["selection"]}]),Ge=function(t,n,e,r){return t.fold(n,e,r)},Ye=$e.none,Je=$e.multiple,Qe=$e.single,Ze=function(t,n){return Ge(n.get(),r([]),o,r([t]))},tr=function(t){return{element:r(t),mergable:h.none,unmergable:h.none,selection:r([t])}},nr=function(t,n,e){return{element:r(e),mergable:r((i=n,Ge(t.get(),h.none,function(t,n){return 0===t.length?h.none():ze(i,qe,Ve).bind(function(n){return 1<t.length?h.some({bounds:r(n),cells:r(t)}):h.none()})},h.none))),unmergable:r(0<(o=Ze(e,t)).length&&z(o,function(t){return it(t,"rowspan")&&1<parseInt(rt(t,"rowspan"),10)||it(t,"colspan")&&1<parseInt(rt(t,"colspan"),10)})?h.some(o):h.none()),selection:r(Ze(e,t))};var o,i},er=function(n,o,i,u){n.on("BeforeGetContent",function(t){!0===t.selection&&Ge(o.get(),e,function(e){t.preventDefault(),Vn(e[0]).map(me).map(function(t){return[te(t,Fe)]}).each(function(e){var r;t.content="text"===t.format?B(e,function(t){return t.dom().innerText}).join(""):(r=n,B(e,function(t){return r.selection.serializer.serialize(t.dom(),{})}).join(""))})},e)}),n.on("BeforeSetContent",function(e){!0===e.selection&&!0===e.paste&&h.from(n.dom.getParent(n.selection.getStart(),"th,td")).each(function(o){var c=gt.fromDom(o);Vn(c).each(function(o){var a,l,f,s,d=k((a=e.content,(l=t.document.createElement("div")).innerHTML=a,an(gt.fromDom(l))),function(t){return"meta"!==$(t)});if(1===d.length&&"table"===$(d[0])){e.preventDefault();var m=gt.fromDom(n.getDoc()),g=we(m),p=(f=c,s=d[0],{element:r(f),clipboard:r(s),generators:r(g)});i.pasteCells(o,p).each(function(t){n.selection.setRng(t),n.focus(),u.clear(o)})}})})})};function rr(t,n){var e=function(e){var r=n(e);if(r<=0||null===r){var o=wt(e,t);return parseFloat(o)||0}return r},r=function(t,n){return I(n,function(n,e){var r=wt(t,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?n:n+o},0)};return{set:function(n,e){if(!R(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var r=n.dom();dt(r)&&(r.style[t]=e+"px")},get:e,getOuter:e,aggregate:r,max:function(t,n,e){var o=r(t,e);return o<n?n-o:0}}}var or=rr("height",function(t){var n=t.dom();return pt(t)?n.getBoundingClientRect().height:n.offsetHeight}),ir=function(t){return or.get(t)},ur=function(t){return or.getOuter(t)},cr=rr("width",function(t){return t.dom().offsetWidth}),ar=function(t){return cr.get(t)},lr=function(t){return cr.getOuter(t)},fr=function(t,n,e){return r=wt(t,n),o=e,i=parseFloat(r),isNaN(i)?o:i;var r,o,i},sr=/(\d+(\.\d+)?)(\w|%)*/,dr=/(\d+(\.\d+)?)%/,mr=/(\d+(\.\d+)?)px|em/,gr=function(t,n){vt(t,"width",n+"px")},pr=function(t,n){vt(t,"width",n+"%")},hr=function(t,n){vt(t,"height",n+"px")},vr=function(t){var n,e=St(n=t,"height").getOrThunk(function(){return function(t){return(c=Yt()).browser.isIE()||c.browser.isEdge()?(e=fr(n=t,"padding-top",0),r=fr(n,"padding-bottom",0),o=fr(n,"border-top-width",0),i=fr(n,"border-bottom-width",0),u=n.dom().getBoundingClientRect().height,"border-box"===wt(n,"box-sizing")?u:u-e-r-(o+i)):fr(t,"height",ir(t));var n,e,r,o,i,u,c}(n)+"px"});return e?function(t,n,e,r){var o,i,u,c,a,l,f=parseInt(t,10);return at(l=t,"%",l.length-"%".length)&&"table"!==$(n)?(i=f,u=e,c=r,a=Vn(o=n).map(function(t){var n=u(t);return Math.floor(i/100*n)}).getOr(i),c(o,a),a):f}(e,t,ir,hr):ir(t)},br=function(t){return St(t,"width").fold(function(){return h.from(rt(t,"width"))},function(t){return h.some(t)})},wr=function(t,n){return t/n.pixelWidth()*100},yr=function(t,n){return br(t).fold(function(){var e=ar(t);return wr(e,n)},function(e){return function(t,n,e){var r=dr.exec(n);if(null!==r)return parseFloat(r[1]);var o=ar(t);return wr(o,e)}(t,e,n)})},Sr=function(t,n){return br(t).fold(function(){return ar(t)},function(e){return function(t,n,e){var r=mr.exec(n);if(null!==r)return parseInt(r[1],10);var o=dr.exec(n);return null===o?ar(t):parseFloat(o[1])/100*e.pixelWidth()}(t,e,n)})},xr=function(t){return"rowspan",vr(n=t)/In(n,"rowspan");var n},Cr=function(t,n,e){vt(t,"width",n+e)},Rr=r(dr),Tr=r(mr),Or=function(t,n){br(t).bind(function(t){var n=sr.exec(t);return null!==n?h.some({width:r(parseFloat(n[1])),unit:r(n[3])}):h.none()}).each(function(e){var r=e.width()/2;Cr(t,r,e.unit()),Cr(n,r,e.unit())})},Dr=function(t,n){return{left:r(t),top:r(n),translate:function(e,r){return Dr(t+e,n+r)}}},Ar=Dr,Er=function(t,n){return void 0!==t?t:void 0!==n?n:0},Br=function(t){var n=t.dom().ownerDocument,e=n.body,r=n.defaultView,o=n.documentElement;if(e===t.dom())return Ar(e.offsetLeft,e.offsetTop);var i=Er(r.pageYOffset,o.scrollTop),u=Er(r.pageXOffset,o.scrollLeft),c=Er(o.clientTop,e.clientTop),a=Er(o.clientLeft,e.clientLeft);return Nr(t).translate(u-a,i-c)},Nr=function(t){var n,e=t.dom(),r=e.ownerDocument.body;return r===e?Ar(r.offsetLeft,r.offsetTop):pt(t)?(n=e.getBoundingClientRect(),Ar(n.left,n.top)):Ar(0,0)},kr=function(t,n){return{row:t,y:n}},Pr=function(t,n){return{col:t,x:n}},Ir=function(t){return Br(t).left()+lr(t)},Mr=function(t){return Br(t).left()},_r=function(t,n){return Pr(t,Mr(n))},Wr=function(t,n){return Pr(t,Ir(n))},jr=function(t){return Br(t).top()},zr=function(t,n){return kr(t,jr(n))},Lr=function(t,n){return kr(t,jr(n)+ur(n))},Fr=function(t,n,e){if(0===e.length)return[];var r=B(e.slice(1),function(n,e){return n.map(function(n){return t(e,n)})}),o=e[e.length-1].map(function(t){return n(e.length-1,t)});return r.concat([o])},Hr={delta:o,positions:function(t){return Fr(zr,Lr,t)},edge:jr},qr={ltr:{delta:o,edge:Mr,positions:function(t){return Fr(_r,Wr,t)}},rtl:{delta:function(t){return-t},edge:Ir,positions:function(t){return Fr(Wr,_r,t)}}};function Ur(t){var n=function(n){return t(n).isRtl()?qr.rtl:qr.ltr};return{delta:function(t,e){return n(e).delta(t,e)},edge:function(t){return n(t).edge(t)},positions:function(t,e){return n(e).positions(t,e)}}}var Vr=function(t){var n=Kn(t);return Gn(n).grid},Kr=function(t){for(var n=[],e=function(t){n.push(t)},r=0;r<t.length;r++)t[r].each(e);return n},Xr=function(t,n,e,r){e===r?ut(t,n):nt(t,n,e)},$r=function(t,n){var e=rt(t,n);return void 0===e||""===e?[]:e.split(" ")},Gr=function(t){return void 0!==t.dom().classList},Yr=function(t,n){Gr(t)?t.dom().classList.add(n):function(t,n){return r=n,o=$r(e=t,"class").concat([r]),nt(e,"class",o.join(" ")),!0;var e,r,o}(t,n)},Jr=function(t,n){return Gr(t)&&t.dom().classList.contains(n)},Qr=function(t,n){for(var e=[],r=t;r<n;r++)e.push(r);return e},Zr=function(t,n){if(n<0||n>=t.length-1)return h.none();var e=t[n].fold(function(){var e,r,o=(e=t.slice(0,n),(r=T.call(e,0)).reverse(),r);return L(o,function(t,n){return t.map(function(t){return{value:t,delta:n+1}})})},function(t){return h.some({value:t,delta:0})}),r=t[n+1].fold(function(){var e=t.slice(n+1);return L(e,function(t,n){return t.map(function(t){return{value:t,delta:n+1}})})},function(t){return h.some({value:t,delta:1})});return e.bind(function(t){return r.map(function(n){var e=n.delta+t.delta;return Math.abs(n.value-t.value)/e})})},to=function(t){var n=t.grid,e=Qr(0,n.columns()),o=Qr(0,n.rows());return B(e,function(n){return no(function(){return j(o,function(e){return Yn(t,e,n).filter(function(t){return t.column()===n}).fold(r([]),function(t){return[t]})})},function(t){return 1===t.colspan()},function(){return Yn(t,0,n)})})},no=function(t,n,e){var r=t();return M(r,n).orThunk(function(){return h.from(r[0]).orThunk(e)}).map(function(t){return t.element()})},eo=function(t){var n=t.grid,e=Qr(0,n.rows()),o=Qr(0,n.columns());return B(e,function(n){return no(function(){return j(o,function(e){return Yn(t,n,e).filter(function(t){return t.row()===n}).fold(r([]),function(t){return[t]})})},function(t){return 1===t.rowspan()},function(){return Yn(t,n,0)})})},ro=function(t){var n=t.replace(/\./g,"-");return{resolve:function(t){return n+"-"+t}}},oo=ro("ephox-snooker").resolve,io=oo("resizer-bar"),uo=oo("resizer-rows"),co=oo("resizer-cols"),ao=function(t){var n=On(t.parent(),"."+io);N(n,bn)},lo=function(t,n,e){var r=t.origin();N(n,function(n){n.each(function(n){var o=e(r,n);Yr(o,io),mn(t.parent(),o)})})},fo=function(t,n,e,r){ao(t);var o=Kn(n),i=Gn(o);!function(t,n,e,r,o,i){var u=Br(n);!function(t,n,e,r){lo(t,n,function(t,n){var o,i,u,c,a,l=(o=n.row,i=e.left()-t.left(),u=n.y-t.top(),c=r,a=gt.fromTag("div"),bt(a,{position:"absolute",left:i+"px",top:u-3.5+"px",height:"7px",width:c+"px"}),et(a,{"data-row":o,role:"presentation"}),a);return Yr(l,uo),l})}(t,0<e.length?o.positions(e,n):[],u,lr(n)),function(t,n,e,r){lo(t,n,function(t,n){var o,i,u,c,a,l=(o=n.col,i=n.x-t.left(),u=e.top()-t.top(),c=r,a=gt.fromTag("div"),bt(a,{position:"absolute",left:i-3.5+"px",top:u+"px",height:c+"px",width:"7px"}),et(a,{"data-column":o,role:"presentation"}),a);return Yr(l,co),l})}(t,0<r.length?i.positions(r,n):[],u,ur(n))}(t,n,eo(i),to(i),e,r)},so=function(t,n){var e=On(t.parent(),"."+io);N(e,n)},mo=function(t){so(t,function(t){vt(t,"display","none")})},go=function(t){so(t,function(t){vt(t,"display","block")})},po=function(t,n,e){t.cells()[n]=e},ho=function(t,n){return Cn(n,t.section())},vo=function(t,n){var e=t.cells(),r=B(e,n);return Cn(r,t.section())},bo=function(t,n){return t.cells()[n]},wo=function(t,n){return bo(t,n).element()},yo=function(t){return t.cells().length},So=function(t,n){if(0===t.length)return 0;var e=t[0];return _(t,function(t){return!n(e.element(),t.element())}).fold(function(){return t.length},function(t){return t})},xo=function(t,n){var e=B(t,function(t){return B(t.cells(),function(){return!1})});return B(t,function(o,i){var u,c;return u=j(o.cells(),function(o,u){if(!1!==e[i][u])return[];var c,a,l,f,s=function(t,n,e,r){var o,i=t[n].cells().slice(e),u=So(i,r),c=(o=e,B(t,function(t){return bo(t,o)}).slice(n));return{colspan:u,rowspan:So(c,r)}}(t,i,u,n);return function(t,n,r,o){for(var i=t;i<t+r;i++)for(var u=n;u<n+o;u++)e[i][u]=!0}(i,u,s.rowspan,s.colspan),[(c=o.element(),a=s.rowspan,l=s.colspan,f=o.isNew(),{element:r(c),rowspan:r(a),colspan:r(l),isNew:r(f)})]}),c=o.section(),{details:r(u),section:r(c)}})},Co=function(t,n,e){for(var r=[],o=0;o<t.grid.rows();o++){for(var i=[],u=0;u<t.grid.columns();u++){var c=Yn(t,o,u).map(function(t){return xn(t.element(),e)}).getOrThunk(function(){return xn(n.gap(),!0)});i.push(c)}var a=Cn(i,t.all[o].section());r.push(a)}return r},Ro=function(t,n){return function(t,n){return B(t,function(t){var e,o,i,u,c,a=(e=t.details(),L(e,function(t){return rn(t.element()).map(function(t){var n=rn(t).isNone();return xn(t,n)})}).getOrThunk(function(){return xn(n.row(),!0)}));return o=a.element(),i=t.details(),u=t.section(),c=a.isNew(),{element:r(o),cells:r(i),section:r(u),isNew:r(c)}})}(xo(t,Zt),n)},To=function(t,n){return L(t.all,function(t){return M(t.cells(),function(t){return Zt(n,t.element())})})},Oo=function(t,n,e,o,i){return function(u,c,a,l,f){var s=Kn(c),d=Gn(s);return n(d,a).map(function(n){var e=Co(d,l,!1),o=t(e,n,Zt,i(l)),u=Ro(o.grid(),l);return{grid:r(u),cursor:o.cursor}}).fold(function(){return h.none()},function(t){var n=function(t,n){var e=[],r=[],o=function(n,o){0<n.length?function(n,o){var i=Bn(t,o).getOrThunk(function(){var n=gt.fromTag(o,en(t).dom());return mn(t,n),n});vn(i);var u=B(n,function(t){t.isNew()&&e.push(t.element());var n=t.element();return vn(n),N(t.cells(),function(t){t.isNew()&&r.push(t.element()),Xr(t.element(),"colspan",t.colspan(),1),Xr(t.element(),"rowspan",t.rowspan(),1),mn(n,t.element())}),n});hn(i,u)}(n,o):Bn(t,o).each(bn)},i=[],u=[],c=[];return N(n,function(t){switch(t.section()){case"thead":i.push(t);break;case"tbody":u.push(t);break;case"tfoot":c.push(t)}}),o(i,"thead"),o(u,"tbody"),o(c,"tfoot"),{newRows:e,newCells:r}}(c,t.grid());return e(c,t.grid(),f),o(c),fo(u,c,Hr,f),h.some({cursor:t.cursor,newRows:r(n.newRows),newCells:r(n.newCells)})})}},Do=function(t,n){return Hn(n.element()).bind(function(n){return To(t,n)})},Ao=function(t,n){var e=B(n.selection(),function(n){return Hn(n).bind(function(n){return To(t,n)})}),r=Kr(e);return 0<r.length?h.some({cells:r,generators:n.generators,clipboard:n.clipboard}):h.none()},Eo=function(t,n){var e=B(n.selection(),function(n){return Hn(n).bind(function(n){return To(t,n)})}),r=Kr(e);return 0<r.length?h.some(r):h.none()},Bo=function(t){return{is:function(n){return t===n},isValue:d,isError:s,getOr:r(t),getOrThunk:r(t),getOrDie:r(t),or:function(n){return Bo(t)},orThunk:function(n){return Bo(t)},fold:function(n,e){return e(t)},map:function(n){return Bo(n(t))},mapError:function(n){return Bo(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return h.some(t)}}},No=function(t){return{is:s,isValue:s,isError:d,getOr:o,getOrThunk:function(t){return t()},getOrDie:function(){return n=String(t),function(){throw new Error(n)}();var n},or:function(t){return t},orThunk:function(t){return t()},fold:function(n,e){return n(t)},map:function(n){return No(t)},mapError:function(n){return No(n(t))},each:e,bind:function(n){return No(t)},exists:s,forall:d,toOption:h.none}},ko={value:Bo,error:No,fromOption:function(t,n){return t.fold(function(){return No(n)},Bo)}},Po=function(t,n){return{rowDelta:0,colDelta:yo(t[0])-yo(n[0])}},Io=function(t,n){return B(t,function(){return xn(n.cell(),!0)})},Mo=function(t,n,e){return B(t,function(t){return ho(t,t.cells().concat(Io(Qr(0,n),e)))})},_o=function(t,n,e){var r=n.colDelta<0?Mo:o;return(n.rowDelta<0?function(t,n,e){return t.concat(function(t,n){for(var e=[],r=0;r<t;r++)e.push(n());return e}(n,function(n){return ho(t[t.length-1],Io(t[t.length-1].cells(),e))}))}:o)(r(t,Math.abs(n.colDelta),e),Math.abs(n.rowDelta),e)},Wo=function(t,n,e,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<yo(t[0]);u++){var c=e(wo(t[i],u),n);!0===c&&!1===o?po(t[i],u,xn(r(),!0)):!0===c&&(o=!1)}return t},jo=function(t,n,e,r,o){!function(t,n,e,r){if(0<n&&n<t.length){var o=t[n-1].cells(),i=(u=e,I(o,function(t,n){return E(t,function(t){return u(t.element(),n.element())})?t:t.concat([n])},[]));N(i,function(o){for(var i=h.none(),u=function(n){for(var u=function(u){var c=t[n].cells()[u];e(c.element(),o.element())&&(i.isNone()&&(i=h.some(r())),i.each(function(e){po(t[n],u,xn(e,!0))}))},c=0;c<yo(t[0]);c++)u(c)},c=n;c<t.length;c++)u(c)})}var u}(n,t,o,r.cell);var i=Po(e,n),u=_o(e,i,r),c=Po(n,u),a=_o(n,c,r);return a.slice(0,t).concat(u).concat(a.slice(t,a.length))},zo=function(t,n,e,r,o){var i=t.slice(0,n),u=t.slice(n),c=vo(t[e],function(e,i){return 0<n&&n<t.length&&r(wo(t[n-1],i),wo(t[n],i))?bo(t[n],i):xn(o(e.element(),r),!0)});return i.concat([c]).concat(u)},Lo=function(t,n,e,r,o){return B(t,function(t){var i,u,c,a,l,f,s,d=0<n&&n<yo(t)&&r(wo(t,n-1),wo(t,n))?bo(t,n):xn(o(wo(t,e),r),!0);return u=n,c=d,l=(a=(i=t).cells()).slice(0,u),f=a.slice(u),s=l.concat([c]).concat(f),ho(i,s)})},Fo=function(t,n,e,r){return B(t,function(t){return vo(t,function(t){return o=t,E(n,function(t){return e(o.element(),t.element())})?xn(r(t.element(),e),!0):t;var o})})},Ho=function(t,n,e,r){return void 0!==wo(t[n],e)&&0<n&&r(wo(t[n-1],e),wo(t[n],e))},qo=function(t,n,e){return 0<n&&e(wo(t,n-1),wo(t,n))},Uo=function(t,n,e,r){var o=j(t,function(r,o){return Ho(t,o,n,e)||qo(r,n,e)?[]:[bo(r,n)]});return Fo(t,o,e,r)},Vo=function(t,n,e,r){var o=t[n],i=j(o.cells(),function(r,i){return Ho(t,n,i,e)||qo(o,i,e)?[]:[r]});return Fo(t,i,e,r)},Ko=Xe([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Xo=Ct({},Ko),$o=function(t,n,e,r,o){var i=to(t),u=B(i,function(t){return t.map(n.edge)});return B(i,function(t,n){return t.filter(f(Mn)).fold(function(){var t=Zr(u,n);return r(t)},function(t){return e(t,o)})})},Go=function(t,n,e){return $o(t,n,yr,function(t){return t.fold(function(){return e.minCellWidth()},function(t){return t/e.pixelWidth()*100})},e)},Yo=function(t,n,e){return $o(t,n,Sr,function(t){return t.getOrThunk(e.minCellWidth)},e)},Jo=function(t,n){return e=n,r=xr,o=function(t){return t.getOrThunk(zn)},i=eo(t),u=B(i,function(t){return t.map(e.edge)}),B(i,function(t,n){return t.filter(f(_n)).fold(function(){var t=Zr(u,n);return o(t)},function(t){return r(t)})});var e,r,o,i,u},Qo=function(t,n,e){for(var r=0,o=t;o<n;o++)r+=void 0!==e[o]?e[o]:0;return r},Zo=function(t,n){var e=Zn(t);return B(e,function(t){var e=Qo(t.column(),t.column()+t.colspan(),n);return{element:t.element(),width:e,colspan:t.colspan()}})},ti=function(t){return{width:r(t),pixelWidth:r(t),getWidths:Yo,getCellDelta:o,singleColumnWidth:function(t,n){return[Math.max(jn(),t+n)-t]},minCellWidth:jn,setElementWidth:gr,setTableWidth:function(t,n,e){var r=P(n,function(t,n){return t+n},0);gr(t,r)}}},ni=function(t){return br(t).fold(function(){var n=ar(t);return ti(n)},function(n){return function(t,n){var e,o,i,u,c=Rr().exec(n);if(null!==c)return e=c[1],o=t,i=parseFloat(e),u=ar(o),{width:r(i),pixelWidth:r(u),getWidths:Go,getCellDelta:function(t){return t/u*100},singleColumnWidth:function(t,n){return[100-t]},minCellWidth:function(){return jn()/u*100},setElementWidth:pr,setTableWidth:function(t,n,e){pr(t,i+e/100*i)}};var a=Tr().exec(n);if(null!==a){var l=parseInt(a[1],10);return ti(l)}var f=ar(t);return ti(f)}(t,n)})},ei=function(t){return Gn(t)},ri=function(t){var n=Kn(t);return ei(n)},oi=function(t){return t.slice(0).sort()},ii=function(t,n){var e=k(n,function(n){return!A(t,n)});0<e.length&&function(t){throw new Error("Unsupported keys for object: "+oi(e).join(", "))}()},ui=function(t){return function(t,n,e){if(0===n.length)throw new Error("You must specify at least one required field.");var r;return function(t,n){if(!S(n))throw new Error("The "+t+" fields must be an array. Was: "+n+".");N(n,function(n){if(!y(n))throw new Error("The value "+n+" in the "+t+" fields was not a string.")})}("required",n),r=oi(n),M(r,function(t,n){return n<r.length-1&&t===r[n+1]}).each(function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+r.join(", ")+"].")}),function(r){var o=F(r);z(n,function(t){return A(o,t)})||function(t,e){throw new Error("All required keys ("+oi(n).join(", ")+") were not specified. Specified keys were: "+oi(e).join(", ")+".")}(0,o),t(n,o);var i=k(n,function(t){return!e.validate(r[t],t)});return 0<i.length&&function(t,n){throw new Error("All values need to be of type: "+n+". Keys ("+oi(t).join(", ")+") were not.")}(i,e.label),r}}(ii,t,{validate:C,label:"function"})},ci=ui(["cell","row","replace","gap"]),ai=function(t){var n=Pn(t,"colspan",1),e=Pn(t,"rowspan",1);return{element:r(t),colspan:r(n),rowspan:r(e)}},li=function(t,e){void 0===e&&(e=ai),ci(t);var r=n(h.none()),o=function(n){var o=function(n){var r;return r=e(n),t.cell(r)}(n);return r.get().isNone()&&r.set(h.some(o)),i=h.some({item:n,replacement:o}),o},i=h.none();return{getOrInit:function(t,n){return i.fold(function(){return o(t)},function(e){return n(t,e.item)?e.replacement:o(t)})},cursor:r.get}},fi=function(t,e){return function(r){var o=n(h.none());ci(r);var i=[],u=function(n){var u={scope:t},c=r.replace(n,e,u);return i.push({item:n,sub:c}),o.get().isNone()&&o.set(h.some(c)),c};return{replaceOrInit:function(t,n){return e=t,r=n,M(i,function(t){return r(t.item,e)}).fold(function(){return u(t)},function(e){return n(t,e.item)?e.sub:u(t)});var e,r},cursor:o.get}}},si=function(t){ci(t);var e=n(h.none());return{combine:function(n){return e.get().isNone()&&e.set(h.some(n)),function(){var e=t.cell({element:r(n),colspan:r(1),rowspan:r(1)});return xt(e,"width"),xt(n,"width"),e}},cursor:e.get}},di=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],mi=Ae(),gi=function(t){return n=t,e=mi.property().name(n),A(di,e);var n,e},pi=function(t){return n=t,e=mi.property().name(n),A(["ol","ul"],e);var n,e},hi=function(t){var n,e=function(t){return"br"===$(t)},r=function(t){return le(t).bind(function(n){var r=cn(n).map(function(t){return!!gi(t)||!!function(t){return n=t,A(["br","img","hr","input"],mi.property().name(n));var n}(t)&&"img"!==$(t)}).getOr(!1);return rn(n).map(function(o){return!0===r||"li"===$(i=o)||An(i,pi).isSome()||e(n)||gi(o)&&!Zt(t,o)?[]:[gt.fromTag("br")];var i})}).getOr([])},o=0===(n=j(t,function(t){var n=an(t);return z(n,function(t){return e(t)||Z(t)&&0===ee(t).trim().length})?[]:n.concat(r(t))})).length?[gt.fromTag("br")]:n;vn(t[0]),hn(t[0],o)},vi=function(t){0===qn(t).length&&bn(t)},bi=function(t,n){return{grid:r(t),cursor:r(n)}},wi=function(t,n,e){return yi(t,n,e).orThunk(function(){return yi(t,0,0)})},yi=function(t,n,e){return h.from(t[n]).bind(function(t){return h.from(t.cells()[e]).bind(function(t){return h.from(t.element())})})},Si=function(t,n,e){return bi(t,yi(t,n,e))},xi=function(t){return I(t,function(t,n){return E(t,function(t){return t.row()===n.row()})?t:t.concat([n])},[]).sort(function(t,n){return t.row()-n.row()})},Ci=function(t){return I(t,function(t,n){return E(t,function(t){return t.column()===n.column()})?t:t.concat([n])},[]).sort(function(t,n){return t.column()-n.column()})},Ri=function(t,n,e){var r,o=(r=e,B(t,function(t){var n=B(qn(t),function(t){var n=Pn(t,"rowspan",1),e=Pn(t,"colspan",1);return yn(t,n,e)});return Sn(t,n,r.section())})),i=Gn(o);return Co(i,n,!0)},Ti=function(t,n,e){var r=ni(t),o=ei(n),i=r.getWidths(o,e,r),u=Zo(o,i);N(u,function(t){r.setElementWidth(t.element,t.width)}),0<u.length&&r.setTableWidth(t,i,r.getCellDelta(0))},Oi=Oo(function(t,n,e,r){var o=n[0].row(),i=n[0].row(),u=xi(n),c=I(u,function(t,n){return zo(t,i,o,e,r.getOrInit)},t);return Si(c,i,n[0].column())},Eo,e,e,li),Di=Oo(function(t,n,e,r){var o=xi(n),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),c=I(o,function(t,n){return zo(t,u,i,e,r.getOrInit)},t);return Si(c,u,n[0].column())},Eo,e,e,li),Ai=Oo(function(t,n,e,r){var o=Ci(n),i=o[0].column(),u=o[0].column(),c=I(o,function(t,n){return Lo(t,u,i,e,r.getOrInit)},t);return Si(c,n[0].row(),u)},Eo,Ti,e,li),Ei=Oo(function(t,n,e,r){var o=n[n.length-1].column(),i=n[n.length-1].column()+n[n.length-1].colspan(),u=Ci(n),c=I(u,function(t,n){return Lo(t,i,o,e,r.getOrInit)},t);return Si(c,n[0].row(),i)},Eo,Ti,e,li),Bi=Oo(function(t,n,e,r){var o,i,u,c,a=Ci(n),l=(o=t,i=a[0].column(),u=a[a.length-1].column(),c=B(o,function(t){var n=t.cells().slice(0,i).concat(t.cells().slice(u+1));return Cn(n,t.section())}),k(c,function(t){return 0<t.cells().length})),f=wi(l,n[0].row(),n[0].column());return bi(l,f)},Eo,Ti,vi,li),Ni=Oo(function(t,n,e,r){var o,i,u,c=xi(n),a=(o=t,i=c[0].row(),u=c[c.length-1].row(),o.slice(0,i).concat(o.slice(u+1))),l=wi(a,n[0].row(),n[0].column());return bi(a,l)},Eo,e,vi,li),ki=(Oo(function(t,n,e,r){var o=Uo(t,n.column(),e,r.replaceOrInit);return Si(o,n.row(),n.column())},Do,e,e,fi("row","th")),Oo(function(t,n,e,r){var o=Uo(t,n.column(),e,r.replaceOrInit);return Si(o,n.row(),n.column())},Do,e,e,fi(null,"td")),Oo(function(t,n,e,r){var o=Vo(t,n.row(),e,r.replaceOrInit);return Si(o,n.row(),n.column())},Do,e,e,fi("col","th")),Oo(function(t,n,e,r){var o=Vo(t,n.row(),e,r.replaceOrInit);return Si(o,n.row(),n.column())},Do,e,e,fi(null,"td")),Oo(function(t,n,e,o){var i=n.cells();hi(i);var u=function(t,n,e){if(0===t.length)return t;for(var r=n.startRow();r<=n.finishRow();r++)for(var o=n.startCol();o<=n.finishCol();o++)po(t[r],o,xn(e(),!1));return t}(t,n.bounds(),r(i[0]));return bi(u,h.from(i[0]))},function(t,n){return n.mergable()},e,e,si)),Pi=Oo(function(t,n,e,r){var o=P(n,function(t,n){return Wo(t,n,e,r.combine(n))},t);return bi(o,h.from(n[0]))},function(t,n){return n.unmergable()},Ti,e,si),Ii=Oo(function(t,n,e,o){var u,c,a,l,f,s,d=(u=n.clipboard(),c=n.generators(),a=Kn(u),l=Gn(a),Co(l,c,!0));return function(t,n,e,r,o){return function(t,n,e){if(t.row()>=n.length||t.column()>yo(n[0]))return ko.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=n.slice(t.row()),o=r[0].cells().slice(t.column()),i=yo(e[0]),u=e.length;return ko.value({rowDelta:r.length-u,colDelta:o.length-i})}(t,n,e).map(function(u){var c=_o(n,u,r);return function(t,n,e,r,o){for(var u,c,a,l,f,s=t.row(),d=t.column(),m=s+e.length,g=d+yo(e[0]),p=s;p<m;p++)for(var h=d;h<g;h++){a=h,f=l=void 0,l=i(o,bo((u=n)[c=p],a).element()),f=u[c],1<u.length&&1<yo(f)&&(0<a&&l(wo(f,a-1))||a<f.cells().length-1&&l(wo(f,a+1))||0<c&&l(wo(u[c-1],a))||c<u.length-1&&l(wo(u[c+1],a)))&&Wo(n,wo(n[p],h),o,r.cell);var v=wo(e[p-s],h-d),b=r.replace(v);po(n[p],h,xn(b,!0))}return n}(t,c,e,r,o)})}((f=n.row(),s=n.column(),{row:r(f),column:r(s)}),t,d,n.generators(),e).fold(function(){return bi(t,h.some(n.element()))},function(t){var e=wi(t,n.row(),n.column());return bi(t,e)})},function(t,n){return Hn(n.element()).bind(function(e){return To(t,e).map(function(t){return Ct(Ct({},t),{generators:n.generators,clipboard:n.clipboard})})})},Ti,e,li),Mi=Oo(function(t,n,e,r){var o=t[n.cells[0].row()],i=n.cells[0].row(),u=Ri(n.clipboard(),n.generators(),o),c=jo(i,t,u,n.generators(),e),a=wi(c,n.cells[0].row(),n.cells[0].column());return bi(c,a)},Ao,e,e,li),_i=Oo(function(t,n,e,r){var o=t[n.cells[0].row()],i=n.cells[n.cells.length-1].row()+n.cells[n.cells.length-1].rowspan(),u=Ri(n.clipboard(),n.generators(),o),c=jo(i,t,u,n.generators(),e),a=wi(c,n.cells[0].row(),n.cells[0].column());return bi(c,a)},Ao,e,e,li),Wi=function(t){return gt.fromDom(t.getBody())},ji=function(t){return t.getBoundingClientRect().width},zi=function(t){return t.getBoundingClientRect().height},Li=function(t){return function(n){return Zt(n,Wi(t))}},Fi=function(t){return/^[0-9]+$/.test(t)&&(t+="px"),t},Hi=function(t){var n=On(t,"td[data-mce-style],th[data-mce-style]");ut(t,"data-mce-style"),N(n,function(t){ut(t,"data-mce-style")})},qi={isRtl:r(!1)},Ui={isRtl:r(!0)},Vi=function(t){return"rtl"==("rtl"===wt(t,"direction")?"rtl":"ltr")?Ui:qi},Ki={"border-collapse":"collapse",width:"100%"},Xi={border:"1"},$i=function(t){return t.getParam("table_default_attributes",Xi,"object")},Gi=function(t){return t.getParam("table_default_styles",Ki,"object")},Yi=function(t){return t.getParam("table_tab_navigation",!0,"boolean")},Ji=function(t){return t.getParam("table_cell_advtab",!0,"boolean")},Qi=function(t){return t.getParam("table_row_advtab",!0,"boolean")},Zi=function(t){return t.getParam("table_advtab",!0,"boolean")},tu=function(t){return t.getParam("table_style_by_css",!1,"boolean")},nu=function(t){return t.getParam("table_class_list",[],"array")},eu=function(t){return!1===t.getParam("table_responsive_width")},ru=function(t){var n=t.getParam("table_clone_elements");return y(n)?h.some(n.split(/[ ,]/)):Array.isArray(n)?h.some(n):h.none()},ou=function(t,n){return t.fire("newrow",{node:n})},iu=function(t,n){return t.fire("newcell",{node:n})},uu=function(t,n,e,r,o){t.fire("TableSelectionChange",{cells:n,start:e,finish:r,otherCells:o})},cu=function(t){t.fire("TableSelectionClear")},au=function(t,n){return{element:r(t),offset:r(n)}},lu=function(t,n,e){return t.property().isText(n)&&0===t.property().getText(n).trim().length||t.property().isComment(n)?e(n).bind(function(n){return lu(t,n,e).orThunk(function(){return h.some(n)})}):h.none()},fu=function(t,n){return t.property().isText(n)?t.property().getText(n).length:t.property().children(n).length},su=function(t,n){var e=lu(t,n,t.query().prevSibling).getOr(n);if(t.property().isText(e))return au(e,fu(t,e));var r=t.property().children(e);return 0<r.length?su(t,r[r.length-1]):au(e,fu(t,e))},du=su,mu=Ae(),gu=function(t,n){var r=function(t){return"table"===$(Wi(t))},o=ru(t),i=function(n,e,r,i){return function(u,c){Hi(u);var a=i(),l=gt.fromDom(t.getDoc()),f=Ur(Vi),s=be(r,l,o);return e(u)?n(a,u,c,s,f).bind(function(n){return N(n.newRows(),function(n){ou(t,n.dom())}),N(n.newCells(),function(n){iu(t,n.dom())}),n.cursor().map(function(n){var e=du(mu,n),r=t.dom.createRng();return r.setStart(e.element().dom(),e.offset()),r.setEnd(e.element().dom(),e.offset()),r})}):h.none()}};return{deleteRow:i(Ni,function(n){var e=Vr(n);return!1===r(t)||1<e.rows()},e,n),deleteColumn:i(Bi,function(n){var e=Vr(n);return!1===r(t)||1<e.columns()},e,n),insertRowsBefore:i(Oi,d,e,n),insertRowsAfter:i(Di,d,e,n),insertColumnsBefore:i(Ai,d,Or,n),insertColumnsAfter:i(Ei,d,Or,n),mergeCells:i(ki,d,e,n),unmergeCells:i(Pi,d,e,n),pasteRowsBefore:i(Mi,d,e,n),pasteRowsAfter:i(_i,d,e,n),pasteCells:i(Ii,d,e,n)}},pu=tinymce.util.Tools.resolve("tinymce.util.Tools"),hu=function(t){return function(n){return h.from(n.dom.getParent(n.selection.getStart(),t)).map(gt.fromDom)}},vu=hu("th,td"),bu=hu("th,td,caption"),wu=function(t,n,e){var r;return function(n,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],e);if(void 0===n&&(n=i),n!==i)return""}return n}(r,t.select("td,th",n))},yu=function(t,n,e){e&&t.formatter.apply("align"+e,{},n)},Su=function(t,n,e){e&&t.formatter.apply("valign"+e,{},n)},xu=function(t,n){pu.each("left center right".split(" "),function(e){t.formatter.remove("align"+e,{},n)})},Cu=function(t,n,e){var r=function(t,e){return e=e||[],pu.each(t,function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,n&&n(o)),e.push(o)}),e};return r(t,e||[])},Ru=function(t,n){var e=function(n){return ft(n,"rgb")?t.toHex(n):n};return{borderwidth:St(gt.fromDom(n),"border-width").getOr(""),borderstyle:St(gt.fromDom(n),"border-style").getOr(""),bordercolor:St(gt.fromDom(n),"border-color").map(e).getOr(""),backgroundcolor:St(gt.fromDom(n),"background-color").map(e).getOr("")}},Tu=function(t){var n=t[0],e=t.slice(1),r=F(n);return N(e,function(t){N(r,function(e){q(t,function(t,r){var o=n[e];""!==o&&e===r&&o!==t&&(n[e]="")})})}),n},Ou=function(t){var n=[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===t?[{name:"borderwidth",type:"input",label:"Border width"}].concat(n):n}},Du=function(t,n,e,r,o){var i={};return pu.each(t.split(" "),function(t){r.formatter.matchNode(o,n+t)&&(i[e]=t)}),i[e]||(i[e]=""),i},Au=i(Du,"left center right"),Eu=i(Du,"top middle bottom"),Bu=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"selectbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"selectbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"selectbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"selectbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],Nu=function(t){return e=(n=t).getParam("table_cell_class_list",[],"array"),r=Cu(e,function(t){t.value&&(t.textStyle=function(){return n.formatter.getCssText({block:"tr",classes:[t.value]})})}),(0<e.length?h.some({name:"class",type:"selectbox",label:"Class",items:r}):h.none()).fold(function(){return Bu},function(t){return Bu.concat(t)});var n,e,r},ku={normal:function(t,n){return{setAttrib:function(e,r){t.setAttrib(n,e,r)},setStyle:function(e,r){t.setStyle(n,e,r)}}},ifTruthy:function(t,n){return{setAttrib:function(e,r){r&&t.setAttrib(n,e,r)},setStyle:function(e,r){r&&t.setStyle(n,e,r)}}}},Pu=function(t,n){t.setAttrib("scope",n.scope),t.setAttrib("class",n.class),t.setStyle("width",Fi(n.width)),t.setStyle("height",Fi(n.height))},Iu=function(t,n){t.setStyle("background-color",n.backgroundcolor),t.setStyle("border-color",n.bordercolor),t.setStyle("border-style",n.borderstyle),t.setStyle("border-width",Fi(n.borderwidth))},Mu=function(t,n,e){var r=e.getData();e.close(),t.undoManager.transact(function(){(1===n.length?function(t,n,e){var r,o,i=t.dom,u=e.celltype&&n[0].nodeName.toLowerCase()!==e.celltype?i.rename(n[0],e.celltype):n[0],c=ku.normal(i,u);Pu(c,e),Ji(t)&&Iu(c,e),xu(t,u),r=t,o=u,pu.each("top middle bottom".split(" "),function(t){r.formatter.remove("valign"+t,{},o)}),e.halign&&yu(t,u,e.halign),e.valign&&Su(t,u,e.valign)}:function(t,n,e){var r=t.dom;pu.each(n,function(n){e.celltype&&n.nodeName.toLowerCase()!==e.celltype&&(n=r.rename(n,e.celltype));var o=ku.ifTruthy(r,n);Pu(o,e),Ji(t)&&Iu(o,e),e.halign&&yu(t,n,e.halign),e.valign&&Su(t,n,e.valign)})})(t,n,r),t.focus()})},_u=function(t){var n,e=[];if(e=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),n=t.dom.getParent(t.selection.getStart(),"td,th"),!e.length&&n&&e.push(n),n=n||e[0]){var r=pu.map(e,function(n){return r=n,o=Ji(e=t),i=e.dom,Ct(Ct(Ct({width:i.getStyle(r,"width")||i.getAttrib(r,"width"),height:i.getStyle(r,"height")||i.getAttrib(r,"height"),scope:i.getAttrib(r,"scope"),celltype:r.nodeName.toLowerCase(),class:i.getAttrib(r,"class","")},Au("align","halign",e,r)),Eu("valign","valign",e,r)),o?Ru(i,r):{});var e,r,o,i}),o=Tu(r),u={type:"tabpanel",tabs:[{title:"General",name:"general",items:Nu(t)},Ou("cell")]},c={type:"panel",items:[{type:"grid",columns:2,items:Nu(t)}]};t.windowManager.open({title:"Cell Properties",size:"normal",body:Ji(t)?u:c,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:i(Mu,t,e)})}},Wu=[{type:"selectbox",name:"type",label:"Row type",items:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],ju=function(t){return e=(n=t).getParam("table_row_class_list",[],"array"),r=Cu(e,function(t){t.value&&(t.textStyle=function(){return n.formatter.getCssText({block:"tr",classes:[t.value]})})}),(0<e.length?h.some({name:"class",type:"selectbox",label:"Class",items:r}):h.none()).fold(function(){return Wu},function(t){return Wu.concat(t)});var n,e,r},zu=function(t,n,e,r){var o=t.dom,i=r.getData();r.close();var u=1===n.length?ku.normal:ku.ifTruthy;t.undoManager.transact(function(){pu.each(n,function(n){var r,c,a,l,f,s;i.type!==n.parentNode.nodeName.toLowerCase()&&(r=t.dom,c=n,a=i.type,l=r.getParent(c,"table"),f=c.parentNode,(s=r.select(a,l)[0])||(s=r.create(a),l.firstChild?"CAPTION"===l.firstChild.nodeName?r.insertAfter(s,l.firstChild):l.insertBefore(s,l.firstChild):l.appendChild(s)),"tbody"===a&&"THEAD"===f.nodeName&&s.firstChild?s.insertBefore(c,s.firstChild):s.appendChild(c),f.hasChildNodes()||r.remove(f));var d,m,g=u(o,n);g.setAttrib("scope",i.scope),g.setAttrib("class",i.class),g.setStyle("height",Fi(i.height)),Qi(t)&&(m=i,(d=g).setStyle("background-color",m.backgroundcolor),d.setStyle("border-color",m.bordercolor),d.setStyle("border-style",m.borderstyle)),i.align!==e.align&&(xu(t,n),yu(t,n,i.align))}),t.focus()})},Lu=function(t){var n,e,r=t.dom,o=[];if((n=r.getParent(t.selection.getStart(),"table"))&&(e=r.getParent(t.selection.getStart(),"td,th"),pu.each(n.rows,function(t){pu.each(t.cells,function(n){if((r.getAttrib(n,"data-mce-selected")||n===e)&&o.indexOf(t)<0)return o.push(t),!1})}),o[0])){var u=pu.map(o,function(n){return r=n,o=Qi(e=t),i=e.dom,Ct(Ct({height:i.getStyle(r,"height")||i.getAttrib(r,"height"),scope:i.getAttrib(r,"scope"),class:i.getAttrib(r,"class",""),align:"",type:r.parentNode.nodeName.toLowerCase()},Au("align","align",e,r)),o?Ru(i,r):{});var e,r,o,i}),c=Tu(u),a={type:"tabpanel",tabs:[{title:"General",name:"general",items:ju(t)},Ou("row")]},l={type:"panel",items:[{type:"grid",columns:2,items:ju(t)}]};t.windowManager.open({title:"Row Properties",size:"normal",body:Qi(t)?a:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:c,onSubmit:i(zu,t,o,c)})}},Fu=tinymce.util.Tools.resolve("tinymce.Env"),Hu={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},qu=function(t,n){t.selection.select(n.dom(),!0),t.selection.collapse(!0)},Uu=function(t,n,e){var r,o=Gi(t),u=function(t,n,e,r,o){void 0===o&&(o=Hu);var i=gt.fromTag("table");bt(i,o.styles),et(i,o.attributes);var u=gt.fromTag("tbody");mn(i,u);for(var c=[],a=0;a<t;a++){for(var l=gt.fromTag("tr"),f=0;f<n;f++){var s=a<e||f<r?gt.fromTag("th"):gt.fromTag("td");f<r&&nt(s,"scope","row"),a<e&&nt(s,"scope","col"),mn(s,gt.fromTag("br")),o.percentages&&vt(s,"width",100/n+"%"),mn(l,s)}c.push(l)}return hn(u,c),i}(e,n,0,0,{styles:o,attributes:$i(t),percentages:(r=o.width,y(r)&&-1!==r.indexOf("%")&&!eu(t))});nt(u,"data-mce-id","__mce");var c,a,l,f=(c=u,a=gt.fromTag("div"),l=gt.fromDom(c.dom().cloneNode(!0)),mn(a,l),a.dom().innerHTML);return t.insertContent(f),Nn(Wi(t),'table[data-mce-id="__mce"]').map(function(n){var e,r;return eu(t)&&vt(n,"width",wt(n,"width")),ut(n,"data-mce-id"),e=t,N(On(n,"tr"),function(t){ou(e,t.dom()),N(On(t,"th,td"),function(t){iu(e,t.dom())})}),r=t,Nn(n,"td,th").each(i(qu,r)),n.dom()}).getOr(null)},Vu=function(t,n,e,r){if("TD"===n.tagName||"TH"===n.tagName)y(e)?t.setStyle(n,e,r):t.setStyle(n,e);else if(n.children)for(var o=0;o<n.children.length;o++)Vu(t,n.children[o],e,r)},Ku=function(t,n,e){var r,o=t.dom,i=e.getData();e.close(),""===i.class&&delete i.class,t.undoManager.transact(function(){if(!n){var e=parseInt(i.cols,10)||1,u=parseInt(i.rows,10)||1;n=Uu(t,e,u)}!function(t,n,e){var r,o=t.dom,i={},u={};if(i.class=e.class,u.height=Fi(e.height),o.getAttrib(n,"width")&&!tu(t)?i.width=(r=e.width)?r.replace(/px$/,""):"":u.width=Fi(e.width),tu(t)?(u["border-width"]=Fi(e.border),u["border-spacing"]=Fi(e.cellspacing)):(i.border=e.border,i.cellpadding=e.cellpadding,i.cellspacing=e.cellspacing),tu(t)&&n.children)for(var c=0;c<n.children.length;c++)Vu(o,n.children[c],{"border-width":Fi(e.border),padding:Fi(e.cellpadding)}),Zi(t)&&Vu(o,n.children[c],{"border-color":e.bordercolor});Zi(t)&&(u["background-color"]=e.backgroundcolor,u["border-color"]=e.bordercolor,u["border-style"]=e.borderstyle),i.style=o.serializeStyle(Ct(Ct({},Gi(t)),u)),o.setAttribs(n,Ct(Ct({},$i(t)),i))}(t,n,i),(r=o.select("caption",n)[0])&&!i.caption&&o.remove(r),!r&&i.caption&&((r=o.create("caption")).innerHTML=Fu.ie?"Â ":'<br data-mce-bogus="1"/>',n.insertBefore(r,n.firstChild)),""===i.align?xu(t,n):yu(t,n,i.align),t.focus(),t.addVisual()})},Xu=function(t,n){var e,r,o,u,c,a,l,f,s=t.dom,d=function(t,n){var e,r,o,i,u,c,a,l,f=Gi(t),s=$i(t),d=t.dom,m=n?(e=d,r=function(t){return ft(t,"rgb")?e.toHex(t):t},o=K(f,"border-style").getOr(""),i=K(f,"border-color").getOr(""),u=K(f,"background-color").getOr(""),{borderstyle:o,bordercolor:r(i),backgroundcolor:r(u)}):{};return Ct(Ct(Ct(Ct(Ct(Ct({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),f),s),m),(l=f["border-width"],tu(t)&&l?{border:l}:K(s,"border").fold(function(){return{}},function(t){return{border:t}}))),(c=K(f,"border-spacing").or(K(s,"cellspacing")).fold(function(){return{}},function(t){return{cellspacing:t}}),a=K(f,"border-padding").or(K(s,"cellpadding")).fold(function(){return{}},function(t){return{cellpadding:t}}),Ct(Ct({},c),a)))}(t,Zi(t));!1===n?(e=s.getParent(t.selection.getStart(),"table"))?(o=e,u=Zi(r=t),f=r.dom,d=Ct(Ct({width:f.getStyle(o,"width")||f.getAttrib(o,"width"),height:f.getStyle(o,"height")||f.getAttrib(o,"height"),cellspacing:f.getStyle(o,"border-spacing")||f.getAttrib(o,"cellspacing"),cellpadding:f.getAttrib(o,"cellpadding")||wu(r.dom,o,"padding"),border:(c=f,a=o,l=St(gt.fromDom(a),"border-width"),tu(r)&&l.isSome()?l.getOr(""):c.getAttrib(a,"border")||wu(r.dom,a,"border-width")||wu(r.dom,a,"border")),caption:!!f.select("caption",o)[0],class:f.getAttrib(o,"class","")},Au("align","align",r,o)),u?Ru(f,o):{})):Zi(t)&&(d.borderstyle="",d.bordercolor="",d.backgroundcolor=""):(d.cols="1",d.rows="1",Zi(t)&&(d.borderstyle="",d.bordercolor="",d.backgroundcolor=""));var m=0<nu(t).length;m&&d.class&&(d.class=d.class.replace(/\s*mce\-item\-table\s*/g,""));var g,p,h,v,b,w={type:"grid",columns:2,items:(p=m,h=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],v=(g=t).getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],b=p?[{type:"selectbox",name:"class",label:"Class",items:Cu(nu(g),function(t){t.value&&(t.textStyle=function(){return g.formatter.getCssText({block:"table",classes:[t.value]})})})}]:[],h.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(v).concat([{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(b))},y=Zi(t)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[w]},Ou("table")]}:{type:"panel",items:[w]};t.windowManager.open({title:"Table Properties",size:"normal",body:y,onSubmit:i(Ku,t,e),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:d})},$u=pu.each,Gu=function(t,n,o,u,c){var a=Li(t),l=function(t){return Vn(t,a)},s=function(n){vu(t).each(function(e){l(e).each(function(r){var i=nr(u,r,e);n(r,i).each(function(n){t.selection.setRng(n),t.focus(),o.clear(r),Hi(r)})})})},d=function(n){return vu(t).map(function(n){return l(n).bind(function(r){var o=gt.fromDom(t.getDoc());return function(t,n,e){var r=Kn(t),o=Gn(r);return Eo(o,n).map(function(t){var n=Co(o,e,!1).slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),r=Ro(n,e);return B(r,function(t){var n=de(t.element());return N(t.cells(),function(t){var e=me(t.element());Xr(e,"colspan",t.colspan(),1),Xr(e,"rowspan",t.rowspan(),1),mn(n,e)}),n})})}(r,nr(u,r,n),be(e,o,h.none()))})})},m=function(n){c.get().each(function(e){var i=B(e,function(t){return me(t)});vu(t).each(function(e){l(e).each(function(c){var a,l,f,s,d=gt.fromDom(t.getDoc()),m=we(d),g=(a=u,f=i,s=m,{element:r(l=e),mergable:h.none,unmergable:h.none,selection:r(Ze(l,a)),clipboard:r(f),generators:r(s)});n(c,g).each(function(n){t.selection.setRng(n),t.focus(),o.clear(c)})})})})};$u({mceTableSplitCells:function(){s(n.unmergeCells)},mceTableMergeCells:function(){s(n.mergeCells)},mceTableInsertRowBefore:function(){s(n.insertRowsBefore)},mceTableInsertRowAfter:function(){s(n.insertRowsAfter)},mceTableInsertColBefore:function(){s(n.insertColumnsBefore)},mceTableInsertColAfter:function(){s(n.insertColumnsAfter)},mceTableDeleteCol:function(){s(n.deleteColumn)},mceTableDeleteRow:function(){s(n.deleteRow)},mceTableCutRow:function(t){d().each(function(t){c.set(t),s(n.deleteRow)})},mceTableCopyRow:function(t){d().each(function(t){c.set(t)})},mceTablePasteRowBefore:function(t){m(n.pasteRowsBefore)},mceTablePasteRowAfter:function(t){m(n.pasteRowsAfter)},mceTableDelete:function(){bu(t).each(function(n){Vn(n,a).filter(f(a)).each(function(n){var e=gt.fromText("");if(sn(n,e),bn(n),t.dom.isEmpty(t.getBody()))t.setContent(""),t.selection.setCursorLocation();else{var r=t.dom.createRng();r.setStart(e.dom(),0),r.setEnd(e.dom(),0),t.selection.setRng(r),t.nodeChanged()}})})}},function(n,e){t.addCommand(e,n)}),$u({mceInsertTable:i(Xu,t,!0),mceTableProps:i(Xu,t,!1),mceTableRowProps:i(Lu,t),mceTableCellProps:i(_u,t)},function(n,e){t.addCommand(e,function(){n()})})},Yu=function(t){var n=h.from(t.dom().documentElement).map(gt.fromDom).getOr(t);return{parent:r(n),view:r(t),origin:r(Ar(0,0))}},Ju=function(t){var n=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(t.length!==n.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+n.length+" arguments");var o={};return N(t,function(t,e){o[t]=r(n[e])}),o}}.apply(null,t),e=[];return{bind:function(t){if(void 0===t)throw new Error("Event bind error: undefined handler");e.push(t)},unbind:function(t){e=k(e,function(n){return n!==t})},trigger:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=n.apply(null,t);N(e,function(t){t(o)})}}},Qu=function(t){return{registry:U(t,function(t){return{bind:t.bind,unbind:t.unbind}}),trigger:U(t,function(t){return t.trigger})}},Zu=function(t){var n,e,o,i,u,c=gt.fromDom(t.target),a=function(){return t.stopPropagation()},l=function(){return t.preventDefault()},f=(n=l,e=a,function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return n(e.apply(null,t))});return o=c,i=t.clientX,u=t.clientY,{target:r(o),x:r(i),y:r(u),stop:a,prevent:l,kill:f,raw:r(t)}},tc=function(t,n,e,r){t.dom().removeEventListener(n,e,r)},nc=r(!0),ec=function(t,n,e){return function(t,n,e,r,o){var u,c,a=(u=e,c=r,function(t){u(t)&&c(Zu(t))});return t.dom().addEventListener(n,a,o),{unbind:i(tc,t,n,a,o)}}(t,n,nc,e,!1)},rc=Zu,oc=ro("ephox-dragster").resolve,ic=ui(["compare","extract","mutate","sink"]),uc=ui(["element","start","stop","destroy"]),cc=ui(["forceDrop","drop","move","delayDrop"]),ac=ic({compare:function(t,n){return Ar(n.left()-t.left(),n.top()-t.top())},extract:function(t){return h.some(Ar(t.x(),t.y()))},sink:function(t,n){var e=function(t){var n=Ct({layerClass:oc("blocker")},t),e=gt.fromTag("div");return nt(e,"role","presentation"),bt(e,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Yr(e,oc("blocker")),Yr(e,n.layerClass),{element:function(){return e},destroy:function(){bn(e)}}}(n),r=ec(e.element(),"mousedown",t.forceDrop),o=ec(e.element(),"mouseup",t.drop),i=ec(e.element(),"mousemove",t.move),u=ec(e.element(),"mouseout",t.delayDrop);return uc({element:e.element,start:function(t){mn(t,e.element())},stop:function(){bn(e.element())},destroy:function(){e.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(t,n){t.mutate(n.left(),n.top())}});function lc(){var t,n,r={onEvent:e,reset:e},o=(t=h.none(),{onEvent:function(e,r){r.extract(e).each(function(e){var o,i,u;(o=r,i=e,u=t.map(function(t){return o.compare(t,i)}),t=h.some(i),u).each(function(t){n.trigger.move(t)})})},reset:function(){t=h.none()},events:(n=Qu({move:Ju(["info"])})).registry}),i=r;return{on:function(){i.reset(),i=o},off:function(){i.reset(),i=r},isOn:function(){return i===o},onEvent:function(t,n){i.onEvent(t,n)},events:o.events}}var fc=function(t){return"true"===rt(t,"contenteditable")},sc=oo("resizer-bar-dragging"),dc=function(n,e,r){var o=function(){var t,n=Qu({drag:Ju(["xDelta","yDelta","target"])}),e=h.none(),r={mutate:function(n,e){t.trigger.drag(n,e)},events:(t=Qu({drag:Ju(["xDelta","yDelta"])})).registry};return r.events.drag.bind(function(t){e.each(function(e){n.trigger.drag(t.xDelta(),t.yDelta(),e)})}),{assign:function(t){e=h.some(t)},get:function(){return e},mutate:r.mutate,events:n.registry}}(),u=function(n,e){return void 0===e&&(e={}),function(n,e,r){var o,i,u=!1,c=Qu({start:Ju([]),stop:Ju([])}),a=lc(),l=function(){d.stop(),a.isOn()&&(a.off(),c.trigger.stop())},f=(o=l,i=null,{cancel:function(){null!==i&&(t.clearTimeout(i),i=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null!==i&&t.clearTimeout(i),i=t.setTimeout(function(){o.apply(null,n),i=null},200)}});a.events.move.bind(function(t){e.mutate(n,t.info())});var s=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];u&&t.apply(null,n)}},d=e.sink(cc({forceDrop:l,drop:s(l),move:s(function(t){f.cancel(),a.onEvent(t,e)}),delayDrop:s(f.throttle)}),r);return{element:d.element,go:function(t){d.start(t),a.on(),c.trigger.start()},on:function(){u=!0},off:function(){u=!1},destroy:function(){d.destroy()},events:c.registry}}(n,void 0!==e.mode?e.mode:ac,e)}(o,{}),c=h.none(),a=function(t,n){return h.from(rt(t,n))};o.events.drag.bind(function(t){a(t.target(),"data-row").each(function(n){var e=Wn(t.target(),"top");vt(t.target(),"top",e+t.yDelta()+"px")}),a(t.target(),"data-column").each(function(n){var e=Wn(t.target(),"left");vt(t.target(),"left",e+t.xDelta()+"px")})});var l=function(t,n){return Wn(t,n)-Pn(t,"data-initial-"+n,0)};u.events.stop.bind(function(){o.get().each(function(t){c.each(function(o){a(t,"data-row").each(function(n){var e=l(t,"top");ut(t,"data-initial-top"),g.trigger.adjustHeight(o,e,parseInt(n,10))}),a(t,"data-column").each(function(n){var e=l(t,"left");ut(t,"data-initial-left"),g.trigger.adjustWidth(o,e,parseInt(n,10))}),fo(n,o,r,e)})})});var f=function(t,e){g.trigger.startAdjust(),o.assign(t),nt(t,"data-initial-"+e,Wn(t,e)),Yr(t,sc),vt(t,"opacity","0.2"),u.go(n.parent())},s=ec(n.parent(),"mousedown",function(t){var n,e;n=t.target(),Jr(n,uo)&&f(t.target(),"top"),e=t.target(),Jr(e,co)&&f(t.target(),"left")}),d=function(t){return Zt(t,n.view())},m=ec(n.view(),"mouseover",function(t){(function(t){return kn(t,"table",d).filter(function(t){return kn(t,"[contenteditable]",d).exists(fc)})})(t.target()).fold(function(){pt(t.target())&&ao(n)},function(t){c=h.some(t),fo(n,t,r,e)})}),g=Qu({adjustHeight:Ju(["table","delta","row"]),adjustWidth:Ju(["table","delta","column"]),startAdjust:Ju([])});return{destroy:function(){s.unbind(),m.unbind(),u.destroy(),ao(n)},refresh:function(t){fo(n,t,r,e)},on:u.on,off:u.off,hideBars:i(mo,n),showBars:i(go,n),events:g.registry}},mc=function(t,n){var e=Hr,o=dc(t,n,e),i=Qu({beforeResize:Ju(["table"]),afterResize:Ju(["table"]),startDrag:Ju([])});return o.events.adjustHeight.bind(function(t){i.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());(function(t,n,e,o){var i,u,c,a=ri(t),l=Jo(a,o),f=B(l,function(t,r){return e===r?Math.max(n+t,zn()):t}),s=(i=f,u=Zn(a),B(u,function(t){var n=Qo(t.row(),t.row()+t.rowspan(),i);return{element:t.element,height:r(n),rowspan:t.rowspan}})),d=(c=f,B(a.all,function(t,n){return{element:t.element,height:r(c[n])}}));N(d,function(t){hr(t.element(),t.height())}),N(s,function(t){hr(t.element(),t.height())});var m=P(f,function(t,n){return t+n},0);hr(t,m)})(t.table(),n,t.row(),e),i.trigger.afterResize(t.table())}),o.events.startAdjust.bind(function(t){i.trigger.startDrag()}),o.events.adjustWidth.bind(function(t){i.trigger.beforeResize(t.table());var e,o,u,c,a,l,f,s,d,m,g,p=n.delta(t.delta(),t.table());e=t.table(),o=p,u=t.column(),c=n,l=(a=ni(e)).getCellDelta(o),f=ri(e),d=function(t,n,e,o){var i,u,c=t.slice(0),a=(u=n,0===(i=t).length?Xo.none():1===i.length?Xo.only(0):0===u?Xo.left(0,1):u===i.length-1?Xo.right(u-1,u):0<u&&u<i.length-1?Xo.middle(u-1,u,u+1):Xo.none()),l=function(t){return B(t,r(0))},f=r(l(c)),s=function(t,n){if(0<=e){var r=Math.max(o.minCellWidth(),c[n]-e);return l(c.slice(0,t)).concat([e,r-c[n]]).concat(l(c.slice(n+1)))}var i=Math.max(o.minCellWidth(),c[t]+e),u=c[t]-i;return l(c.slice(0,t)).concat([i-c[t],u]).concat(l(c.slice(n+1)))},d=s;return a.fold(f,function(t){return o.singleColumnWidth(c[t],e)},d,function(t,n,e){return s(n,e)},function(t,n){if(0<=e)return l(c.slice(0,n)).concat([e]);var r=Math.max(o.minCellWidth(),c[n]+e);return l(c.slice(0,n)).concat([r-c[n]])})}(s=a.getWidths(f,c,a),u,l,a),m=B(d,function(t,n){return t+s[n]}),g=Zo(f,m),N(g,function(t){a.setElementWidth(t.element,t.width)}),u===f.grid.columns()-1&&a.setTableWidth(e,m,l),i.trigger.afterResize(t.table())}),{on:o.on,off:o.off,hideBars:o.hideBars,showBars:o.showBars,destroy:o.destroy,events:i.registry}},gc=function(){var n=gt.fromTag("div");return bt(n,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),mn(function(t){var n=t.dom().body;if(null==n)throw new Error("Body is not available yet");return gt.fromDom(n)}(gt.fromDom(t.document)),n),n},pc=function(t,n){return ji(t.dom())/ji(n.dom())*100+"%"},hc=function(t){var n,e,o=h.none(),i=h.none(),u=h.none(),c=/(\d+(\.\d+)?)%/,a=function(t){return"TABLE"===t.nodeName},l=function(n){var e=t.dom.getStyle(n,"width")||t.dom.getAttrib(n,"width");return h.from(e).filter(function(t){return 0<t.length})};return t.on("init",function(){var n,e,c=Ur(Vi),a=(n=t).inline?function(t,n){return{parent:r(n),view:r(t),origin:r(Ar(0,0))}}(Wi(n),gc()):Yu(gt.fromDom(n.getDoc()));if(u=h.some(a),e=t.getParam("object_resizing",!0),(y(e)?"table"===e:e)&&t.getParam("table_resize_bars",!0,"boolean")){var l=mc(a,c);l.on(),l.events.startDrag.bind(function(n){o=h.some(t.selection.getRng())}),l.events.beforeResize.bind(function(n){var e,r,o,i,u=n.table().dom();e=t,o=ji(r=u),i=zi(u),e.fire("ObjectResizeStart",{target:r,width:o,height:i})}),l.events.afterResize.bind(function(n){var e,r,i,u,c=n.table(),a=c.dom();Hi(c),o.each(function(n){t.selection.setRng(n),t.focus()}),e=t,i=ji(r=a),u=zi(a),e.fire("ObjectResized",{target:r,width:i,height:u}),t.undoManager.add()}),i=h.some(l)}}),t.on("ObjectResizeStart",function(r){var o,i,u,f=r.target;if(a(f)){var s=l(f).map(function(t){return c.test(t)}).getOr(!1);s&&eu(t)?(u=f,vt(gt.fromDom(u),"width",ji(u).toString()+"px")):s||!0!==t.getParam("table_responsive_width")||(o=f,i=gt.fromDom(o),rn(i).map(function(t){return pc(i,t)}).each(function(t){vt(i,"width",t),N(On(i,"tr"),function(t){N(an(t),function(n){vt(n,"width",pc(n,t))})})})),n=r.width,e=l(f).getOr("")}}),t.on("ObjectResized",function(r){var o=r.target;if(a(o)){var i=o;if(c.test(e)){var u=parseFloat(c.exec(e)[1]),l=r.width*u/n;t.dom.setStyle(i,"width",l+"%")}else{var f=[];pu.each(i.rows,function(n){pu.each(n.cells,function(n){var e=t.dom.getStyle(n,"width",!0);f.push({cell:n,width:e})})}),pu.each(f,function(n){t.dom.setStyle(n.cell,"width",n.width),t.dom.setAttrib(n.cell,"width",null)})}}}),t.on("SwitchMode",function(){i.each(function(n){t.mode.isReadOnly()?n.hideBars():n.showBars()})}),{lazyResize:function(){return i},lazyWire:function(){return u.getOr(Yu(gt.fromDom(t.getBody())))},destroy:function(){i.each(function(t){t.destroy()}),u.each(function(n){var e;e=n,t.inline&&bn(e.parent())})}}},vc=Xe([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),bc=Ct(Ct({},vc),{none:function(t){return void 0===t&&(t=void 0),vc.none(t)}}),wc=function(t,n){return Vn(t,n).bind(function(n){var e=qn(n);return _(e,function(n){return Zt(t,n)}).map(function(t){return{index:t,all:e}})})},yc=function(t,n,e,o){return{start:r(t),soffset:r(n),finish:r(e),foffset:r(o)}},Sc=Xe([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),xc={before:Sc.before,on:Sc.on,after:Sc.after,cata:function(t,n,e,r){return t.fold(n,e,r)},getStart:function(t){return t.fold(o,o,o)}},Cc=Xe([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Rc={domRange:Cc.domRange,relative:Cc.relative,exact:Cc.exact,exactFromRange:function(t){return Cc.exact(t.start(),t.soffset(),t.finish(),t.foffset())},getWin:function(t){var n;return n=t.match({domRange:function(t){return gt.fromDom(t.startContainer)},relative:function(t,n){return xc.getStart(t)},exact:function(t,n,e,r){return t}}),gt.fromDom(n.dom().ownerDocument.defaultView)},range:yc},Tc=function(t,n,e){var r,o,i=t.document.createRange();return r=i,n.fold(function(t){r.setStartBefore(t.dom())},function(t,n){r.setStart(t.dom(),n)},function(t){r.setStartAfter(t.dom())}),o=i,e.fold(function(t){o.setEndBefore(t.dom())},function(t,n){o.setEnd(t.dom(),n)},function(t){o.setEndAfter(t.dom())}),i},Oc=function(t,n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},Dc=function(t){return{left:r(t.left),top:r(t.top),right:r(t.right),bottom:r(t.bottom),width:r(t.width),height:r(t.height)}},Ac=Xe([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Ec=function(t,n,e){return n(gt.fromDom(e.startContainer),e.startOffset,gt.fromDom(e.endContainer),e.endOffset)},Bc=function(t,n){var e,o,i,u=(e=t,n.match({domRange:function(t){return{ltr:r(t),rtl:h.none}},relative:function(t,n){return{ltr:Rt(function(){return Tc(e,t,n)}),rtl:Rt(function(){return h.some(Tc(e,n,t))})}},exact:function(t,n,r,o){return{ltr:Rt(function(){return Oc(e,t,n,r,o)}),rtl:Rt(function(){return h.some(Oc(e,r,o,t,n))})}}}));return(i=(o=u).ltr()).collapsed?o.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return Ac.rtl(gt.fromDom(t.endContainer),t.endOffset,gt.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return Ec(0,Ac.ltr,i)}):Ec(0,Ac.ltr,i)},Nc=function(t,n){return Bc(t,n).match({ltr:function(n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},rtl:function(n,e,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(n.dom(),e),i}})},kc=(Ac.ltr,Ac.rtl,function(t,n,e){return n>=t.left&&n<=t.right&&e>=t.top&&e<=t.bottom}),Pc=function(t,n,e,r){return Z(n)?function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getClientRects();return L(i,function(t){return kc(t,e,r)?h.some(t):h.none()}).map(function(o){return function(t,n,e,r,o){var i=function(e){var r=t.dom().createRange();return r.setStart(n.dom(),e),r.collapse(!0),r},u=ee(n).length,c=function(t,n,e,r,o){if(0===o)return 0;if(n===r)return o-1;for(var i=r,u=1;u<o;u++){var c=t(u),a=Math.abs(n-c.left);if(e<=c.bottom){if(e<c.top||i<a)return u-1;i=a}}return 0}(function(t){return i(t).getBoundingClientRect()},e,r,o.right,u);return i(c)}(t,n,e,r,o)})}(t,n,e,r):(i=n,u=e,c=r,a=(o=t).dom().createRange(),l=an(i),L(l,function(t){return a.selectNode(t.dom()),kc(a.getBoundingClientRect(),u,c)?Pc(o,t,u,c):h.none()}));var o,i,u,c,a,l},Ic=function(t,n){return n-t.left<t.right-n},Mc=function(t,n,e){var r=t.dom().createRange();return r.selectNode(n.dom()),r.collapse(e),r},_c=document.caretPositionFromPoint?function(t,n,e){return h.from(t.dom().caretPositionFromPoint(n,e)).bind(function(n){if(null===n.offsetNode)return h.none();var e=t.dom().createRange();return e.setStart(n.offsetNode,n.offset),e.collapse(),h.some(e)})}:document.caretRangeFromPoint?function(t,n,e){return h.from(t.dom().caretRangeFromPoint(n,e))}:function(t,n,e){return gt.fromPoint(t,n,e).bind(function(r){var o=function(){return e=t,i=n,(0===an(o=r).length?function(t,n,e){var r=n.dom().getBoundingClientRect(),o=Ic(r,e);return h.some(Mc(t,n,o))}:function(t,n,e){var r=t.dom().createRange();r.selectNode(n.dom());var o=r.getBoundingClientRect(),i=Ic(o,e);return(!0===i?ae:le)(n).map(function(n){return Mc(t,n,i)})})(e,o,i);var e,o,i};return 0===an(r).length?o():function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect();return function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,e)),c=Math.max(i.top,Math.min(i.bottom,r));return Pc(t,n,u,c)}(t,n,Math.max(i.left,Math.min(i.right,e)),Math.max(i.top,Math.min(i.bottom,r)))}(t,r,n,e).orThunk(o)})},Wc=function(t,n){var e=$(t);return"input"===e?xc.after(t):A(["br","img"],e)?0===n?xc.before(t):xc.after(t):xc.on(t,n)},jc=function(t,n){var e=t.fold(xc.before,Wc,xc.after),r=n.fold(xc.before,Wc,xc.after);return Rc.relative(e,r)},zc=function(t,n,e,r){var o=Wc(t,n),i=Wc(e,r);return Rc.relative(o,i)},Lc=function(t,n){h.from(t.getSelection()).each(function(t){t.removeAllRanges(),t.addRange(n)})},Fc=function(t,n,e,r,o){var i=Oc(t,n,e,r,o);Lc(t,i)},Hc=function(t,n){return Bc(t,n).match({ltr:function(n,e,r,o){Fc(t,n,e,r,o)},rtl:function(n,e,r,o){var i,u,c,a,l,f=t.getSelection();if(f.setBaseAndExtent)f.setBaseAndExtent(n.dom(),e,r.dom(),o);else if(f.extend)try{u=n,c=e,a=r,l=o,(i=f).collapse(u.dom(),c),i.extend(a.dom(),l)}catch(i){Fc(t,r,o,n,e)}else Fc(t,r,o,n,e)}})},qc=function(t,n,e,r,o){var i=zc(n,e,r,o);Hc(t,i)},Uc=function(t,n,e){var r=jc(n,e);Hc(t,r)},Vc=function(t){var n=gt.fromDom(t.anchorNode),e=gt.fromDom(t.focusNode);return function(t,n,e,r){var o,i,u,c,a,l=(i=n,u=e,c=r,(a=en(o=t).dom().createRange()).setStart(o.dom(),i),a.setEnd(u.dom(),c),a),f=Zt(t,e)&&n===r;return l.collapsed&&!f}(n,t.anchorOffset,e,t.focusOffset)?h.some(yc(n,t.anchorOffset,e,t.focusOffset)):function(t){if(0<t.rangeCount){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return h.some(yc(gt.fromDom(n.startContainer),n.startOffset,gt.fromDom(e.endContainer),e.endOffset))}return h.none()}(t)},Kc=function(t){return n=t,h.from(n.getSelection()).filter(function(t){return 0<t.rangeCount}).bind(Vc).map(function(t){return Rc.exact(t.start(),t.soffset(),t.finish(),t.foffset())});var n},Xc=tinymce.util.Tools.resolve("tinymce.util.VK"),$c=function(t,n){return function(t){var n=Rc.getWin(t).dom(),e=function(t,e,r,o){return Oc(n,t,e,r,o)},r=t.match({domRange:function(t){var n=gt.fromDom(t.startContainer),e=gt.fromDom(t.endContainer);return zc(n,t.startOffset,e,t.endOffset)},relative:jc,exact:zc});return Bc(n,r).match({ltr:e,rtl:e})}(Rc.exact(n,0,n,0))},Gc=function(t,n,e,r,o){return e.fold(h.none,h.none,function(t,n){return ae(n).map(function(t){return $c(0,t)})},function(e){return Vn(e,n).bind(function(n){var o=tr(e);return t.undoManager.transact(function(){r.insertRowsAfter(n,o)}),function(t,n){var e;return(0===(e=On(n,"tr")).length?h.none():h.some(e[e.length-1])).bind(function(t){return Nn(t,"td,th").map(function(t){return $c(0,t)})})}(0,n)})})},Yc=["table","li","dl"],Jc=function(t,n,e,r){if(t.keyCode===Xc.TAB){var o=Wi(n),i=function(t){var n=$(t);return Zt(t,o)||A(Yc,n)},u=n.selection.getRng();if(u.collapsed){var c=gt.fromDom(u.startContainer);Hn(c,i).each(function(o){t.preventDefault(),(t.shiftKey?function(t,n,e,r){return Gc(t,n,wc(o=e,void 0).fold(function(){return bc.none()},function(t){return 0<=t.index-1?bc.middle(o,t.all[t.index-1]):bc.first(o)}),r);var o}:function(t,n,e,r){return Gc(t,n,wc(o=e,void 0).fold(function(){return bc.none(o)},function(t){return t.index+1<t.all.length?bc.middle(o,t.all[t.index+1]):bc.last(o)}),r);var o})(n,i,o,e,r).each(function(t){n.selection.setRng(t)})})}}},Qc=function(t,n){return{selection:r(t),kill:r(n)}},Zc=function(t,n,e,o){return{start:r(xc.on(t,n)),finish:r(xc.on(e,o))}},ta=function(t,n){var e=Nc(t,n);return yc(gt.fromDom(e.startContainer),e.startOffset,gt.fromDom(e.endContainer),e.endOffset)},na=Zc,ea=function(t,n,e,r,o){return Zt(e,r)?h.none():Me(e,r,n).bind(function(n){var r=n.boxes.getOr([]);return 0<r.length?(o(t,r,n.start,n.finish),h.some(Qc(h.some(na(e,0,e,ie(e))),!0))):h.none()})},ra=function(t,n){return{item:r(t),mode:r(n)}},oa=function(t,n,e,r){return void 0===r&&(r=ia),t.property().parent(n).map(function(t){return ra(t,r)})},ia=function(t,n,e,r){return void 0===r&&(r=ua),e.sibling(t,n).map(function(t){return ra(t,r)})},ua=function(t,n,e,r){void 0===r&&(r=ua);var o=t.property().children(n);return e.first(o).map(function(t){return ra(t,r)})},ca=[{current:oa,next:ia,fallback:h.none()},{current:ia,next:ua,fallback:h.some(oa)},{current:ua,next:ua,fallback:h.some(ia)}],aa=function(t,n,e,r,o){return void 0===o&&(o=ca),M(o,function(t){return t.current===e}).bind(function(e){return e.current(t,n,r,e.next).orThunk(function(){return e.fallback.bind(function(e){return aa(t,n,e,r)})})})},la=function(t,n,e,r,o,i){return aa(t,n,r,o).bind(function(n){return i(n.item())?h.none():e(n.item())?h.some(n.item()):la(t,n.item(),e,n.mode(),o,i)})},fa=function(t){return function(n){return 0===t.property().children(n).length}},sa=function(t,n,e,r){return la(t,n,e,ia,{sibling:function(t,n){return t.query().prevSibling(n)},first:function(t){return 0<t.length?h.some(t[t.length-1]):h.none()}},r)},da=function(t,n,e,r){return la(t,n,e,ia,{sibling:function(t,n){return t.query().nextSibling(n)},first:function(t){return 0<t.length?h.some(t[0]):h.none()}},r)},ma=Ae(),ga=function(t,n){return sa(e=ma,t,fa(e),n);var e},pa=function(t,n){return da(e=ma,t,fa(e),n);var e},ha=Xe([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),va=function(t){return kn(t,"tr")},ba=Ct(Ct({},ha),{verify:function(t,n,e,r,o,i,u){return kn(r,"td,th",u).bind(function(e){return kn(n,"td,th",u).map(function(n){return Zt(e,n)?Zt(r,e)&&ie(e)===o?i(n):ha.none("in same cell"):Pe(va,[e,n]).fold(function(){return o=n,u=e,c=(r=t).getRect(o),(a=r.getRect(u)).right>c.left&&a.left<c.right?ha.success():i(n);var r,o,u,c,a},function(t){return i(n)})})}).getOr(ha.none("default"))},cata:function(t,n,e,r,o){return t.fold(n,e,r,o)}}),wa=function(t,n){return _(t,i(Zt,n))},ya=function(t){return"br"===$(t)},Sa=function(t,n,e){return n(t,e).bind(function(t){return Z(t)&&0===ee(t).trim().length?Sa(t,n,e):h.some(t)})},xa=function(t,n,e,o){return ln(i=n,u=e).filter(ya).orThunk(function(){return ln(i,u-1).filter(ya)}).bind(function(n){return o.traverse(n).fold(function(){return Sa(n,o.gather,t).map(o.relative)},function(t){return(n=t,rn(n).bind(function(t){var e=an(t);return wa(e,n).map(function(o){return{parent:r(t),children:r(e),element:r(n),index:r(o)}})})).map(function(t){return xc.on(t.parent(),t.index())});var n})});var i,u},Ca=function(t,n){return{left:t.left,top:t.top+n,right:t.right,bottom:t.bottom+n}},Ra=function(t,n){return{left:t.left,top:t.top-n,right:t.right,bottom:t.bottom-n}},Ta=function(t,n,e){return{left:t.left+n,top:t.top+e,right:t.right+n,bottom:t.bottom+e}},Oa=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}},Da=function(t,n){return h.some(t.getRect(n))},Aa=function(t,n,e){return Q(n)?Da(t,n).map(Oa):Z(n)?(r=t,o=n,(0<=(i=e)&&i<ie(o)?r.getRangedRect(o,i,o,i+1):0<i?r.getRangedRect(o,i-1,o,i):h.none()).map(Oa)):h.none();var r,o,i},Ea=function(t,n){return Q(n)?Da(t,n).map(Oa):Z(n)?t.getRangedRect(n,0,n,ie(n)).map(Oa):h.none()},Ba=Xe([{none:[]},{retry:["caret"]}]),Na=function(t,n,e){return Dn(function(t,n){return n(t)},An,n,gi,void 0).fold(r(!1),function(n){return Ea(t,n).exists(function(t){return r=t,(n=e).left<r.left||Math.abs(r.right-n.left)<1||n.left>r.right;var n,r})})},ka={point:function(t){return t.bottom},adjuster:function(t,n,e,r,o){var i=Ca(o,5);return Math.abs(e.bottom-r.bottom)<1||e.top>o.bottom?Ba.retry(i):e.top===o.bottom?Ba.retry(Ca(o,1)):Na(t,n,o)?Ba.retry(Ta(i,5,0)):Ba.none()},move:Ca,gather:pa},Pa=function(t,n,e,r,o){return 0===o?h.some(r):(a=t,l=r.left,f=n.point(r),a.elementFromPoint(l,f).filter(function(t){return"table"===$(t)}).isSome()?(u=r,c=o-1,Pa(t,i=n,e,i.move(u,5),c)):t.situsFromPoint(r.left,n.point(r)).bind(function(i){return i.start().fold(h.none,function(i){return Ea(t,i).bind(function(u){return n.adjuster(t,i,u,e,r).fold(h.none,function(r){return Pa(t,n,e,r,o-1)})}).orThunk(function(){return h.some(r)})},h.none)}));var i,u,c,a,l,f},Ia=function(t,n,e){var r,o,i,u=t.move(e,5),c=Pa(n,t,e,u,100).getOr(u);return o=c,i=n,((r=t).point(o)>i.getInnerHeight()?h.some(r.point(o)-i.getInnerHeight()):r.point(o)<0?h.some(-r.point(o)):h.none()).fold(function(){return n.situsFromPoint(c.left,t.point(c))},function(e){return n.scrollBy(0,e),n.situsFromPoint(c.left,t.point(c)-e)})},Ma={tryUp:i(Ia,{point:function(t){return t.top},adjuster:function(t,n,e,r,o){var i=Ra(o,5);return Math.abs(e.top-r.top)<1||e.bottom<o.top?Ba.retry(i):e.bottom===o.top?Ba.retry(Ra(o,1)):Na(t,n,o)?Ba.retry(Ta(i,5,0)):Ba.none()},move:Ra,gather:ga}),tryDown:i(Ia,ka),ieTryUp:function(t,n){return t.situsFromPoint(n.left,n.top-5)},ieTryDown:function(t,n){return t.situsFromPoint(n.left,n.bottom+5)},getJumpSize:r(5)},_a=function(t,n,e){return t.getSelection().bind(function(o){return function(t,n,e,o){var i,u,c;return(ya(n)?(i=t,u=n,(c=o).traverse(u).orThunk(function(){return Sa(u,c.gather,i)}).map(c.relative)):xa(t,n,e,o)).map(function(t){return{start:r(t),finish:r(t)}})}(n,o.finish(),o.foffset(),e).fold(function(){return h.some(au(o.finish(),o.foffset()))},function(r){var i,u=t.fromSitus(r);return i=ba.verify(t,o.finish(),o.foffset(),u.finish(),u.foffset(),e.failure,n),ba.cata(i,function(t){return h.none()},function(){return h.none()},function(t){return h.some(au(t,0))},function(t){return h.some(au(t,ie(t)))})})})},Wa=function(t,n,e,r,o,i){return 0===i?h.none():La(t,n,e,r,o).bind(function(u){var c=t.fromSitus(u),a=ba.verify(t,e,r,c.finish(),c.foffset(),o.failure,n);return ba.cata(a,function(){return h.none()},function(){return h.some(u)},function(u){return Zt(e,u)&&0===r?ja(t,e,r,Ra,o):Wa(t,n,u,0,o,i-1)},function(u){return Zt(e,u)&&r===ie(u)?ja(t,e,r,Ca,o):Wa(t,n,u,ie(u),o,i-1)})})},ja=function(t,n,e,r,o){return Aa(t,n,e).bind(function(n){return za(t,o,r(n,Ma.getJumpSize()))})},za=function(t,n,e){var r=Yt().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?n.otherRetry(t,e):r.isIE()?n.ieRetry(t,e):h.none()},La=function(t,n,e,r,o){return Aa(t,e,r).bind(function(n){return za(t,o,n)})},Fa=function(t,n,e,o,i){return kn(o,"td,th",n).bind(function(o){return kn(o,"table",n).bind(function(u){return function(t,n){return An(t,function(t){return rn(t).exists(function(t){return Zt(t,n)})},void 0).isSome()}(i,u)?_a(c=t,a=n,l=e).bind(function(t){return Wa(c,a,t.element(),t.offset(),l,20).map(c.fromSitus)}).bind(function(t){return kn(t.finish(),"td,th",n).map(function(n){return{start:r(o),finish:r(n),range:r(t)}})}):h.none();var c,a,l})})},Ha=function(t,n,e,r,o,i){return Yt().browser.isIE()?h.none():i(r,n).orThunk(function(){return Fa(t,n,e,r,o).map(function(t){var n=t.range();return Qc(h.some(na(n.start(),n.soffset(),n.finish(),n.foffset())),!0)})})},qa=function(t,n){return kn(t,"tr",n).bind(function(t){return kn(t,"table",n).bind(function(e){var r=On(e,"tr");return Zt(t,r[0])?sa(ma,e,function(t){return le(t).isSome()},n).map(function(t){var n=ie(t);return Qc(h.some(na(t,n,t,n)),!0)}):h.none()})})},Ua=function(t,n){return kn(t,"tr",n).bind(function(t){return kn(t,"table",n).bind(function(e){var r=On(e,"tr");return Zt(t,r[r.length-1])?da(ma,e,function(t){return ae(t).isSome()},n).map(function(t){return Qc(h.some(na(t,0,t,0)),!0)}):h.none()})})},Va=function(t,n,e,r,o,i,u){return Fa(t,e,r,o,i).bind(function(t){return ea(n,e,t.start(),t.finish(),u)})},Ka=function(t,n){return kn(t,"td,th",n)},Xa={traverse:cn,gather:pa,relative:xc.before,otherRetry:Ma.tryDown,ieRetry:Ma.ieTryDown,failure:ba.failedDown},$a={traverse:un,gather:ga,relative:xc.before,otherRetry:Ma.tryUp,ieRetry:Ma.ieTryUp,failure:ba.failedUp},Ga=function(t){return function(n){return n===t}},Ya=Ga(38),Ja=Ga(40),Qa=function(t){return 37<=t&&t<=40},Za={isBackward:Ga(37),isForward:Ga(39)},tl={isBackward:Ga(39),isForward:Ga(37)},nl=function(t){return{left:t.left(),top:t.top(),right:t.right(),bottom:t.bottom(),width:t.width(),height:t.height()}},el=function(n){return{elementFromPoint:function(t,e){return gt.fromPoint(gt.fromDom(n.document),t,e)},getRect:function(t){return t.dom().getBoundingClientRect()},getRangedRect:function(t,e,r,o){var i=Rc.exact(t,e,r,o);return function(t,n){var e,r,o;return 0<(o=0<(r=(e=Nc(t,n)).getClientRects()).length?r[0]:e.getBoundingClientRect()).width||0<o.height?h.some(o).map(Dc):h.none()}(n,i).map(nl)},getSelection:function(){return Kc(n).map(function(t){return ta(n,t)})},fromSitus:function(t){var e=Rc.relative(t.start(),t.finish());return ta(n,e)},situsFromPoint:function(t,e){return function(t,n,e){return r=t,o=n,i=e,u=gt.fromDom(r.document),_c(u,o,i).map(function(t){return yc(gt.fromDom(t.startContainer),t.startOffset,gt.fromDom(t.endContainer),t.endOffset)});var r,o,i,u}(n,t,e).map(function(t){return Zc(t.start(),t.soffset(),t.finish(),t.foffset())})},clearSelection:function(){n.getSelection().removeAllRanges()},collapseSelection:function(t){void 0===t&&(t=!1),Kc(n).each(function(e){return e.fold(function(n){return n.collapse(t)},function(e,r){var o=t?e:r;Uc(n,o,o)},function(e,r,o,i){var u=t?e:o,c=t?r:i;qc(n,u,c,u,c)})})},setSelection:function(t){qc(n,t.start(),t.soffset(),t.finish(),t.foffset())},setRelativeSelection:function(t,e){Uc(n,t,e)},selectContents:function(t){!function(t,n){var e,r,o=(e=n,function(t,n){t.selectNodeContents(n.dom())}(r=t.document.createRange(),e),r);Lc(t,o)}(n,t)},getInnerHeight:function(){return n.innerHeight},getScrollY:function(){var e,r,o,i;return(e=gt.fromDom(n.document),r=void 0!==e?e.dom():t.document,o=r.body.scrollLeft||r.documentElement.scrollLeft,i=r.body.scrollTop||r.documentElement.scrollTop,Ar(o,i)).top()},scrollBy:function(e,r){var o,i,u;o=e,i=r,(void 0!==(u=gt.fromDom(n.document))?u.dom():t.document).defaultView.scrollBy(o,i)}}},rl=function(t,n){return{rows:t,cols:n}},ol=function(t,n,e,r){var o=function(t,n,e,r){var o=h.none(),i=function(){o=h.none()};return{mousedown:function(t){r.clear(n),o=Ka(t.target(),e)},mouseover:function(i){o.each(function(o){r.clearBeforeUpdate(n),Ka(i.target(),e).each(function(i){Me(o,i,e).each(function(e){var u=e.boxes.getOr([]);(1<u.length||1===u.length&&!Zt(o,i))&&(r.selectRange(n,u,e.start,e.finish),t.selectContents(i))})})})},mouseup:function(t){o.each(i)}}}(el(t),n,e,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},il=function(t,n,e,r){var o=el(t),u=function(){return r.clear(n),h.none()};return{keydown:function(t,c,a,l,f,s){var d=t.raw(),m=d.which,g=!0===d.shiftKey;return _e(n,r.selectedSelector).fold(function(){return Ja(m)&&g?i(Va,o,n,e,Xa,l,c,r.selectRange):Ya(m)&&g?i(Va,o,n,e,$a,l,c,r.selectRange):Ja(m)?i(Ha,o,e,Xa,l,c,Ua):Ya(m)?i(Ha,o,e,$a,l,c,qa):h.none},function(t){var e=function(e){return function(){return L(e,function(e){return o=e.rows,i=e.cols,u=n,je(t,o,i,(c=r).firstSelectedSelector,c.lastSelectedSelector).map(function(t){return c.clearBeforeUpdate(u),c.selectRange(u,t.boxes,t.start,t.finish),t.boxes});var o,i,u,c}).fold(function(){return We(n,r.firstSelectedSelector,r.lastSelectedSelector).map(function(t){var e=Ja(m)||s.isForward(m)?xc.after:xc.before;return o.setRelativeSelection(xc.on(t.first(),0),e(t.table())),r.clear(n),Qc(h.none(),!0)})},function(t){return h.some(Qc(h.none(),!0))})}};return Ja(m)&&g?e([rl(1,0)]):Ya(m)&&g?e([rl(-1,0)]):s.isBackward(m)&&g?e([rl(0,-1),rl(-1,0)]):s.isForward(m)&&g?e([rl(0,1),rl(1,0)]):Qa(m)&&0==g?u:h.none})()},keyup:function(t,o,i,u,c){return _e(n,r.selectedSelector).fold(function(){var a,l,f,s,d,m,g,p=t.raw(),v=p.which;return 0!=(!0===p.shiftKey)&&Qa(v)?(a=n,l=e,f=o,s=i,d=u,m=c,g=r.selectRange,Zt(f,d)&&s===m?h.none():kn(f,"td,th",l).bind(function(t){return kn(d,"td,th",l).bind(function(n){return ea(a,l,t,n,g)})})):h.none()},h.none)}}},ul=function(t,n,e,r){var o=el(t);return function(t,i){r.clearBeforeUpdate(n),Me(t,i,e).each(function(t){var e=t.boxes.getOr([]);r.selectRange(n,e,t.start,t.finish),o.selectContents(i),o.collapseSelection()})}},cl=function(t,n){N(n,function(n){!function(t,n){Gr(t)?t.dom().classList.remove(n):function(t,n){return o=n,0<(i=k($r(e=t,r="class"),function(t){return t!==o})).length?nt(e,r,i.join(" ")):ut(e,r),!1;var e,r,o,i}(t,n),function(t){0===(Gr(t)?t.dom().classList:$r(t,"class")).length&&ut(t,"class")}(t)}(t,n)})},al={byClass:function(t){var n,e,r=(n=t.selected,function(t){Yr(t,n)}),o=(e=[t.selected,t.lastSelected,t.firstSelected],function(t){cl(t,e)}),i=function(n){var e=On(n,t.selectedSelector);N(e,o)};return{clearBeforeUpdate:i,clear:i,selectRange:function(n,e,o,u){i(n),N(e,r),Yr(o,t.firstSelected),Yr(u,t.lastSelected)},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},byAttr:function(t,n,e){var r=function(n){ut(n,t.selected),ut(n,t.firstSelected),ut(n,t.lastSelected)},o=function(n){nt(n,t.selected,"1")},i=function(t){u(t),e()},u=function(n){var e=On(n,t.selectedSelector);N(e,r)};return{clearBeforeUpdate:u,clear:i,selectRange:function(e,r,u,c){i(e),N(r,o),nt(u,t.firstSelected,"1"),nt(c,t.lastSelected,"1"),n(r,u,c)},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}}},ll=function(t,n,e){var r=Kn(t),o=Gn(r);return Eo(o,n).map(function(t){var n,r,i,u,c,a,l,f,s,d=Co(o,e,!1);return{upOrLeftCells:(n=t,r=e,i=d.slice(0,n[n.length-1].row()+1),u=Ro(i,r),j(u,function(t){var e=t.cells().slice(0,n[n.length-1].column()+1);return B(e,function(t){return t.element()})})),downOrRightCells:(a=t,l=e,f=(c=d).slice(a[0].row()+a[0].rowspan()-1,c.length),s=Ro(f,l),j(s,function(t){var n=t.cells().slice(a[0].column()+a[0].colspan()-1,+t.cells().length);return B(n,function(t){return t.element()})}))}})},fl=function(t){return!1===Jr(gt.fromDom(t.target),"ephox-snooker-resizer-bar")};var sl=function(t){return{get:function(){var n=Wi(t);return _e(n,Le).fold(function(){return void 0===t.selection.getStart()?Ye():Qe(t.selection)},function(t){return Je(t)})}}},dl=function(t,e){var r=n(h.none()),o=n([]),i=function(){return bu(t).bind(function(t){return Vn(t).map(function(n){return"caption"===$(t)?tr(t):nr(e,n,t)})})},u=function(){r.set(Rt(i)()),N(o.get(),function(t){return t()})},c=function(t,n){var e=function(){return r.get().fold(function(){t.setDisabled(!0)},function(e){t.setDisabled(n(e))})};return e(),o.set(o.get().concat([e])),function(){o.set(k(o.get(),function(t){return t!==e}))}};return t.on("NodeChange TableSelectorChange",u),{onSetupTable:function(t){return c(t,function(t){return!1})},onSetupCellOrRow:function(t){return c(t,function(t){return"caption"===$(t.element())})},onSetupMergeable:function(t){return c(t,function(t){return t.mergable().isNone()})},onSetupUnmergeable:function(t){return c(t,function(t){return t.unmergable().isNone()})},resetTargets:u,targets:function(){return r.get()}}},ml=function(t,n){t.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(t){return t("inserttable | cell row column | advtablesort | tableprops deletetable")}});var e=function(n){return function(){return t.execCommand(n)}};t.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:e("mceTableProps"),icon:"table",onSetup:n.onSetupTable}),t.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:e("mceTableDelete"),icon:"table-delete-table",onSetup:n.onSetupTable}),t.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:e("mceTableCellProps"),icon:"table-cell-properties",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:e("mceTableMergeCells"),icon:"table-merge-cells",onSetup:n.onSetupMergeable}),t.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:e("mceTableSplitCells"),icon:"table-split-cells",onSetup:n.onSetupUnmergeable}),t.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:e("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:e("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:e("mceTableDeleteRow"),icon:"table-delete-row",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:e("mceTableRowProps"),icon:"table-row-properties",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:e("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:e("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:e("mceTableDeleteCol"),icon:"table-delete-column",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",onAction:e("mceTableCutRow"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",onAction:e("mceTableCopyRow"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",onAction:e("mceTablePasteRowBefore"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",onAction:e("mceTablePasteRowAfter"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:e("mceInsertTable"),icon:"table"})},gl=function(t){var n=t.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol");0<n.length&&t.ui.registry.addContextToolbar("table",{predicate:function(n){return t.dom.is(n,"table")&&t.getBody().contains(n)},items:n,scope:"node",position:"node"})},pl=function(t,n){var e=function(n){return function(){return t.execCommand(n)}},r=function(n){var e=n.numRows,r=n.numColumns;t.undoManager.transact(function(){Uu(t,r,e)}),t.addVisual()},o={text:"Table properties",onSetup:n.onSetupTable,onAction:e("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:n.onSetupTable,onAction:e("mceTableDelete")},u=[{type:"menuitem",text:"Insert row before",icon:"table-insert-row-above",onAction:e("mceTableInsertRowBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Insert row after",icon:"table-insert-row-after",onAction:e("mceTableInsertRowAfter"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Delete row",icon:"table-delete-row",onAction:e("mceTableDeleteRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Row properties",icon:"table-row-properties",onAction:e("mceTableRowProps"),onSetup:n.onSetupCellOrRow},{type:"separator"},{type:"menuitem",text:"Cut row",onAction:e("mceTableCutRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Copy row",onAction:e("mceTableCopyRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Paste row before",onAction:e("mceTablePasteRowBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Paste row after",onAction:e("mceTablePasteRowAfter"),onSetup:n.onSetupCellOrRow}],c={type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return u}},a=[{type:"menuitem",text:"Insert column before",icon:"table-insert-column-before",onAction:e("mceTableInsertColBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Insert column after",icon:"table-insert-column-after",onAction:e("mceTableInsertColAfter"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Delete column",icon:"table-delete-column",onAction:e("mceTableDeleteCol"),onSetup:n.onSetupCellOrRow}],l={type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return a}},f=[{type:"menuitem",text:"Cell properties",icon:"table-cell-properties",onAction:e("mceTableCellProps"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Merge cells",icon:"table-merge-cells",onAction:e("mceTableMergeCells"),onSetup:n.onSetupMergeable},{type:"menuitem",text:"Split cell",icon:"table-split-cells",onAction:e("mceTableSplitCells"),onSetup:n.onSetupUnmergeable}],s={type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return f}};!1===t.getParam("table_grid",!0,"boolean")?t.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:e("mceInsertTable")}):t.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:r}]}}),t.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:e("mceInsertTable")}),t.ui.registry.addMenuItem("tableprops",o),t.ui.registry.addMenuItem("deletetable",i),t.ui.registry.addNestedMenuItem("row",c),t.ui.registry.addNestedMenuItem("column",l),t.ui.registry.addNestedMenuItem("cell",s),t.ui.registry.addContextMenu("table",{update:function(){return n.resetTargets(),n.targets().fold(function(){return""},function(t){return"caption"===$(t.element())?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"})}})},hl=function(t,n,e,r){return{insertTable:function(n,e){return Uu(t,n,e)},setClipboardRows:function(t){return e=n,r=B(t,gt.fromDom),void e.set(h.from(r));var e,r},getClipboardRows:function(){return n.get().fold(function(){},function(t){return B(t,function(t){return t.dom()})})},resizeHandler:e,selectionTargets:r}};function vl(t){var r=sl(t),o=dl(t,r),i=hc(t),u=function(t,r,o){var i=h.none(),u=ru(t),c=al.byAttr(Ke,function(n,r,i){o.targets().each(function(o){Vn(r).each(function(c){var a=gt.fromDom(t.getDoc()),l=be(e,a,u),f=ll(c,o,l);uu(t,n,r,i,f)})})},function(){cu(t)});return t.on("init",function(o){var u=t.getWin(),a=Wi(t),l=Li(t),f=ol(u,a,l,c),s=il(u,a,l,c),d=ul(u,a,l,c);t.on("TableSelectorChange",function(t){d(t.start,t.finish)});var m,g,p=function(n,e){!0===n.raw().shiftKey&&(e.kill()&&n.kill(),e.selection().each(function(n){var e=Rc.relative(n.start(),n.finish()),r=Nc(u,e);t.selection.setRng(r)}))},v=function(n){var e=rc(n);if(e.raw().shiftKey&&Qa(e.raw().which)){var r=t.selection.getRng(),o=gt.fromDom(r.startContainer),i=gt.fromDom(r.endContainer);s.keyup(e,o,r.startOffset,i,r.endOffset).each(function(t){p(e,t)})}},b=function(n){var e=rc(n);r().each(function(t){t.hideBars()});var o=t.selection.getRng(),i=gt.fromDom(t.selection.getStart()),u=gt.fromDom(o.startContainer),c=gt.fromDom(o.endContainer),a=Vi(i).isRtl()?tl:Za;s.keydown(e,u,o.startOffset,c,o.endOffset,a).each(function(t){p(e,t)}),r().each(function(t){t.showBars()})},w=function(t){return 0===t.button},y=function(t){w(t)&&fl(t)&&f.mousedown(rc(t))},S=function(t){var n;(void 0===(n=t).buttons||Fu.browser.isEdge()&&0===n.buttons||0!=(1&n.buttons))&&fl(t)&&f.mouseover(rc(t))},x=function(t){w(t)&&fl(t)&&f.mouseup(rc(t))},C=(m=n(gt.fromDom(a)),g=n(0),{touchEnd:function(t){var n=gt.fromDom(t.target);if("td"===$(n)||"th"===$(n)){var e=m.get(),r=g.get();Zt(e,n)&&t.timeStamp-r<300&&(t.preventDefault(),d(n,n))}m.set(n),g.set(t.timeStamp)}});t.on("mousedown",y),t.on("mouseover",S),t.on("mouseup",x),t.on("touchend",C.touchEnd),t.on("keyup",v),t.on("keydown",b),t.on("NodeChange",function(){var n=t.selection,r=gt.fromDom(n.getStart()),o=gt.fromDom(n.getEnd());Pe(Vn,[r,o]).fold(function(){c.clear(a)},e)}),i=h.some({mousedown:y,mouseover:S,mouseup:x,keyup:v,keydown:b})}),{clear:c.clear,destroy:function(){i.each(function(t){})}}}(t,i.lazyResize,o),c=gu(t,i.lazyWire),a=n(h.none());return Gu(t,c,u,r,a),er(t,r,c,u),pl(t,o),ml(t,o),gl(t),t.on("PreInit",function(){t.serializer.addTempAttr(He),t.serializer.addTempAttr(Ue)}),Yi(t)&&t.on("keydown",function(n){Jc(n,t,c,i.lazyWire)}),t.on("remove",function(){i.destroy(),u.destroy()}),hl(t,a,i,o)}v.add("table",vl)}(window);