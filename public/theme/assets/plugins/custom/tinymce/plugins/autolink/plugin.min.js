!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),n=function(e,t){if(t<0&&(t=0),3===e.nodeType){var n=e.data.length;n<t&&(t=n)}return t},o=function(e,t,o){1!==t.nodeType||t.hasChildNodes()?e.setStart(t,n(t,o)):e.setStartBefore(t)},i=function(e,t,o){1!==t.nodeType||t.hasChildNodes()?e.setEnd(t,n(t,o)):e.setEndAfter(t)},r=function(e,t,n){var r,a,s,d,f,l,c,g,u,h,m=e.getParam("autolink_pattern",/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i),C=e.getParam("default_link_target",!1);if("A"!==e.selection.getNode().tagName){if((r=e.selection.getRng(!0).cloneRange()).startOffset<5){if(!(g=r.endContainer.previousSibling)){if(!r.endContainer.firstChild||!r.endContainer.firstChild.nextSibling)return;g=r.endContainer.firstChild.nextSibling}if(u=g.length,o(r,g,u),i(r,g,u),r.endOffset<5)return;a=r.endOffset,d=g}else{if(3!==(d=r.endContainer).nodeType&&d.firstChild){for(;3!==d.nodeType&&d.firstChild;)d=d.firstChild;3===d.nodeType&&(o(r,d,0),i(r,d,d.nodeValue.length))}a=1===r.endOffset?2:r.endOffset-1-t}for(s=a;o(r,d,2<=a?a-2:0),i(r,d,1<=a?a-1:0),--a," "!==(h=r.toString())&&""!==h&&160!==h.charCodeAt(0)&&0<=a-2&&h!==n;);var y;(y=r.toString())===n||" "===y||160===y.charCodeAt(0)?(o(r,d,a),i(r,d,s),a+=1):(0===r.startOffset?o(r,d,0):o(r,d,a),i(r,d,s)),"."===(l=r.toString()).charAt(l.length-1)&&i(r,d,s-1),c=(l=r.toString().trim()).match(m);var k=e.getParam("link_default_protocol","http","string");c&&("www."===c[1]?c[1]=k+"://www.":/@$/.test(c[1])&&!/^mailto:/.test(c[1])&&(c[1]="mailto:"+c[1]),f=e.selection.getBookmark(),e.selection.setRng(r),e.execCommand("createlink",!1,c[1]+c[2]),!1!==C&&e.dom.setAttrib(e.selection.getNode(),"target",C),e.selection.moveToBookmark(f),e.nodeChanged())}};e.add("autolink",function(e){!function(e){var n;e.on("keydown",function(t){13!==t.keyCode||r(e,-1,"")}),t.browser.isIE()?e.on("focus",function(){if(!n){n=!0;try{e.execCommand("AutoUrlDetect",!1,!0)}catch(e){}}}):(e.on("keypress",function(t){41!==t.keyCode||r(e,-1,"(")}),e.on("keyup",function(t){32!==t.keyCode||r(e,0,"")}))}(e)})}();